<data-stream-collection xmlns="http://scap.nist.gov/schema/scap/source/1.2" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" id="scap_navy.navwar.niwcatlantic.scc_collection_U_U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7" schematron-version="1.4" xsi:schemaLocation="http://checklists.nist.gov/xccdf/1.2 http://scap.nist.gov/schema/xccdf/1.2/xccdf_1.2.xsd http://cpe.mitre.org/dictionary/2.0 http://scap.nist.gov/schema/cpe/2.3/cpe-dictionary_2.3.xsd http://oval.mitre.org/XMLSchema/oval-common-5 https://github.com/OVALProject/Language/tree/5.11.2/schemas/oval-common-schema.xsd http://oval.mitre.org/XMLSchema/oval-definitions-5 https://github.com/OVALProject/Language/tree/5.11.2/schemas/oval-definitions-schema.xsd http://oval.mitre.org/XMLSchema/oval-definitions-5#independent https://github.com/OVALProject/Language/tree/5.11.2/schemas/independent-definitions-schema.xsd http://oval.mitre.org/XMLSchema/oval-definitions-5#iosxe https://github.com/OVALProject/Language/tree/5.11.2/schemas/iosxe-definitions-schema.xsd http://scap.nist.gov/schema/scap/source/1.2 http://scap.nist.gov/schema/scap/1.4/scap-source-data-stream_1.4.xsd">
  <data-stream id="scap_navy.navwar.niwcatlantic.scc_datastream_U_U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7" use-case="CONFIGURATION" scap-version="1.4" timestamp="2025-09-16T13:55:38.481217+00:00">
    <dictionaries>
      <component-ref xmlns:xlink="http://www.w3.org/1999/xlink" id="scap_navy.navwar.niwcatlantic.scc_cref_U_U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-cpe-dictionary.xml" xlink:href="#scap_navy.navwar.niwcatlantic.scc_comp_U_U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-cpe-dictionary.xml">
        <cat:catalog xmlns:cat="urn:oasis:names:tc:entity:xmlns:xml:catalog">
          <cat:uri name="U_U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-cpe-oval.xml" uri="#scap_navy.navwar.niwcatlantic.scc_cref_U_U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-cpe-oval.xml"/>
        </cat:catalog>
      </component-ref>
    </dictionaries>
    <checklists>
      <component-ref xmlns:xlink="http://www.w3.org/1999/xlink" id="scap_navy.navwar.niwcatlantic.scc_cref_U_U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-xccdf.xml" xlink:href="#scap_navy.navwar.niwcatlantic.scc_comp_U_U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-xccdf.xml">
        <cat:catalog xmlns:cat="urn:oasis:names:tc:entity:xmlns:xml:catalog">
          <cat:uri name="U_U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-oval.xml" uri="#scap_navy.navwar.niwcatlantic.scc_cref_U_U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-oval.xml"/>
          <uri name="U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-oval2.xml" uri="#scap_navy.navwar.niwcatlantic.scc_cref_U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-oval2.xml"/>
          <uri name="U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-ocil.xml" uri="#scap_navy.navwar.niwcatlantic.scc_cref_U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-ocil.xml"/>
        </cat:catalog>
      </component-ref>
    </checklists>
    <checks>
      <component-ref xmlns:xlink="http://www.w3.org/1999/xlink" id="scap_navy.navwar.niwcatlantic.scc_cref_U_U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-oval.xml" xlink:href="#scap_navy.navwar.niwcatlantic.scc_comp_U_U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-oval.xml"/>
      <component-ref xmlns:xlink="http://www.w3.org/1999/xlink" id="scap_navy.navwar.niwcatlantic.scc_cref_U_U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-cpe-oval.xml" xlink:href="#scap_navy.navwar.niwcatlantic.scc_comp_U_U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-cpe-oval.xml"/>
      <component-ref xmlns:xlink="http://www.w3.org/1999/xlink" id="scap_navy.navwar.niwcatlantic.scc_cref_U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-oval2.xml" xlink:href="#scap_navy.navwar.niwcatlantic.scc_comp_U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-oval2.xml"/>
      <component-ref xmlns:xlink="http://www.w3.org/1999/xlink" id="scap_navy.navwar.niwcatlantic.scc_cref_U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-ocil.xml" xlink:href="#scap_navy.navwar.niwcatlantic.scc_comp_U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-ocil.xml"/>
    </checks>
  </data-stream>
  <component id="scap_navy.navwar.niwcatlantic.scc_comp_U_U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-xccdf.xml" timestamp="2025-09-16T13:55:38.481217+00:00">
    <xccdf:Benchmark xmlns:xccdf="http://checklists.nist.gov/xccdf/1.2" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cpe="http://cpe.mitre.org/language/2.0" id="xccdf_navy.navwar.niwcatlantic.scc_benchmark_MS_SQL_Server_2016_Database_STIG" xml:lang="en">
      <xccdf:status date="2025-09-16">accepted</xccdf:status>
      <xccdf:title>MS SQL Server 2016 Database STIG SCAP Benchmark - NIWC Enhanced with Manual Questions</xccdf:title>
      <xccdf:description>This SCAP Benchmark was created based on the DISA MS SQL Server 2016 Database Security Technical Implementation Guide, Version 3, Release 3, by NIWC Atlantic.  For questions/issues with the content please contact:  scc.fct@navy.mil</xccdf:description>
      <xccdf:notice id="terms-of-use" xml:lang="en">Portions of this document were developed at Naval Information Warfare Center Atlantic by employees of the Federal Government in the course of their official duties. Pursuant to title 17 Section 105 of the United States Code this software is not subject to copyright protection and is in the public domain. The Government assumes no responsibility whatsoever for its use by other parties, and the software is provided "AS IS" without warranty or guarantee of any kind, express or implied, including, but not limited to, the warranties of merchantability and of fitness for a particular purpose. In no event shall the Government be liable for any claim, damages or other liability, whether in an action of contract, tort or other dealings in the software. The Government has no obligation hereunder to provide maintenance, support, updates, enhancements, or modifications. We would appreciate acknowledgement if the software is used. This software can be redistributed and/or modified freely provided that any derivative works bear some notice that they are derived from it, and any modified versions bear some notice that they have been modified.</xccdf:notice>
      <xccdf:front-matter xml:lang="en">This content stream was enhanced with OCIL manual questions derived from the STIG Manual by the NIWC SCC team.
Timestamp: 2025-09-16T13:55:38.481217+00:00
Tool Version: 2.0
STIG Manual Version: 3
SCAP Benchmark Version: 003.003
Total Rules: 28
DISA Automated Rules: 0
NIST Automated Rules: 0
NIWC Automated Rules: 19
Manual rules added: 9</xccdf:front-matter>
      <xccdf:rear-matter xml:lang="en">This data is metadata to be used for the creation of CKL reports.
version:--:3
classification:--:UNCLASSIFIED
customname:--:
stigid:--:MS_SQL_Server_2016_Database_STIG
description:--:This Security Technical Implementation Guide is published as a tool to improve the security of Department of Defense (DOD) information systems. The requirements are derived from the National Institute of Standards and Technology (NIST) 800-53 and related documents. Comments or proposed revisions to this document should be sent via email to the following address: disa.stig_spt@mail.mil.
filename:--:U_MS_SQL_Server_2016_Database_V3R3_STIG_Manual-xccdf.xml
releaseinfo:--:Release: 3 Benchmark Date: 02 Jul 2025
title:--:MS SQL Server 2016 Database Security Technical Implementation Guide
uuid:--:
notice:--:
source:--:STIG.DOD.MIL</xccdf:rear-matter>
      <xccdf:reference href="https://cyber.mil">
        <dc:publisher>NIWC</dc:publisher>
        <dc:source>STIG.DOD.MIL</dc:source>
      </xccdf:reference>
      <xccdf:plain-text id="release-info">Enhanced Content 003.003.7 Date: 2025-09-16, based on Release: 3 Benchmark Date: 02 Jul 2025</xccdf:plain-text>
      <xccdf:plain-text id="generator">3.5</xccdf:plain-text>
      <xccdf:plain-text id="conventionsVersion">1.10.0</xccdf:plain-text>
      <xccdf:platform idref="cpe:/a:microsoft:sqlserver:2016"/>
      <xccdf:version>003.003.007</xccdf:version>
      <xccdf:metadata>
        <dc:creator>NIWC</dc:creator>
        <dc:publisher>NIWC</dc:publisher>
        <dc:contributor>NIWC</dc:contributor>
        <dc:contributor>DISA</dc:contributor>
        <dc:source>STIG.DOD.MIL</dc:source>
      </xccdf:metadata>
      <xccdf:Profile id="xccdf_navy.navwar.niwcatlantic.scc.ms_profile_MAC-1_Classified">
        <xccdf:title>I - Mission Critical Classified</xccdf:title>
        <xccdf:description>&lt;ProfileDescription&gt;&lt;/ProfileDescription&gt;</xccdf:description>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213900" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213901" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213902" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213903" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213904" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213905" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213906" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213907" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213908" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213909" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213910" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213911" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213912" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213913" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213914" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213915" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213916" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213917" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213918" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213919" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213920" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213921" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213922" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213923" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213924" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213926" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213927" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-251040" selected="true"/>
      </xccdf:Profile>
      <xccdf:Profile id="xccdf_navy.navwar.niwcatlantic.scc.ms_profile_MAC-1_Public">
        <xccdf:title>I - Mission Critical Public</xccdf:title>
        <xccdf:description>&lt;ProfileDescription&gt;&lt;/ProfileDescription&gt;</xccdf:description>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213900" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213901" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213902" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213903" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213904" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213905" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213906" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213907" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213908" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213909" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213910" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213911" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213912" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213913" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213914" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213915" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213916" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213917" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213918" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213919" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213920" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213921" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213922" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213923" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213924" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213926" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213927" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-251040" selected="true"/>
      </xccdf:Profile>
      <xccdf:Profile id="xccdf_navy.navwar.niwcatlantic.scc.ms_profile_MAC-1_Sensitive">
        <xccdf:title>I - Mission Critical Sensitive</xccdf:title>
        <xccdf:description>&lt;ProfileDescription&gt;&lt;/ProfileDescription&gt;</xccdf:description>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213900" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213901" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213902" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213903" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213904" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213905" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213906" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213907" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213908" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213909" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213910" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213911" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213912" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213913" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213914" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213915" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213916" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213917" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213918" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213919" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213920" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213921" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213922" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213923" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213924" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213926" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213927" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-251040" selected="true"/>
      </xccdf:Profile>
      <xccdf:Profile id="xccdf_navy.navwar.niwcatlantic.scc.ms_profile_MAC-2_Classified">
        <xccdf:title>II - Mission Support Classified</xccdf:title>
        <xccdf:description>&lt;ProfileDescription&gt;&lt;/ProfileDescription&gt;</xccdf:description>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213900" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213901" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213902" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213903" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213904" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213905" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213906" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213907" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213908" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213909" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213910" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213911" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213912" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213913" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213914" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213915" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213916" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213917" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213918" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213919" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213920" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213921" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213922" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213923" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213924" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213926" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213927" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-251040" selected="true"/>
      </xccdf:Profile>
      <xccdf:Profile id="xccdf_navy.navwar.niwcatlantic.scc.ms_profile_MAC-2_Public">
        <xccdf:title>II - Mission Support Public</xccdf:title>
        <xccdf:description>&lt;ProfileDescription&gt;&lt;/ProfileDescription&gt;</xccdf:description>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213900" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213901" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213902" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213903" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213904" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213905" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213906" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213907" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213908" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213909" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213910" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213911" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213912" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213913" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213914" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213915" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213916" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213917" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213918" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213919" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213920" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213921" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213922" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213923" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213924" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213926" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213927" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-251040" selected="true"/>
      </xccdf:Profile>
      <xccdf:Profile id="xccdf_navy.navwar.niwcatlantic.scc.ms_profile_MAC-2_Sensitive">
        <xccdf:title>II - Mission Support Sensitive</xccdf:title>
        <xccdf:description>&lt;ProfileDescription&gt;&lt;/ProfileDescription&gt;</xccdf:description>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213900" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213901" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213902" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213903" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213904" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213905" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213906" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213907" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213908" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213909" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213910" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213911" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213912" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213913" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213914" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213915" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213916" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213917" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213918" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213919" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213920" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213921" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213922" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213923" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213924" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213926" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213927" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-251040" selected="true"/>
      </xccdf:Profile>
      <xccdf:Profile id="xccdf_navy.navwar.niwcatlantic.scc.ms_profile_MAC-3_Classified">
        <xccdf:title>III - Administrative Classified</xccdf:title>
        <xccdf:description>&lt;ProfileDescription&gt;&lt;/ProfileDescription&gt;</xccdf:description>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213900" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213901" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213902" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213903" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213904" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213905" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213906" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213907" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213908" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213909" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213910" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213911" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213912" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213913" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213914" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213915" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213916" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213917" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213918" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213919" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213920" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213921" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213922" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213923" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213924" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213926" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213927" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-251040" selected="true"/>
      </xccdf:Profile>
      <xccdf:Profile id="xccdf_navy.navwar.niwcatlantic.scc.ms_profile_MAC-3_Public">
        <xccdf:title>III - Administrative Public</xccdf:title>
        <xccdf:description>&lt;ProfileDescription&gt;&lt;/ProfileDescription&gt;</xccdf:description>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213900" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213901" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213902" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213903" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213904" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213905" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213906" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213907" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213908" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213909" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213910" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213911" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213912" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213913" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213914" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213915" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213916" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213917" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213918" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213919" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213920" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213921" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213922" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213923" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213924" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213926" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213927" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-251040" selected="true"/>
      </xccdf:Profile>
      <xccdf:Profile id="xccdf_navy.navwar.niwcatlantic.scc.ms_profile_MAC-3_Sensitive">
        <xccdf:title>III - Administrative Sensitive</xccdf:title>
        <xccdf:description>&lt;ProfileDescription&gt;&lt;/ProfileDescription&gt;</xccdf:description>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213900" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213901" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213902" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213903" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213904" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213905" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213906" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213907" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213908" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213909" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213910" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213911" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213912" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213913" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213914" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213915" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213916" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213917" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213918" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213919" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213920" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213921" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213922" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213923" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213924" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213926" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213927" selected="true"/>
        <xccdf:select idref="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-251040" selected="true"/>
      </xccdf:Profile>
      <xccdf:Group id="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213900">
        <xccdf:title>SRG-APP-000023-DB-000001</xccdf:title>
        <xccdf:description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</xccdf:description>
        <xccdf:Rule id="xccdf_navy.navwar.niwcatlantic.scc.ms_rule_SV-213900r1043176_rule" weight="10.0" severity="high">
          <xccdf:version>SQL6-D0-000100</xccdf:version>
          <xccdf:title>SQL Server databases must integrate with an organization-level authentication/access mechanism providing account management and automation for all users, groups, roles, and any other principals.</xccdf:title>
          <xccdf:description>&lt;VulnDiscussion&gt;Enterprise environments make account management for applications and databases challenging and complex. A manual process for account management functions adds the risk of a potential oversight or other error. Managing accounts for the same person in multiple places is inefficient and prone to problems with consistency and synchronization.

A comprehensive application account management process that includes automation helps to ensure that accounts designated as requiring attention are consistently and promptly addressed. 

Examples include, but are not limited to, using automation to take action on multiple accounts designated as inactive, suspended, or terminated, or by disabling accounts located in noncentralized account stores, such as multiple servers. Account management functions can also include: assignment of group or role membership; identifying account type; specifying user access authorizations (i.e., privileges); account removal, update, or termination; and administrative alerts. The use of automated mechanisms can include, for example: using email or text messaging to notify account managers when users are terminated or transferred; using the information system to monitor account usage; and using automated telephone notification to report atypical system account usage.

SQL Server must be configured to automatically utilize organization-level account management functions, and these functions must immediately enforce the organization's current account policy. 

Automation may be comprised of differing technologies that when placed together, contain an overall mechanism supporting an organization's automated account management requirements.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</xccdf:description>
          <xccdf:reference>
            <dc:title>DPMS Target MS SQL Server 2016 Database</dc:title>
            <dc:publisher>DISA</dc:publisher>
            <dc:type>DPMS Target</dc:type>
            <dc:subject>MS SQL Server 2016 Database</dc:subject>
            <dc:identifier>3992</dc:identifier>
          </xccdf:reference>
          <xccdf:ident system="http://cyber.mil/legacy">SV-93767</xccdf:ident>
          <xccdf:ident system="http://cyber.mil/legacy">V-79061</xccdf:ident>
          <xccdf:ident system="http://cyber.mil/cci">CCI-000015</xccdf:ident>
          <xccdf:fixtext fixref="F-15116r929095_fix">If mixed mode is required, document the need and justification; describe the measures taken to ensure the use of SQL Server authentication is kept to a minimum; describe the measures taken to safeguard passwords; list or describe the SQL Logins used; and obtain official approval.

If mixed mode is not required, disable it as follows:&#160;

In the SSMS Object Explorer, right-click on the server instance, select Properties &gt;&gt; Security page. Click the radio button for "Windows Authentication Mode", and then click "OK".

Restart the SQL Server instance.&#160;

OR

Run the statement:&#160;

USE [master]
EXEC xp_instance_regwrite N'HKEY_LOCAL_MACHINE', N'Software\Microsoft\MSSQLServer\MSSQLServer', N'LoginMode', REG_DWORD, 2
GO

Restart the SQL Server instance.&#160;

For each account being managed by SQL Server but not requiring it, drop or disable the SQL Database user. Replace it with an appropriately configured account, as needed.

To drop a User in the SSMS Object Explorer:&#160;

Navigate to Databases &gt;&gt; Security Users. Right-click on the User name, and then click "Delete".

To drop a User via a query:&#160;
USE database_name;
DROP USER &lt;user_name&gt;;</xccdf:fixtext>
          <xccdf:fix id="F-15116r929095_fix"/>
          <xccdf:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5" selector="">
            <xccdf:check-content-ref href="U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-oval2.xml" name="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:def:213900"/>
            <xccdf:check-content-ref href="U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-ocil.xml" name="ocil:navy.navwar.niwcatlantic.scc.ms.sql.server.db.hybrid:questionnaire:213900"/>
            <xccdf:check-content>oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:21390004;;Database;;database_owner;;Array</xccdf:check-content>
          </xccdf:check>
          <xccdf:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5" selector="hybrid">
            <xccdf:check-content-ref href="U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-oval2.xml" name="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:def:213900"/>
            <xccdf:check-content-ref href="U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-ocil.xml" name="ocil:navy.navwar.niwcatlantic.scc.ms.sql.server.db.hybrid:questionnaire:213900"/>
            <xccdf:check-content>oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:21390004;;Database;;database_owner;;Array</xccdf:check-content>
          </xccdf:check>
          <xccdf:check system="http://scap.nist.gov/schema/ocil/2" selector="manual">
            <xccdf:check-content-ref href="U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-ocil.xml" name="ocil:navy.navwar.niwcatlantic.scc.sql.server:questionnaire:101"/>
            <xccdf:check-content>Determine if SQL Server is configured to allow the use of contained databases, if it is, take the appropriate precautions to limit their risk.

1) In the Object Explorer in SQL Server Management Studio (SSMS), right-click on the server instance, select "Properties", and then select the "Advanced" page.
If "Enabled Contained Databases" is "False", this is not a finding.

2) If "Enabled Contained Databases" is "True", then in a query interface such as the SSMS Transact-SQL editor, run the statement:
EXEC sp_configure 'contained database authentication'
If the returned value in the "config_value" and/or "run_value" column is "0", this is not a finding.

3) Determine whether SQL Server is configured to use only Windows authentication.
In a query interface such as the SSMS Transact-SQL editor, run the statement:
SELECT CASE SERVERPROPERTY('IsIntegratedSecurityOnly')  
 WHEN 1 THEN 'Windows Authentication'  
 WHEN 0 THEN 'Windows and SQL Server Authentication'  
END as [Authentication Mode]
If the returned value in the "Authentication Mode" column is "Windows Authentication", this is not a finding.

If mixed mode (both SQL Server authentication and Windows authentication) is in use, then it must be documented and approved.

From the documentation, obtain the list of accounts authorized to be managed by SQL Server.
Determine the accounts (SQL Logins) actually managed by SQL Server.

Run the statement:

SELECT name
FROM sys.database_principals
WHERE type_desc = 'SQL_USER'
AND authentication_type_desc = 'DATABASE';

If any accounts listed by the query are not listed in the documentation, this is a finding.
Documentation must be approved by the information system security officer (ISSO)/ information system security manager (ISSM).</xccdf:check-content>
          </xccdf:check>
        </xccdf:Rule>
      </xccdf:Group>
      <xccdf:Group id="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213901">
        <xccdf:title>SRG-APP-000033-DB-000084</xccdf:title>
        <xccdf:description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</xccdf:description>
        <xccdf:Rule id="xccdf_navy.navwar.niwcatlantic.scc.ms_rule_SV-213901r1112497_rule" weight="10.0" severity="high">
          <xccdf:version>SQL6-D0-000300</xccdf:version>
          <xccdf:title>SQL Server must enforce approved authorizations for logical access to database information and system resources in accordance with applicable access control policies.</xccdf:title>
          <xccdf:description>&lt;VulnDiscussion&gt;Authentication with a DoD-approved PKI certificate does not necessarily imply authorization to access SQL Server. To mitigate the risk of unauthorized access to sensitive information by entities that have been issued certificates by DoD-approved PKIs, all DoD systems, including databases, must be properly configured to implement access control policies. 

Successful authentication must not automatically give an entity access to an asset or security boundary. Authorization procedures and controls must be implemented to ensure each authenticated entity also has a validated and current authorization. Authorization is the process of determining whether an entity, once authenticated, is permitted to access a specific asset. Information systems use access control policies and enforcement mechanisms to implement this requirement. 

Access control policies include identity-based policies, role-based policies, and attribute-based policies. Access enforcement mechanisms include access control lists, access control matrices, and cryptography. These policies and mechanisms must be employed by the application to control access between users (or processes acting on behalf of users) and objects (e.g., devices, files, records, processes, programs, and domains) in the information system. 

This requirement is applicable to access control enforcement applications, a category that includes database management systems.  If SQL Server does not follow applicable policy when approving access, it may be in conflict with networks or other applications in the information system. This may result in users either gaining or being denied access inappropriately and in conflict with applicable policy.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</xccdf:description>
          <xccdf:reference>
            <dc:title>DPMS Target MS SQL Server 2016 Database</dc:title>
            <dc:publisher>DISA</dc:publisher>
            <dc:type>DPMS Target</dc:type>
            <dc:subject>MS SQL Server 2016 Database</dc:subject>
            <dc:identifier>3992</dc:identifier>
          </xccdf:reference>
          <xccdf:ident system="http://cyber.mil/legacy">SV-93771</xccdf:ident>
          <xccdf:ident system="http://cyber.mil/legacy">V-79065</xccdf:ident>
          <xccdf:ident system="http://cyber.mil/cci">CCI-000213</xccdf:ident>
          <xccdf:fixtext fixref="F-15117r313136_fix">Use GRANT, REVOKE, DENY, ALTER ROLE &#8230; ADD MEMBER &#8230; and/or ALTER ROLE &#8230;. DROP MEMBER statements to add and remove permissions on database-level securables, bringing them into line with the documented requirements.</xccdf:fixtext>
          <xccdf:fix id="F-15117r313136_fix"/>
          <xccdf:check system="http://scap.nist.gov/schema/ocil/2" selector="">
            <xccdf:check-content-ref href="U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-ocil.xml" name="ocil:navy.navwar.niwcatlantic.scc.sql.server:questionnaire:301"/>
          </xccdf:check>
          <xccdf:check system="http://scap.nist.gov/schema/ocil/2" selector="manual">
            <xccdf:check-content-ref href="U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-ocil.xml" name="ocil:navy.navwar.niwcatlantic.scc.sql.server:questionnaire:301"/>
            <xccdf:check-content>Review the system documentation to determine the required levels of protection for securables in the database by type of login. 

If the database is tempdb, this is not applicable.

Review the permissions actually in place in the database. 

If the actual permissions do not match the documented requirements, this is a finding.

Use the supplemental file "Database permission assignments to users and roles.sql".</xccdf:check-content>
          </xccdf:check>
        </xccdf:Rule>
      </xccdf:Group>
      <xccdf:Group id="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213902">
        <xccdf:title>SRG-APP-000080-DB-000063</xccdf:title>
        <xccdf:description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</xccdf:description>
        <xccdf:Rule id="xccdf_navy.navwar.niwcatlantic.scc.ms_rule_SV-213902r960864_rule" weight="10.0" severity="medium">
          <xccdf:version>SQL6-D0-000400</xccdf:version>
          <xccdf:title>SQL Server must protect against a user falsely repudiating by ensuring only clearly unique Active Directory user accounts can connect to the database.</xccdf:title>
          <xccdf:description>&lt;VulnDiscussion&gt;Non-repudiation of actions taken is required in order to maintain data integrity. Examples of particular actions taken by individuals include creating information, sending a message, approving information (e.g., indicating concurrence or signing a contract), and receiving a message. 

Non-repudiation protects against later claims by a user of not having created, modified, or deleted a particular data item or collection of data in the database.

In designing a database, the organization must define the types of data and the user actions that must be protected from repudiation. The implementation must then include building audit features into the application data tables and configuring the DBMS's audit tools to capture the necessary audit trail. Design and implementation also must ensure that applications pass individual user identification to the DBMS, even where the application connects to the DBMS with a standard, shared account.

If the computer account of a remote computer is granted access to a SQL Server database, any service or scheduled task running as NT AUTHORITY\SYSTEM or NT AUTHORITY\NETWORK SERVICE can log into the instance and perform actions. These actions cannot be traced back to a specific user or process.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</xccdf:description>
          <xccdf:reference>
            <dc:title>DPMS Target MS SQL Server 2016 Database</dc:title>
            <dc:publisher>DISA</dc:publisher>
            <dc:type>DPMS Target</dc:type>
            <dc:subject>MS SQL Server 2016 Database</dc:subject>
            <dc:identifier>3992</dc:identifier>
          </xccdf:reference>
          <xccdf:ident system="http://cyber.mil/legacy">SV-93773</xccdf:ident>
          <xccdf:ident system="http://cyber.mil/legacy">V-79067</xccdf:ident>
          <xccdf:ident system="http://cyber.mil/cci">CCI-000166</xccdf:ident>
          <xccdf:fixtext fixref="F-15118r313139_fix">Remove all users that were returned in the check SQL Statement:

SELECT name
FROM sys.database_principals
WHERE type in ('U','G')
AND name LIKE '%$'

To remove users:

Run the following command for each user:

DROP USER [ IF EXISTS ] &lt;user_name&gt;;</xccdf:fixtext>
          <xccdf:fix id="F-15118r313139_fix"/>
          <xccdf:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5" selector="">
            <xccdf:check-content-ref href="U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-oval2.xml" name="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.2016.db:def:213902"/>
          </xccdf:check>
          <xccdf:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5" selector="automated">
            <xccdf:check-content-ref href="U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-oval2.xml" name="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.2016.db:def:213902"/>
          </xccdf:check>
          <xccdf:check system="http://scap.nist.gov/schema/ocil/2" selector="manual">
            <xccdf:check-content-ref href="U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-ocil.xml" name="ocil:navy.navwar.niwcatlantic.scc.sql.server:questionnaire:501"/>
            <xccdf:check-content>Execute the following query:

SELECT name
FROM sys.database_principals
WHERE type in ('U','G')
AND name LIKE '%$'

If no users are returned, this is not a finding.

If users are returned, determine whether each user is a computer account.

Launch PowerShell.

Execute the following code:

Note: &lt;name&gt; represents the username portion of the user. For example; if the user is "CONTOSO\user1$", the username is "user1".

([ADSISearcher]"(&amp;(ObjectCategory=Computer)(Name=&lt;name&gt;))").FindAll()

If no account information is returned, this is not a finding.

If account information is returned, this is a finding.</xccdf:check-content>
          </xccdf:check>
        </xccdf:Rule>
      </xccdf:Group>
      <xccdf:Group id="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213903">
        <xccdf:title>SRG-APP-000080-DB-000063</xccdf:title>
        <xccdf:description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</xccdf:description>
        <xccdf:Rule id="xccdf_navy.navwar.niwcatlantic.scc.ms_rule_SV-213903r960864_rule" weight="10.0" severity="low">
          <xccdf:version>SQL6-D0-000500</xccdf:version>
          <xccdf:title>SQL Server must protect against a user falsely repudiating by use of system-versioned tables (Temporal Tables).</xccdf:title>
          <xccdf:description>&lt;VulnDiscussion&gt;Non-repudiation of actions taken is required in order to maintain data integrity. Examples of particular actions taken by individuals include creating information, sending a message, approving information (e.g., indicating concurrence or signing a contract), and receiving a message.

Non-repudiation protects against later claims by a user of not having created, modified, or deleted a particular data item or collection of data in the database. 

In designing a database, the organization must define the types of data and the user actions that must be protected from repudiation. The implementation must then include building audit features into the application data tables and configuring SQL Server's audit tools to capture the necessary audit trail. Design and implementation also must ensure that applications pass individual user identification to SQL Server, even where the application connects to SQL Server with a standard, shared account. 

Applications should use temporal tables to track the changes and history of sensitive data.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</xccdf:description>
          <xccdf:reference>
            <dc:title>DPMS Target MS SQL Server 2016 Database</dc:title>
            <dc:publisher>DISA</dc:publisher>
            <dc:type>DPMS Target</dc:type>
            <dc:subject>MS SQL Server 2016 Database</dc:subject>
            <dc:identifier>3992</dc:identifier>
          </xccdf:reference>
          <xccdf:ident system="http://cyber.mil/legacy">SV-93775</xccdf:ident>
          <xccdf:ident system="http://cyber.mil/legacy">V-79069</xccdf:ident>
          <xccdf:ident system="http://cyber.mil/cci">CCI-000166</xccdf:ident>
          <xccdf:fixtext fixref="F-15119r313142_fix">Alter sensitive tables to utilize system versioning.

Alter non-temporal table to define periods for system versioning .

ALTER TABLE InsurancePolicy 
ADD PERIOD FOR SYSTEM_TIME (SysStartTime, SysEndTime),   
SysStartTime datetime2 GENERATED ALWAYS AS ROW START HIDDEN NOT NULL DEFAULT GETUTCDATE(),  
SysEndTime datetime2 GENERATED ALWAYS AS ROW END HIDDEN NOT NULL DEFAULT CONVERT(DATETIME2, '9999-12-31 23:59:59.99999999');  
 
ALTER TABLE InsurancePolicy SET (SYSTEM_VERSIONING = ON (HISTORY_TABLE=dbo.InsurancePolicyHistory));

https://docs.microsoft.com/sql/t-sql/statements/alter-table-transact-sql?view=sql-server-2016#system_versionin</xccdf:fixtext>
          <xccdf:fix id="F-15119r313142_fix"/>
          <xccdf:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5" selector="">
            <xccdf:check-content-ref href="U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-oval2.xml" name="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:def:213903"/>
            <xccdf:check-content-ref href="U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-ocil.xml" name="ocil:navy.navwar.niwcatlantic.scc.ms.sql.server.db.hybrid:questionnaire:213903"/>
            <xccdf:check-content>oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:21390303;;Database;;table_name;;Array</xccdf:check-content>
          </xccdf:check>
          <xccdf:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5" selector="hybrid">
            <xccdf:check-content-ref href="U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-oval2.xml" name="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:def:213903"/>
            <xccdf:check-content-ref href="U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-ocil.xml" name="ocil:navy.navwar.niwcatlantic.scc.ms.sql.server.db.hybrid:questionnaire:213903"/>
            <xccdf:check-content>oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:21390303;;Database;;table_name;;Array</xccdf:check-content>
          </xccdf:check>
          <xccdf:check system="http://scap.nist.gov/schema/ocil/2" selector="manual">
            <xccdf:check-content-ref href="U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-ocil.xml" name="ocil:navy.navwar.niwcatlantic.scc.sql.server:questionnaire:701"/>
            <xccdf:check-content>Check the server documentation to determine if collecting and keeping historical versions of a table is required.

If collecting and keeping historical versions of a table is NOT required, this is not a finding.

Find all of the temporal tables in the database using the following query:

SELECT SCHEMA_NAME(T.schema_id) AS schema_name, T.name AS table_name, T.temporal_type_desc, SCHEMA_NAME(H.schema_id) + '.' + H.name AS history_table
FROM sys.tables T
JOIN sys.tables H ON T.history_table_id = H.object_id
WHERE T.temporal_type != 0
ORDER BY schema_name, table_name

Using the system documentation, determine which tables are required to be temporal tables.

If any tables listed in the documentation are not in the list created by running the above statement, this is a finding.

Ensure a field exists documenting the login and/or user who last modified the record. 

If this does not exist, this is a finding.</xccdf:check-content>
          </xccdf:check>
        </xccdf:Rule>
      </xccdf:Group>
      <xccdf:Group id="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213904">
        <xccdf:title>SRG-APP-000080-DB-000063</xccdf:title>
        <xccdf:description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</xccdf:description>
        <xccdf:Rule id="xccdf_navy.navwar.niwcatlantic.scc.ms_rule_SV-213904r960864_rule" weight="10.0" severity="medium">
          <xccdf:version>SQL6-D0-000600</xccdf:version>
          <xccdf:title>SQL Server must protect against a user falsely repudiating by ensuring databases are not in a trust relationship.</xccdf:title>
          <xccdf:description>&lt;VulnDiscussion&gt;Non-repudiation of actions taken is required in order to maintain data integrity. Examples of particular actions taken by individuals include creating information, sending a message, approving information (e.g., indicating concurrence or signing a contract), and receiving a message. 

Non-repudiation protects against later claims by a user of not having created, modified, or deleted a particular data item or collection of data in the database.

SQL Server provides the ability for high privileged accounts to impersonate users in a database using the TRUSTWORTHY feature.&#160;This will allow members of the fixed database role to impersonate any user within the database.&#160;&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</xccdf:description>
          <xccdf:reference>
            <dc:title>DPMS Target MS SQL Server 2016 Database</dc:title>
            <dc:publisher>DISA</dc:publisher>
            <dc:type>DPMS Target</dc:type>
            <dc:subject>MS SQL Server 2016 Database</dc:subject>
            <dc:identifier>3992</dc:identifier>
          </xccdf:reference>
          <xccdf:ident system="http://cyber.mil/legacy">SV-93777</xccdf:ident>
          <xccdf:ident system="http://cyber.mil/legacy">V-79071</xccdf:ident>
          <xccdf:ident system="http://cyber.mil/cci">CCI-000166</xccdf:ident>
          <xccdf:fixtext fixref="F-15120r313145_fix">Disable trustworthy on the database.

ALTER DATABASE [&lt;database name&gt;] SET TRUSTWORTHY OFF</xccdf:fixtext>
          <xccdf:fix id="F-15120r313145_fix"/>
          <xccdf:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5" selector="">
            <xccdf:check-content-ref href="U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-oval2.xml" name="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:def:213904"/>
            <xccdf:check-content-ref href="U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-ocil.xml" name="ocil:navy.navwar.niwcatlantic.scc.ms.sql.server.db.hybrid:questionnaire:213904"/>
            <xccdf:check-content>oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:21390404;;Database;;database_owner;;Array</xccdf:check-content>
          </xccdf:check>
          <xccdf:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5" selector="hybrid">
            <xccdf:check-content-ref href="U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-oval2.xml" name="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:def:213904"/>
            <xccdf:check-content-ref href="U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-ocil.xml" name="ocil:navy.navwar.niwcatlantic.scc.ms.sql.server.db.hybrid:questionnaire:213904"/>
            <xccdf:check-content>oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:21390404;;Database;;database_owner;;Array</xccdf:check-content>
          </xccdf:check>
          <xccdf:check system="http://scap.nist.gov/schema/ocil/2" selector="manual">
            <xccdf:check-content-ref href="U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-ocil.xml" name="ocil:navy.navwar.niwcatlantic.scc.sql.server:questionnaire:901"/>
            <xccdf:check-content>If the database being reviewed is MSDB, trustworthy is required to be enabled, and therefore this is not a finding.

Execute the following query:

SELECT SUSER_SNAME(d.owner_sid) AS DatabaseOwner,
CASE
WHEN d.is_trustworthy_on = 0 THEN 'No'
WHEN d.is_trustworthy_on = 1 THEN 'Yes'
END AS IsTrustworthy,
CASE
WHEN role.name IN ('sysadmin','securityadmin')
OR permission.permission_name = 'CONTROL SERVER'
THEN 'YES'
ELSE 'No'
END AS 'IsOwnerPrivileged'
FROM sys.databases d
LEFT JOIN sys.server_principals login ON d.owner_sid = login.sid
LEFT JOIN sys.server_role_members rm ON login.principal_id = rm.member_principal_id
LEFT JOIN sys.server_principals role ON rm.role_principal_id = role.principal_id
LEFT JOIN sys.server_permissions permission ON login.principal_id = permission.grantee_principal_id
WHERE d.name = DB_NAME()

If trustworthy is not enabled, this is not a finding.

If trustworthy is enabled and the database owner is not a privileged account, this is not a finding.

If trustworthy is enabled and the database owner is a privileged account, review the system documentation to determine if the trustworthy property is required and authorized. If this is not documented, this is a finding.</xccdf:check-content>
          </xccdf:check>
        </xccdf:Rule>
      </xccdf:Group>
      <xccdf:Group id="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213905">
        <xccdf:title>SRG-APP-000090-DB-000065</xccdf:title>
        <xccdf:description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</xccdf:description>
        <xccdf:Rule id="xccdf_navy.navwar.niwcatlantic.scc.ms_rule_SV-213905r960882_rule" weight="10.0" severity="medium">
          <xccdf:version>SQL6-D0-000700</xccdf:version>
          <xccdf:title>SQL Server must allow only the ISSM (or individuals or roles appointed by the ISSM) to select which auditable events are to be audited.</xccdf:title>
          <xccdf:description>&lt;VulnDiscussion&gt;Without the capability to restrict which roles and individuals can select which events are audited, unauthorized personnel may be able to prevent or interfere with the auditing of critical events.

Suppression of auditing could permit an adversary to evade detection.

Misconfigured audits can degrade the system's performance by overwhelming the audit log. Misconfigured audits may also make it more difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</xccdf:description>
          <xccdf:reference>
            <dc:title>DPMS Target MS SQL Server 2016 Database</dc:title>
            <dc:publisher>DISA</dc:publisher>
            <dc:type>DPMS Target</dc:type>
            <dc:subject>MS SQL Server 2016 Database</dc:subject>
            <dc:identifier>3992</dc:identifier>
          </xccdf:reference>
          <xccdf:ident system="http://cyber.mil/legacy">SV-93779</xccdf:ident>
          <xccdf:ident system="http://cyber.mil/legacy">V-79073</xccdf:ident>
          <xccdf:ident system="http://cyber.mil/cci">CCI-000171</xccdf:ident>
          <xccdf:fixtext fixref="F-15121r313148_fix">Create a database role specifically for audit maintainers, and give it permission to maintain audits, without granting it unnecessary permissions (The role name used here is an example; other names may be used.):

CREATE ROLE DATABASE_AUDIT_MAINTAINERS;
GO

GRANT ALTER ANY DATABASE AUDIT TO DATABASE_AUDIT_MAINTAINERS;
GO

Use REVOKE and/or DENY and/or ALTER ROLE ... DROP MEMBER ... statements to remove the ALTER ANY DATABASE AUDIT permission from all users.  Then, for each authorized database user, run the statement:  

ALTER ROLE DATABASE_AUDIT_MAINTAINERS ADD MEMBER;
GO

Use REVOKE and/or DENY and/or ALTER SERVER ROLE ... DROP MEMBER ... statements to remove CONTROL DATABASE permission from logins that do not need it.</xccdf:fixtext>
          <xccdf:fix id="F-15121r313148_fix"/>
          <xccdf:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5" selector="">
            <xccdf:check-content-ref href="U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-oval2.xml" name="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:def:213905"/>
            <xccdf:check-content-ref href="U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-ocil.xml" name="ocil:navy.navwar.niwcatlantic.scc.ms.sql.server.db.hybrid:questionnaire:213905"/>
            <xccdf:check-content>oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:21390504;;Database;;role_member_name;;Array</xccdf:check-content>
          </xccdf:check>
          <xccdf:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5" selector="hybrid">
            <xccdf:check-content-ref href="U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-oval2.xml" name="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:def:213905"/>
            <xccdf:check-content-ref href="U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-ocil.xml" name="ocil:navy.navwar.niwcatlantic.scc.ms.sql.server.db.hybrid:questionnaire:213905"/>
            <xccdf:check-content>oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:21390504;;Database;;role_member_name;;Array</xccdf:check-content>
          </xccdf:check>
          <xccdf:check system="http://scap.nist.gov/schema/ocil/2" selector="manual">
            <xccdf:check-content-ref href="U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-ocil.xml" name="ocil:navy.navwar.niwcatlantic.scc.sql.server:questionnaire:1101"/>
            <xccdf:check-content>Obtain the list of approved audit maintainers from the system documentation.

Use the following query to review database roles and their membership, all of which enable the ability to create and maintain audit specifications.

SELECT
    R.name AS role_name,
    RM.name AS role_member_name,
    RM.type_desc
FROM sys.database_principals R
JOIN sys.database_role_members DRM ON 
    R.principal_id = DRM.role_principal_id
JOIN sys.database_principals RM ON 
    DRM.member_principal_id = RM.principal_id
WHERE R.type = 'R'
    AND R.name = 'db_owner'
ORDER BY 
    role_member_name

If any role memberships are not documented and authorized, this is a finding.	


Review the database roles and individual users that have the following permissions, all of which enable the ability to create and maintain audit definitions.

ALTER ANY DATABASE AUDIT
CONTROL

Use the following query to determine the roles and users that have the listed permissions:

SELECT
	PERM.permission_name,
	DP.name AS principal_name,
	DP.type_desc AS principal_type,
	DBRM.role_member_name
FROM sys.database_permissions PERM
JOIN sys.database_principals DP ON PERM.grantee_principal_id = DP.principal_id
LEFT OUTER JOIN (
	SELECT
		R.principal_id AS role_principal_id,
		R.name AS role_name,
		RM.name AS role_member_name
	FROM sys.database_principals R
	JOIN sys.database_role_members DRM ON R.principal_id = DRM.role_principal_id
	JOIN sys.database_principals RM ON DRM.member_principal_id = RM.principal_id
	WHERE R.type = 'R'
) DBRM ON DP.principal_id = DBRM.role_principal_id
WHERE PERM.permission_name IN ('CONTROL','ALTER ANY DATABASE AUDIT')
ORDER BY
	permission_name, 
	principal_name, 
	role_member_name


If any of the roles or users returned have permissions that are not documented, or the documented audit maintainers do not have permissions, this is a finding.</xccdf:check-content>
          </xccdf:check>
        </xccdf:Rule>
      </xccdf:Group>
      <xccdf:Group id="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213906">
        <xccdf:title>SRG-APP-000133-DB-000179</xccdf:title>
        <xccdf:description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</xccdf:description>
        <xccdf:Rule id="xccdf_navy.navwar.niwcatlantic.scc.ms_rule_SV-213906r960960_rule" weight="10.0" severity="medium">
          <xccdf:version>SQL6-D0-001100</xccdf:version>
          <xccdf:title>SQL Server must limit privileges to change software modules, to include stored procedures, functions, and triggers.</xccdf:title>
          <xccdf:description>&lt;VulnDiscussion&gt;If the system were to allow any user to make changes to software libraries, then those changes might be implemented without undergoing the appropriate testing and approvals that are part of a robust change management process.

Accordingly, only qualified and authorized individuals shall be allowed to obtain access to information system components for purposes of initiating changes, including upgrades and modifications.

Unmanaged changes that occur to the database software libraries or configuration can lead to unauthorized or compromised installations.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</xccdf:description>
          <xccdf:reference>
            <dc:title>DPMS Target MS SQL Server 2016 Database</dc:title>
            <dc:publisher>DISA</dc:publisher>
            <dc:type>DPMS Target</dc:type>
            <dc:subject>MS SQL Server 2016 Database</dc:subject>
            <dc:identifier>3992</dc:identifier>
          </xccdf:reference>
          <xccdf:ident system="http://cyber.mil/legacy">SV-93781</xccdf:ident>
          <xccdf:ident system="http://cyber.mil/legacy">V-79075</xccdf:ident>
          <xccdf:ident system="http://cyber.mil/cci">CCI-001499</xccdf:ident>
          <xccdf:fixtext fixref="F-15122r313151_fix">Revoke the ALTER permission from unauthorized users and roles.

REVOKE ALTER ON [&lt;Object Name&gt;] TO [&lt;Principal Name&gt;]</xccdf:fixtext>
          <xccdf:fix id="F-15122r313151_fix"/>
          <xccdf:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5" selector="">
            <xccdf:check-content-ref href="U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-oval2.xml" name="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.2016.db:def:213906"/>
            <xccdf:check-content-ref href="U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-ocil.xml" name="ocil:navy.navwar.niwcatlantic.scc.ms.sql.server.db.hybrid:questionnaire:213906"/>
            <xccdf:check-content>oval:navy.navwar.niwcatlantic.scc.ms.sql.server.2016.db:var:21390604;;Database;;user_name;;Array</xccdf:check-content>
          </xccdf:check>
          <xccdf:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5" selector="hybrid">
            <xccdf:check-content-ref href="U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-oval2.xml" name="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.2016.db:def:213906"/>
            <xccdf:check-content-ref href="U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-ocil.xml" name="ocil:navy.navwar.niwcatlantic.scc.ms.sql.server.db.hybrid:questionnaire:213906"/>
            <xccdf:check-content>oval:navy.navwar.niwcatlantic.scc.ms.sql.server.2016.db:var:21390604;;Database;;user_name;;Array</xccdf:check-content>
          </xccdf:check>
          <xccdf:check system="http://scap.nist.gov/schema/ocil/2" selector="manual">
            <xccdf:check-content-ref href="U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-ocil.xml" name="ocil:navy.navwar.niwcatlantic.scc.sql.server:questionnaire:1301"/>
            <xccdf:check-content>Obtain a listing of users and roles who are authorized to change stored procedures, functions, and triggers from the server documentation.

In each user database, execute the following query:

SELECT P.type_desc AS principal_type, P.name AS principal_name, O.type_desc,
  CASE class
   WHEN 0 THEN DB_NAME()
   WHEN 1 THEN OBJECT_SCHEMA_NAME(major_id) + '.' + OBJECT_NAME(major_id)
   WHEN 3 THEN SCHEMA_NAME(major_id)
    ELSE class_desc + '(' + CAST(major_id AS nvarchar) + ')'
   END AS securable_name, DP.state_desc, DP.permission_name
FROM sys.database_permissions DP
JOIN sys.database_principals P ON DP.grantee_principal_id = P.principal_id
LEFT OUTER JOIN sys.all_objects O ON O.object_id = DP.major_id AND O.type IN ('TR','TA','P','X','RF','PC','IF','FN','TF','U')
WHERE DP.type IN ('AL','ALTG') AND DP.class IN (0, 1, 53)

SELECT R.name AS role_name, M.type_desc AS principal_type, M.name AS principal_name
FROM sys.database_principals R
JOIN sys.database_role_members DRM ON R.principal_id = DRM.role_principal_id
JOIN sys.database_principals M ON DRM.member_principal_id = M.principal_id
WHERE R.name IN ('db_ddladmin','db_owner')
   AND M.name != 'dbo'

If any users or role permissions returned are not authorized to modify the specified object or type, this is a finding.

If any user or role membership is not authorized, this is a finding.</xccdf:check-content>
          </xccdf:check>
        </xccdf:Rule>
      </xccdf:Group>
      <xccdf:Group id="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213907">
        <xccdf:title>SRG-APP-000133-DB-000179</xccdf:title>
        <xccdf:description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</xccdf:description>
        <xccdf:Rule id="xccdf_navy.navwar.niwcatlantic.scc.ms_rule_SV-213907r960960_rule" weight="10.0" severity="medium">
          <xccdf:version>SQL6-D0-001200</xccdf:version>
          <xccdf:title>SQL Server must limit privileges to change software modules, to include stored procedures, functions, and triggers, and links to software external to SQL Server.</xccdf:title>
          <xccdf:description>&lt;VulnDiscussion&gt;If the system were to allow any user to make changes to software libraries, then those changes might be implemented without undergoing the appropriate testing and approvals that are part of a robust change management process.

Accordingly, only qualified and authorized individuals shall be allowed to obtain access to information system components for purposes of initiating changes, including upgrades and modifications.

Unmanaged changes that occur to the database software libraries or configuration can lead to unauthorized or compromised installations.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</xccdf:description>
          <xccdf:reference>
            <dc:title>DPMS Target MS SQL Server 2016 Database</dc:title>
            <dc:publisher>DISA</dc:publisher>
            <dc:type>DPMS Target</dc:type>
            <dc:subject>MS SQL Server 2016 Database</dc:subject>
            <dc:identifier>3992</dc:identifier>
          </xccdf:reference>
          <xccdf:ident system="http://cyber.mil/legacy">SV-93783</xccdf:ident>
          <xccdf:ident system="http://cyber.mil/legacy">V-79077</xccdf:ident>
          <xccdf:ident system="http://cyber.mil/cci">CCI-001499</xccdf:ident>
          <xccdf:fixtext fixref="F-15123r313154_fix">Transfer ownership of database schemas to authorized database principals.

ALTER AUTHORIZATION ON SCHEMA::[&lt;Schema Name&gt;] TO [&lt;Principal Name&gt;]</xccdf:fixtext>
          <xccdf:fix id="F-15123r313154_fix"/>
          <xccdf:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5" selector="">
            <xccdf:check-content-ref href="U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-oval2.xml" name="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:def:213907"/>
            <xccdf:check-content-ref href="U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-ocil.xml" name="ocil:navy.navwar.niwcatlantic.scc.ms.sql.server.db.hybrid:questionnaire:213907"/>
            <xccdf:check-content>oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:21390704;;Database;;schema_to_owner;;Array</xccdf:check-content>
          </xccdf:check>
          <xccdf:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5" selector="hybrid">
            <xccdf:check-content-ref href="U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-oval2.xml" name="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:def:213907"/>
            <xccdf:check-content-ref href="U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-ocil.xml" name="ocil:navy.navwar.niwcatlantic.scc.ms.sql.server.db.hybrid:questionnaire:213907"/>
            <xccdf:check-content>oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:21390704;;Database;;schema_to_owner;;Array</xccdf:check-content>
          </xccdf:check>
          <xccdf:check system="http://scap.nist.gov/schema/ocil/2" selector="manual">
            <xccdf:check-content-ref href="U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-ocil.xml" name="ocil:navy.navwar.niwcatlantic.scc.sql.server:questionnaire:1501"/>
            <xccdf:check-content>Obtain a listing of schema ownership from the server documentation.

Execute the following query to obtain a current listing of schema ownership.

SELECT S.name AS schema_name, P.name AS owning_principal
FROM sys.schemas S
JOIN sys.database_principals P ON S.principal_id = P.principal_id
ORDER BY schema_name

If any schema is owned by an unauthorized database principal, this is a finding.</xccdf:check-content>
          </xccdf:check>
        </xccdf:Rule>
      </xccdf:Group>
      <xccdf:Group id="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213908">
        <xccdf:title>SRG-APP-000133-DB-000200</xccdf:title>
        <xccdf:description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</xccdf:description>
        <xccdf:Rule id="xccdf_navy.navwar.niwcatlantic.scc.ms_rule_SV-213908r960960_rule" weight="10.0" severity="medium">
          <xccdf:version>SQL6-D0-001300</xccdf:version>
          <xccdf:title>Database objects (including but not limited to tables, indexes, storage, stored procedures, functions, triggers, links to software external to SQL Server, etc.) must be owned by database/DBMS principals authorized for ownership.</xccdf:title>
          <xccdf:description>&lt;VulnDiscussion&gt;Within the database, object ownership implies full privileges to the owned object, including the privilege to assign access to the owned objects to other subjects. Database functions and procedures can be coded using definer's rights. This allows anyone who utilizes the object to perform the actions if they were the owner. If not properly managed, this can lead to privileged actions being taken by unauthorized individuals.

Conversely, if critical tables or other objects in SQL Server rely on unauthorized owner accounts, these objects may be lost when an account is removed.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</xccdf:description>
          <xccdf:reference>
            <dc:title>DPMS Target MS SQL Server 2016 Database</dc:title>
            <dc:publisher>DISA</dc:publisher>
            <dc:type>DPMS Target</dc:type>
            <dc:subject>MS SQL Server 2016 Database</dc:subject>
            <dc:identifier>3992</dc:identifier>
          </xccdf:reference>
          <xccdf:ident system="http://cyber.mil/legacy">SV-93785</xccdf:ident>
          <xccdf:ident system="http://cyber.mil/legacy">V-79079</xccdf:ident>
          <xccdf:ident system="http://cyber.mil/cci">CCI-001499</xccdf:ident>
          <xccdf:fixtext fixref="F-15124r313157_fix">Add and/or update system documentation to include any accounts authorized for object ownership and remove any account not authorized. 

To change the schema owning a database object in SQL Server, use this code as an example: 

USE AdventureWorks2012;  
GO  
ALTER SCHEMA HumanResources TRANSFER Person.Address;  
GO  

Caution: This can break code. This Fix should be implemented in conjunction with corrections to such code. Test before deploying in production. Deploy during a scheduled maintenance window.</xccdf:fixtext>
          <xccdf:fix id="F-15124r313157_fix"/>
          <xccdf:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5" selector="">
            <xccdf:check-content-ref href="U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-oval2.xml" name="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:def:213908"/>
            <xccdf:check-content-ref href="U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-ocil.xml" name="ocil:navy.navwar.niwcatlantic.scc.ms.sql.server.db.hybrid:questionnaire:213908"/>
            <xccdf:check-content>oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:21390804;;Database;;object_owner;;Array</xccdf:check-content>
          </xccdf:check>
          <xccdf:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5" selector="hybrid">
            <xccdf:check-content-ref href="U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-oval2.xml" name="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:def:213908"/>
            <xccdf:check-content-ref href="U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-ocil.xml" name="ocil:navy.navwar.niwcatlantic.scc.ms.sql.server.db.hybrid:questionnaire:213908"/>
            <xccdf:check-content>oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:21390804;;Database;;object_owner;;Array</xccdf:check-content>
          </xccdf:check>
          <xccdf:check system="http://scap.nist.gov/schema/ocil/2" selector="manual">
            <xccdf:check-content-ref href="U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-ocil.xml" name="ocil:navy.navwar.niwcatlantic.scc.sql.server:questionnaire:1701"/>
            <xccdf:check-content>Review system documentation to identify SQL Server accounts authorized to own database objects. 

If the SQL Server database ownership list does not exist or needs to be updated, this is a finding. 

The following query can be of use in making this determination: 

;with objects_cte as
(SELECT o.name, o.type_desc,
   CASE
    WHEN o.principal_id is null then s.principal_id
     ELSE o.principal_id
    END as principal_id
 FROM sys.objects o
 INNER JOIN sys.schemas s
 ON o.schema_id = s.schema_id
 WHERE o.is_ms_shipped = 0
)
SELECT cte.name, cte.type_desc, dp.name as ObjectOwner 
FROM objects_cte cte
INNER JOIN sys.database_principals dp
ON cte.principal_id = dp.principal_id
ORDER BY dp.name, cte.name

If any of the listed owners is not authorized, this is a finding.</xccdf:check-content>
          </xccdf:check>
        </xccdf:Rule>
      </xccdf:Group>
      <xccdf:Group id="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213909">
        <xccdf:title>SRG-APP-000133-DB-000362</xccdf:title>
        <xccdf:description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</xccdf:description>
        <xccdf:Rule id="xccdf_navy.navwar.niwcatlantic.scc.ms_rule_SV-213909r960960_rule" weight="10.0" severity="medium">
          <xccdf:version>SQL6-D0-001400</xccdf:version>
          <xccdf:title>The role(s)/group(s) used to modify database structure (including but not necessarily limited to tables, indexes, storage, etc.) and logic modules (stored procedures, functions, triggers, links to software external to SQL Server, etc.) must be restricted to authorized users.</xccdf:title>
          <xccdf:description>&lt;VulnDiscussion&gt;If SQL Server were to allow any user to make changes to database structure or logic, then those changes might be implemented without undergoing the appropriate testing and approvals that are part of a robust change management process.

Accordingly, only qualified and authorized individuals shall be allowed to obtain access to information system components for purposes of initiating changes, including upgrades and modifications.

Unmanaged changes that occur to the database software libraries or configuration can lead to unauthorized or compromised installations.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</xccdf:description>
          <xccdf:reference>
            <dc:title>DPMS Target MS SQL Server 2016 Database</dc:title>
            <dc:publisher>DISA</dc:publisher>
            <dc:type>DPMS Target</dc:type>
            <dc:subject>MS SQL Server 2016 Database</dc:subject>
            <dc:identifier>3992</dc:identifier>
          </xccdf:reference>
          <xccdf:ident system="http://cyber.mil/legacy">SV-93787</xccdf:ident>
          <xccdf:ident system="http://cyber.mil/legacy">V-79081</xccdf:ident>
          <xccdf:ident system="http://cyber.mil/cci">CCI-001499</xccdf:ident>
          <xccdf:fixtext fixref="F-15125r313160_fix">Document and obtain approval for any non-administrative users who require the ability to modify database structure and logic modules.

REVOKE ALTER ON [&lt;Object Name&gt;] TO [&lt;Principal Name&gt;]</xccdf:fixtext>
          <xccdf:fix id="F-15125r313160_fix"/>
          <xccdf:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5" selector="">
            <xccdf:check-content-ref href="U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-oval2.xml" name="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:def:213909"/>
            <xccdf:check-content-ref href="U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-ocil.xml" name="ocil:navy.navwar.niwcatlantic.scc.ms.sql.server.db.hybrid:questionnaire:213909"/>
            <xccdf:check-content>oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:21390904;;Database;;user_name;;Array</xccdf:check-content>
          </xccdf:check>
          <xccdf:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5" selector="hybrid">
            <xccdf:check-content-ref href="U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-oval2.xml" name="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:def:213909"/>
            <xccdf:check-content-ref href="U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-ocil.xml" name="ocil:navy.navwar.niwcatlantic.scc.ms.sql.server.db.hybrid:questionnaire:213909"/>
            <xccdf:check-content>oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:21390904;;Database;;user_name;;Array</xccdf:check-content>
          </xccdf:check>
          <xccdf:check system="http://scap.nist.gov/schema/ocil/2" selector="manual">
            <xccdf:check-content-ref href="U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-ocil.xml" name="ocil:navy.navwar.niwcatlantic.scc.sql.server:questionnaire:1901"/>
            <xccdf:check-content>Obtain a listing of users and roles who are authorized to modify database structure and logic modules from the server documentation.

Execute the following query:
SELECT P.type_desc AS principal_type, P.name AS principal_name, O.type_desc,
   CASE class
    WHEN 0 THEN DB_NAME()
    WHEN 1 THEN OBJECT_SCHEMA_NAME(major_id) + '.' + OBJECT_NAME(major_id)
    WHEN 3 THEN SCHEMA_NAME(major_id)
      ELSE class_desc + '(' + CAST(major_id AS nvarchar) + ')'
   END AS securable_name, DP.state_desc, DP.permission_name
FROM sys.database_permissions DP
JOIN sys.database_principals P ON DP.grantee_principal_id = P.principal_id
LEFT OUTER JOIN sys.all_objects O ON O.object_id = DP.major_id AND O.type IN ('TR','TA','P','X','RF','PC','IF','FN','TF','U')
WHERE DP.type IN ('AL','ALTG') AND DP.class IN (0, 1, 53)

SELECT R.name AS role_name, M.type_desc AS principal_type, M.name AS principal_name
FROM sys.database_principals R
JOIN sys.database_role_members DRM ON R.principal_id = DRM.role_principal_id
JOIN sys.database_principals M ON DRM.member_principal_id = M.principal_id
WHERE R.name IN ('db_ddladmin','db_owner')
AND M.name != 'dbo'

If any users or role permissions returned are not authorized to modify the specified object or type, this is a finding.

If any user or role membership is not authorized, this is a finding.</xccdf:check-content>
          </xccdf:check>
        </xccdf:Rule>
      </xccdf:Group>
      <xccdf:Group id="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213910">
        <xccdf:title>SRG-APP-000226-DB-000147</xccdf:title>
        <xccdf:description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</xccdf:description>
        <xccdf:Rule id="xccdf_navy.navwar.niwcatlantic.scc.ms_rule_SV-213910r961125_rule" weight="10.0" severity="medium">
          <xccdf:version>SQL6-D0-001500</xccdf:version>
          <xccdf:title>In the event of a system failure, hardware loss or disk failure, SQL Server must be able to restore necessary databases with least disruption to mission processes.</xccdf:title>
          <xccdf:description>&lt;VulnDiscussion&gt;Failure to a known state can address safety or security in accordance with the mission/business needs of the organization. Failure to a known secure state helps prevent a loss of confidentiality, integrity, or availability in the event of a failure of the information system or a component of the system. In the event of a system failure, SQL Server must be able to bring the database back to a consistent state.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</xccdf:description>
          <xccdf:reference>
            <dc:title>DPMS Target MS SQL Server 2016 Database</dc:title>
            <dc:publisher>DISA</dc:publisher>
            <dc:type>DPMS Target</dc:type>
            <dc:subject>MS SQL Server 2016 Database</dc:subject>
            <dc:identifier>3992</dc:identifier>
          </xccdf:reference>
          <xccdf:ident system="http://cyber.mil/legacy">SV-93789</xccdf:ident>
          <xccdf:ident system="http://cyber.mil/legacy">V-79083</xccdf:ident>
          <xccdf:ident system="http://cyber.mil/cci">CCI-001665</xccdf:ident>
          <xccdf:fixtext fixref="F-15126r313163_fix">Modify the system security plan, to include whether the database is static, the correct recovery model to be used, the backup schedule, and the plan for testing database restoration. 

In SQL Server Management Studio, Object Explorer, right-click on the name of the database; select Properties. Select the Options page. Set the Recovery Model field, near the top of the page, to the correct value. 

In Object Explorer, expand &gt;&gt; SQL Server Agent &gt;&gt; Jobs. Create, modify, and delete jobs to implement the backup schedule. (Alternatively, this may done using T-SQL code or Third-party Backup software.) 

Correct any issues that have been causing backups to fail. 

Test the restoration of the database at least once a year; correct any issues that cause it to fail. Maintain a record of these tests.</xccdf:fixtext>
          <xccdf:fix id="F-15126r313163_fix"/>
          <xccdf:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5" selector="">
            <xccdf:check-content-ref href="U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-oval2.xml" name="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:def:213910"/>
            <xccdf:check-content-ref href="U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-ocil.xml" name="ocil:navy.navwar.niwcatlantic.scc.ms.sql.server.16.db.hybrid:questionnaire:213910"/>
            <xccdf:check-content>oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:21391004;;Database;;recovery_model_desc;;Single</xccdf:check-content>
          </xccdf:check>
          <xccdf:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5" selector="hybrid">
            <xccdf:check-content-ref href="U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-oval2.xml" name="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:def:213910"/>
            <xccdf:check-content-ref href="U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-ocil.xml" name="ocil:navy.navwar.niwcatlantic.scc.ms.sql.server.16.db.hybrid:questionnaire:213910"/>
            <xccdf:check-content>oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:21391004;;Database;;recovery_model_desc;;Single</xccdf:check-content>
          </xccdf:check>
          <xccdf:check system="http://scap.nist.gov/schema/ocil/2" selector="manual">
            <xccdf:check-content-ref href="U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-ocil.xml" name="ocil:navy.navwar.niwcatlantic.scc.sql.server:questionnaire:2101"/>
            <xccdf:check-content>Review the system security plan (SSP) to determine whether the database is static, the recovery model to be used, the backup schedule, and the plan for testing database restoration.

If the SSP does not state that the database is static, assume that it is not static. If any of the other information is absent, this is a finding. 

If the database is not static, and the documented recovery model is Bulk Logged, but the justification and authorization for this are not documented, this is a finding. 

Run the following to determine Recovery Model:

USE [master]
GO

SELECT name, recovery_model_desc
FROM sys.databases
ORDER BY name

If the recovery model description does not match the documented recovery model, this is a finding. 

Review the jobs set up to implement the backup plan. If they are absent, this is a finding. 

Check the history of the backups by running the following query.  It checks the last 30 days of backups by database.
USE [msdb]
GO

SELECT database_name, 
   CASE type
    WHEN 'D' THEN 'Full'
    WHEN 'I' THEN 'Differential'
    WHEN 'L' THEN 'Log'
   ELSE type
   END AS backup_type,
 is_copy_only,
 backup_start_date, backup_finish_date
FROM dbo.backupset
WHERE backup_start_date &gt;= dateadd(day, - 30, getdate()) 
ORDER BY database_name, backup_start_date DESC

If the history indicates a pattern of job failures by missing or gaps in backups, this is a finding. 

Review evidence that database recovery is tested annually or more often, and that the most recent test was successful. If not, this is a finding.</xccdf:check-content>
          </xccdf:check>
        </xccdf:Rule>
      </xccdf:Group>
      <xccdf:Group id="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213911">
        <xccdf:title>SRG-APP-000231-DB-000154</xccdf:title>
        <xccdf:description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</xccdf:description>
        <xccdf:Rule id="xccdf_navy.navwar.niwcatlantic.scc.ms_rule_SV-213911r961128_rule" weight="10.0" severity="medium">
          <xccdf:version>SQL6-D0-001600</xccdf:version>
          <xccdf:title>The Database Master Key encryption password must meet DOD password complexity requirements. </xccdf:title>
          <xccdf:description>&lt;VulnDiscussion&gt;Weak passwords may be easily guessed. When passwords are used to encrypt keys used for encryption of sensitive data, then the confidentiality of all data encrypted using that key is at risk.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</xccdf:description>
          <xccdf:reference>
            <dc:title>DPMS Target MS SQL Server 2016 Database</dc:title>
            <dc:publisher>DISA</dc:publisher>
            <dc:type>DPMS Target</dc:type>
            <dc:subject>MS SQL Server 2016 Database</dc:subject>
            <dc:identifier>3992</dc:identifier>
          </xccdf:reference>
          <xccdf:ident system="http://cyber.mil/legacy">SV-93791</xccdf:ident>
          <xccdf:ident system="http://cyber.mil/legacy">V-79085</xccdf:ident>
          <xccdf:ident system="http://cyber.mil/cci">CCI-001199</xccdf:ident>
          <xccdf:fixtext fixref="F-15127r313166_fix">Assign an encryption password to the Database Master Key that is a minimum of 15 characters with at least 1 upper-case character, 1 lower-case character, 1 special character, and 1 numeric character, and at least 8 characters changed from the previous password. 

To change the Database Master Key encryption password: 

USE [database name]; 
ALTER MASTER KEY REGENERATE WITH ENCRYPTION BY PASSWORD = '[new password]'; 

Note: The Database Master Key encryption method should not be changed until the effects are thoroughly reviewed. Changing the master key encryption causes all encryption using the Database Master Key to be decrypted and re-encrypted. This action should not be taken during a high-demand time. Please see the MS SQL Server documentation prior to re-encrypting the Database Master Key for detailed information.</xccdf:fixtext>
          <xccdf:fix id="F-15127r313166_fix"/>
          <xccdf:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5" selector="">
            <xccdf:check-content-ref href="U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-oval2.xml" name="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:def:213911"/>
          </xccdf:check>
          <xccdf:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5" selector="automated">
            <xccdf:check-content-ref href="U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-oval2.xml" name="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:def:213911"/>
          </xccdf:check>
          <xccdf:check system="http://scap.nist.gov/schema/ocil/2" selector="manual">
            <xccdf:check-content-ref href="U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-ocil.xml" name="ocil:navy.navwar.niwcatlantic.scc.sql.server:questionnaire:2301"/>
            <xccdf:check-content>From the query prompt: 

SELECT name 
FROM [master].sys.databases 
WHERE state = 0 

Repeat for each database: 
From the query prompt: 
USE [database name] 
SELECT COUNT(name) 
FROM sys.symmetric_keys s, sys.key_encryptions k 
WHERE s.name = '##MS_DatabaseMasterKey##' 
AND s.symmetric_key_id = k.key_id 
AND k.crypt_type in ('ESKP', 'ESP2', 'ESP3')

If the value returned is zero, this is not applicable.

If the value returned is greater than zero, a Database Master Key exists and is encrypted with a password. 

Review procedures and evidence of password requirements used to encrypt Database Master Keys. 

If the passwords are not required to meet DoD password standards, currently a minimum of 15 characters with at least 1 upper-case character, 1 lower-case character, 1 special character, and 1 numeric character, and at least 8 characters changed from the previous password, this is a finding.</xccdf:check-content>
          </xccdf:check>
        </xccdf:Rule>
      </xccdf:Group>
      <xccdf:Group id="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213912">
        <xccdf:title>SRG-APP-000231-DB-000154</xccdf:title>
        <xccdf:description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</xccdf:description>
        <xccdf:Rule id="xccdf_navy.navwar.niwcatlantic.scc.ms_rule_SV-213912r961128_rule" weight="10.0" severity="medium">
          <xccdf:version>SQL6-D0-001700</xccdf:version>
          <xccdf:title>The Database Master Key must be encrypted by the Service Master Key, where a Database Master Key is required and another encryption method has not been specified. </xccdf:title>
          <xccdf:description>&lt;VulnDiscussion&gt;When not encrypted by the Service Master Key, system administrators or application administrators may access and use the Database Master Key to view sensitive data that they are not authorized to view. Where alternate encryption means are not feasible, encryption by the Service Master Key may be necessary. To help protect sensitive data from unauthorized access by DBAs, mitigations may be in order. Mitigations may include automatic alerts or other audit events when the Database Master Key is accessed outside of the application or by a DBA account.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</xccdf:description>
          <xccdf:reference>
            <dc:title>DPMS Target MS SQL Server 2016 Database</dc:title>
            <dc:publisher>DISA</dc:publisher>
            <dc:type>DPMS Target</dc:type>
            <dc:subject>MS SQL Server 2016 Database</dc:subject>
            <dc:identifier>3992</dc:identifier>
          </xccdf:reference>
          <xccdf:ident system="http://cyber.mil/legacy">SV-93793</xccdf:ident>
          <xccdf:ident system="http://cyber.mil/legacy">V-79087</xccdf:ident>
          <xccdf:ident system="http://cyber.mil/cci">CCI-001199</xccdf:ident>
          <xccdf:fixtext fixref="F-15128r313169_fix">Where possible, encrypt the Database Master Key with a password known only to the application administrator.

Where not possible, configure additional audit events or alerts to detect unauthorized access to the Database Master Key by users not authorized to view sensitive data.</xccdf:fixtext>
          <xccdf:fix id="F-15128r313169_fix"/>
          <xccdf:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5" selector="">
            <xccdf:check-content-ref href="U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-oval2.xml" name="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:def:213912"/>
            <xccdf:check-content-ref href="U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-ocil.xml" name="ocil:navy.navwar.niwcatlantic.scc.ms.sql.server.db.hybrid:questionnaire:213912"/>
            <xccdf:check-content>oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:21391204;;Database;;database_name;;Array</xccdf:check-content>
          </xccdf:check>
          <xccdf:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5" selector="hybrid">
            <xccdf:check-content-ref href="U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-oval2.xml" name="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:def:213912"/>
            <xccdf:check-content-ref href="U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-ocil.xml" name="ocil:navy.navwar.niwcatlantic.scc.ms.sql.server.db.hybrid:questionnaire:213912"/>
            <xccdf:check-content>oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:21391204;;Database;;database_name;;Array</xccdf:check-content>
          </xccdf:check>
          <xccdf:check system="http://scap.nist.gov/schema/ocil/2" selector="manual">
            <xccdf:check-content-ref href="U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-ocil.xml" name="ocil:navy.navwar.niwcatlantic.scc.sql.server:questionnaire:2501"/>
            <xccdf:check-content>If no databases require encryption, this is not a finding. 

From the query prompt: 

SELECT name 
FROM [master].sys.databases 
WHERE is_master_key_encrypted_by_server = 1 
AND owner_sid &lt;&gt; 1 
AND state = 0; 
(Note that this query assumes that the [sa] account is not used as the owner of application databases, in keeping with other STIG guidance. If this is not the case, modify the query accordingly.) 

If no databases are returned by the query, this is not a finding. 

For any databases returned, verify in the System Security Plan that encryption of the Database Master Key using the Service Master Key is acceptable and approved by the Information Owner, and the encrypted data does not require additional protections to deter or detect DBA access. If not approved, this is a finding. 

If approved and additional protections are required, then verify the additional requirements are in place in accordance with the System Security Plan. These may include additional auditing on access of the Database Master Key with alerts or other automated monitoring. 

If the additional requirements are not in place, this is a finding.</xccdf:check-content>
          </xccdf:check>
        </xccdf:Rule>
      </xccdf:Group>
      <xccdf:Group id="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213913">
        <xccdf:title>SRG-APP-000231-DB-000154</xccdf:title>
        <xccdf:description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</xccdf:description>
        <xccdf:Rule id="xccdf_navy.navwar.niwcatlantic.scc.ms_rule_SV-213913r961128_rule" weight="10.0" severity="medium">
          <xccdf:version>SQL6-D0-001800</xccdf:version>
          <xccdf:title>The Certificate used for encryption must be backed up and stored in a secure location that is not on the SQL Server.</xccdf:title>
          <xccdf:description>&lt;VulnDiscussion&gt;Backup and recovery of the Certificate used for encryption is critical to the complete recovery of the database. Not having this key can lead to loss of data during recovery.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</xccdf:description>
          <xccdf:reference>
            <dc:title>DPMS Target MS SQL Server 2016 Database</dc:title>
            <dc:publisher>DISA</dc:publisher>
            <dc:type>DPMS Target</dc:type>
            <dc:subject>MS SQL Server 2016 Database</dc:subject>
            <dc:identifier>3992</dc:identifier>
          </xccdf:reference>
          <xccdf:ident system="http://cyber.mil/legacy">SV-93795</xccdf:ident>
          <xccdf:ident system="http://cyber.mil/legacy">V-79089</xccdf:ident>
          <xccdf:ident system="http://cyber.mil/cci">CCI-001199</xccdf:ident>
          <xccdf:fixtext fixref="F-15129r951656_fix">Document and implement procedures to safely back up and store the Certificate used for encryption in a secure location that is not on the SQL Server. Include in the procedures to establish evidence of backup and storage as well as careful, restricted access and restoration of the Certificate.

BACKUP CERTIFICATE 'CertificateName' TO FILE = 'path_to_file' 
WITH PRIVATE KEY (FILE = 'path_to_pvk', ENCRYPTION BY PASSWORD = 'password'); 

As this requires a password, ensure it is not exposed to unauthorized persons or stored as plain text.</xccdf:fixtext>
          <xccdf:fix id="F-15129r951656_fix"/>
          <xccdf:check system="http://scap.nist.gov/schema/ocil/2" selector="">
            <xccdf:check-content-ref href="U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-ocil.xml" name="ocil:navy.navwar.niwcatlantic.scc.sql.server:questionnaire:2701"/>
          </xccdf:check>
          <xccdf:check system="http://scap.nist.gov/schema/ocil/2" selector="manual">
            <xccdf:check-content-ref href="U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-ocil.xml" name="ocil:navy.navwar.niwcatlantic.scc.sql.server:questionnaire:2701"/>
            <xccdf:check-content>If the application owner and authorizing official have determined that encryption of data at rest is not required, this is not a finding.

Review procedures for and evidence of backup of the Certificate used for encryption in the System Security Plan. 

If the procedures or evidence does not exist, this is a finding. 

If the procedures do not indicate that a backup of the Certificate used for encryption is stored in a secure location that is not on the SQL Server, this is a finding. 

If procedures do not indicate access restrictions to the Certificate backup, this is a finding.</xccdf:check-content>
          </xccdf:check>
        </xccdf:Rule>
      </xccdf:Group>
      <xccdf:Group id="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213914">
        <xccdf:title>SRG-APP-000233-DB-000124</xccdf:title>
        <xccdf:description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</xccdf:description>
        <xccdf:Rule id="xccdf_navy.navwar.niwcatlantic.scc.ms_rule_SV-213914r961131_rule" weight="10.0" severity="low">
          <xccdf:version>SQL6-D0-001900</xccdf:version>
          <xccdf:title>SQL Server must isolate security functions from non-security functions.</xccdf:title>
          <xccdf:description>&lt;VulnDiscussion&gt;An isolation boundary provides access control and protects the integrity of the hardware, software, and firmware that perform security functions. 

Security functions are the hardware, software, and/or firmware of the information system responsible for enforcing the system security policy and supporting the isolation of code and data on which the protection is based.

Developers and implementers can increase the assurance in security functions by employing well-defined security policy models; structured, disciplined, and rigorous hardware and software development techniques; and sound system/security engineering principles. 

Database Management Systems typically separate security functionality from non-security functionality via separate databases or schemas. Database objects or code implementing security functionality should not be commingled with objects or code implementing application logic. When security and non-security functionality are commingled, users who have access to non-security functionality may be able to access security functionality.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</xccdf:description>
          <xccdf:reference>
            <dc:title>DPMS Target MS SQL Server 2016 Database</dc:title>
            <dc:publisher>DISA</dc:publisher>
            <dc:type>DPMS Target</dc:type>
            <dc:subject>MS SQL Server 2016 Database</dc:subject>
            <dc:identifier>3992</dc:identifier>
          </xccdf:reference>
          <xccdf:ident system="http://cyber.mil/legacy">SV-93797</xccdf:ident>
          <xccdf:ident system="http://cyber.mil/legacy">V-79091</xccdf:ident>
          <xccdf:ident system="http://cyber.mil/cci">CCI-001084</xccdf:ident>
          <xccdf:fixtext fixref="F-15130r822448_fix">Check the server documentation, locate security-related database objects and code in a separate database, schema, table, or other separate security domain from database objects and code implementing application logic.  

Microsoft SQL Server 2005 introduced the concept of database object schemas. Schemas are analogous to separate namespaces or containers used to store database objects. Security permissions apply to schemas, making them an important tool for separating and protecting database objects based on access rights. Schemas reduce the work required, and improve the flexibility, for security-related administration of a database.

User-schema separation allows for more flexibility in managing database object permissions. A schema is a named container for database objects, which allows the user to group objects into separate namespaces.

Where possible, locate security-related database objects and code in a separate database, schema, or other separate security domain from database objects and code implementing application logic. In all cases, use GRANT, REVOKE, DENY, ALTER ROLE &#8230; ADD MEMBER &#8230; and/or ALTER ROLE &#8230;. DROP MEMBER statements to add and remove permissions on server-level and database-level security-related objects to provide effective isolation.</xccdf:fixtext>
          <xccdf:fix id="F-15130r822448_fix"/>
          <xccdf:check system="http://scap.nist.gov/schema/ocil/2" selector="">
            <xccdf:check-content-ref href="U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-ocil.xml" name="ocil:navy.navwar.niwcatlantic.scc.sql.server:questionnaire:2901"/>
          </xccdf:check>
          <xccdf:check system="http://scap.nist.gov/schema/ocil/2" selector="manual">
            <xccdf:check-content-ref href="U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-ocil.xml" name="ocil:navy.navwar.niwcatlantic.scc.sql.server:questionnaire:2901"/>
            <xccdf:check-content>Determine elements of security functionality (lists of permissions, additional authentication information, stored procedures, application specific auditing, etc.) that are being housed inside SQL server.

For any elements found, check SQL Server to determine if these objects or code implementing security functionality are located in a separate security domain, such as a separate database, schema, or table created specifically for security functionality.

If the database is a SQL Server default database (master, msdb, model, tempdb), this is NA.

Run the following query to list all the user-defined databases:

SELECT Name 
FROM sys.databases 
WHERE database_id &gt; 4 
ORDER BY 1;

Review the database structure to determine where security related functionality is stored. If security-related database objects or code are not kept separate, this is a finding.</xccdf:check-content>
          </xccdf:check>
        </xccdf:Rule>
      </xccdf:Group>
      <xccdf:Group id="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213915">
        <xccdf:title>SRG-APP-000243-DB-000128</xccdf:title>
        <xccdf:description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</xccdf:description>
        <xccdf:Rule id="xccdf_navy.navwar.niwcatlantic.scc.ms_rule_SV-213915r961149_rule" weight="10.0" severity="medium">
          <xccdf:version>SQL6-D0-002000</xccdf:version>
          <xccdf:title>Database contents must be protected from unauthorized and unintended information transfer by enforcement of a data-transfer policy.</xccdf:title>
          <xccdf:description>&lt;VulnDiscussion&gt;Applications, including DBMSs, must prevent unauthorized and unintended information transfer via shared system resources. 

Data used for the development and testing of applications often involves copying data from production. It is important that specific procedures exist for this process, to include the conditions under which such transfer may take place, where the copies may reside, and the rules for ensuring sensitive data are not exposed.

Copies of sensitive data must not be misplaced or left in a temporary location without the proper controls.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</xccdf:description>
          <xccdf:reference>
            <dc:title>DPMS Target MS SQL Server 2016 Database</dc:title>
            <dc:publisher>DISA</dc:publisher>
            <dc:type>DPMS Target</dc:type>
            <dc:subject>MS SQL Server 2016 Database</dc:subject>
            <dc:identifier>3992</dc:identifier>
          </xccdf:reference>
          <xccdf:ident system="http://cyber.mil/legacy">SV-93799</xccdf:ident>
          <xccdf:ident system="http://cyber.mil/legacy">V-79093</xccdf:ident>
          <xccdf:ident system="http://cyber.mil/cci">CCI-001090</xccdf:ident>
          <xccdf:fixtext fixref="F-15131r313178_fix">Modify any code used for moving data from production to development/test systems to comply with the organization-defined data transfer policy, and to ensure copies of production data are not left in unsecured locations.</xccdf:fixtext>
          <xccdf:fix id="F-15131r313178_fix"/>
          <xccdf:check system="http://scap.nist.gov/schema/ocil/2" selector="">
            <xccdf:check-content-ref href="U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-ocil.xml" name="ocil:navy.navwar.niwcatlantic.scc.sql.server:questionnaire:3101"/>
          </xccdf:check>
          <xccdf:check system="http://scap.nist.gov/schema/ocil/2" selector="manual">
            <xccdf:check-content-ref href="U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-ocil.xml" name="ocil:navy.navwar.niwcatlantic.scc.sql.server:questionnaire:3101"/>
            <xccdf:check-content>Review the procedures for the refreshing of development/test data from production. Review any scripts or code that exists for the movement of production data to development/test systems, or to any other location or for any other purpose. Verify that copies of production data are not left in unprotected locations. If the code that exists for data movement does not comply with the organization-defined data transfer policy and/or fails to remove any copies of production data from unprotected locations, this is a finding.</xccdf:check-content>
          </xccdf:check>
        </xccdf:Rule>
      </xccdf:Group>
      <xccdf:Group id="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213916">
        <xccdf:title>SRG-APP-000251-DB-000160</xccdf:title>
        <xccdf:description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</xccdf:description>
        <xccdf:Rule id="xccdf_navy.navwar.niwcatlantic.scc.ms_rule_SV-213916r961158_rule" weight="10.0" severity="medium">
          <xccdf:version>SQL6-D0-002100</xccdf:version>
          <xccdf:title>SQL Server must check the validity of all data inputs except those specifically identified by the organization.</xccdf:title>
          <xccdf:description>&lt;VulnDiscussion&gt;Invalid user input occurs when a user inserts data or characters into an application's data entry fields and the application is unprepared to process that data. This results in unanticipated application behavior, potentially leading to an application or information system compromise. Invalid user input is one of the primary methods employed when attempting to compromise an application.

With respect to database management systems, one class of threat is known as SQL Injection, or more generally, code injection. It takes advantage of the dynamic execution capabilities of various programming languages, including dialects of SQL. Potentially, the attacker can gain unauthorized access to data, including security settings, and severely corrupt or destroy the database.

Even when no such hijacking takes place, invalid input that gets recorded in the database, whether accidental or malicious, reduces the reliability and usability of the system. Available protections include data types, referential constraints, uniqueness constraints, range checking, and application-specific logic. Application-specific logic can be implemented within the database in stored procedures and triggers, where appropriate.

This calls for inspection of application source code, which will require collaboration with the application developers. It is recognized that in many cases, the database administrator (DBA) is organizationally separate from the application developers, and may have limited, if any, access to source code. Nevertheless, protections of this type are so important to the secure operation of databases that they must not be ignored. At a minimum, the DBA must attempt to obtain assurances from the development organization that this issue has been addressed, and must document what has been discovered.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</xccdf:description>
          <xccdf:reference>
            <dc:title>DPMS Target MS SQL Server 2016 Database</dc:title>
            <dc:publisher>DISA</dc:publisher>
            <dc:type>DPMS Target</dc:type>
            <dc:subject>MS SQL Server 2016 Database</dc:subject>
            <dc:identifier>3992</dc:identifier>
          </xccdf:reference>
          <xccdf:ident system="http://cyber.mil/legacy">SV-93801</xccdf:ident>
          <xccdf:ident system="http://cyber.mil/legacy">V-79095</xccdf:ident>
          <xccdf:ident system="http://cyber.mil/cci">CCI-001310</xccdf:ident>
          <xccdf:fixtext fixref="F-15132r313181_fix">Use parameterized queries, constraints, foreign keys, etc. to validate data input. 

Modify SQL Server to properly use the correct column data types as required in the database.</xccdf:fixtext>
          <xccdf:fix id="F-15132r313181_fix"/>
          <xccdf:check system="http://scap.nist.gov/schema/ocil/2" selector="">
            <xccdf:check-content-ref href="U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-ocil.xml" name="ocil:navy.navwar.niwcatlantic.scc.sql.server:questionnaire:3301"/>
          </xccdf:check>
          <xccdf:check system="http://scap.nist.gov/schema/ocil/2" selector="manual">
            <xccdf:check-content-ref href="U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-ocil.xml" name="ocil:navy.navwar.niwcatlantic.scc.sql.server:questionnaire:3301"/>
            <xccdf:check-content>Review DBMS code (stored procedures, functions, triggers), application code, settings, column and field definitions, and constraints to determine whether the database is protected against invalid input. 

If code exists that allows invalid data to be acted upon or input into the database, this is a finding. 

If column/field definitions are not reflective of the data, this is a finding. 

If columns/fields do not contain constraints and validity checking where required, this is a finding. 

Where a column/field is noted in the system documentation as necessarily free-form, even though its name and context suggest that it should be strongly typed and constrained, the absence of these protections is not a finding. 

Where a column/field is clearly identified by name, caption or context as Notes, Comments, Description, Text, etc., the absence of these protections is not a finding.</xccdf:check-content>
          </xccdf:check>
        </xccdf:Rule>
      </xccdf:Group>
      <xccdf:Group id="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213917">
        <xccdf:title>SRG-APP-000266-DB-000162</xccdf:title>
        <xccdf:description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</xccdf:description>
        <xccdf:Rule id="xccdf_navy.navwar.niwcatlantic.scc.ms_rule_SV-213917r961167_rule" weight="10.0" severity="medium">
          <xccdf:version>SQL6-D0-002400</xccdf:version>
          <xccdf:title>SQL Server must provide non-privileged users with error messages that provide information necessary for corrective actions without revealing information that could be exploited by adversaries.</xccdf:title>
          <xccdf:description>&lt;VulnDiscussion&gt;Any DBMS or associated application providing too much information in error messages on the screen or printout risks compromising the data and security of the system. The structure and content of error messages need to be carefully considered by the organization and development team.

Databases can inadvertently provide a wealth of information to an attacker through improperly handled error messages. In addition to sensitive business or personal information, database errors can provide host names, IP addresses, user names, and other system information not required for troubleshooting but very useful to someone targeting the system.

Carefully consider the structure/content of error messages. The extent to which information systems are able to identify and handle error conditions is guided by organizational policy and operational requirements. Information that could be exploited by adversaries includes, for example, logon attempts with passwords entered by mistake as the username, mission/business information that can be derived from (if not stated explicitly by) information recorded, and personal information, such as account numbers, social security numbers, and credit card numbers.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</xccdf:description>
          <xccdf:reference>
            <dc:title>DPMS Target MS SQL Server 2016 Database</dc:title>
            <dc:publisher>DISA</dc:publisher>
            <dc:type>DPMS Target</dc:type>
            <dc:subject>MS SQL Server 2016 Database</dc:subject>
            <dc:identifier>3992</dc:identifier>
          </xccdf:reference>
          <xccdf:ident system="http://cyber.mil/legacy">SV-93803</xccdf:ident>
          <xccdf:ident system="http://cyber.mil/legacy">V-79097</xccdf:ident>
          <xccdf:ident system="http://cyber.mil/cci">CCI-001312</xccdf:ident>
          <xccdf:fixtext fixref="F-15133r313184_fix">Adjust database code to remove any information not required for explaining the error to an end user.

Consider enabling trace flag 3625 to mask certain system-level error information returned to non-administrative users.

Launch SQL Server Configuration Manager &gt;&gt; Click SQL Services &gt;&gt; Open the instance properties &gt;&gt; Click the Service Parameters tab &gt;&gt; Enter "-T3625" &gt;&gt; Click Add &gt;&gt; Click OK &gt;&gt; Restart SQL instance.</xccdf:fixtext>
          <xccdf:fix id="F-15133r313184_fix"/>
          <xccdf:check system="http://scap.nist.gov/schema/ocil/2" selector="">
            <xccdf:check-content-ref href="U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-ocil.xml" name="ocil:navy.navwar.niwcatlantic.scc.sql.server:questionnaire:3501"/>
          </xccdf:check>
          <xccdf:check system="http://scap.nist.gov/schema/ocil/2" selector="manual">
            <xccdf:check-content-ref href="U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-ocil.xml" name="ocil:navy.navwar.niwcatlantic.scc.sql.server:questionnaire:3501"/>
            <xccdf:check-content>Review application behavior and custom database code (stored procedures, triggers), to determine whether error messages contain information beyond what is needed for explaining the issue to general users.

If database error messages contain PII data, sensitive business data, or information useful for identifying the host system or database structure, this is a finding.</xccdf:check-content>
          </xccdf:check>
        </xccdf:Rule>
      </xccdf:Group>
      <xccdf:Group id="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213918">
        <xccdf:title>SRG-APP-000311-DB-000308</xccdf:title>
        <xccdf:description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</xccdf:description>
        <xccdf:Rule id="xccdf_navy.navwar.niwcatlantic.scc.ms_rule_SV-213918r961269_rule" weight="10.0" severity="medium">
          <xccdf:version>SQL6-D0-002500</xccdf:version>
          <xccdf:title>SQL Server must associate organization-defined types of security labels having organization-defined security label values with information in storage.</xccdf:title>
          <xccdf:description>&lt;VulnDiscussion&gt;Without the association of security labels to information, there is no basis for&#160;SQL Server&#160;to make security-related access-control decisions.

Security labels are abstractions representing the basic properties or characteristics of an entity (e.g., subjects and objects) with respect to safeguarding information.

These labels are typically associated with internal data structures (e.g., tables, rows) within the database and are used to enable the implementation of access control and flow control policies; reflect special dissemination, handling, or distribution instructions; or support other aspects of the information security policy.

One example includes marking data as classified or FOUO. These security labels may be assigned manually or during data processing, but, either way, it is imperative these assignments are maintained while the data is in storage. If the security labels are lost when the data is stored, there is the risk of a data compromise.

The mechanism used to support security labeling may be a feature of SQL Server, a third-party product, or custom application code.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</xccdf:description>
          <xccdf:reference>
            <dc:title>DPMS Target MS SQL Server 2016 Database</dc:title>
            <dc:publisher>DISA</dc:publisher>
            <dc:type>DPMS Target</dc:type>
            <dc:subject>MS SQL Server 2016 Database</dc:subject>
            <dc:identifier>3992</dc:identifier>
          </xccdf:reference>
          <xccdf:ident system="http://cyber.mil/legacy">SV-93805</xccdf:ident>
          <xccdf:ident system="http://cyber.mil/legacy">V-79099</xccdf:ident>
          <xccdf:ident system="http://cyber.mil/cci">CCI-002262</xccdf:ident>
          <xccdf:fixtext fixref="F-15134r313187_fix">Deploy SQL Server Row-Level Security (see link below) or a third-party software, or add custom data structures, data elements and application code, to provide reliable security labeling of information in storage.

https://msdn.microsoft.com/en-us/library/dn765131.aspx</xccdf:fixtext>
          <xccdf:fix id="F-15134r313187_fix"/>
          <xccdf:check system="http://scap.nist.gov/schema/ocil/2" selector="">
            <xccdf:check-content-ref href="U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-ocil.xml" name="ocil:navy.navwar.niwcatlantic.scc.sql.server:questionnaire:3701"/>
          </xccdf:check>
          <xccdf:check system="http://scap.nist.gov/schema/ocil/2" selector="manual">
            <xccdf:check-content-ref href="U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-ocil.xml" name="ocil:navy.navwar.niwcatlantic.scc.sql.server:questionnaire:3701"/>
            <xccdf:check-content>If security labeling is not required, this is not a finding.

If security labeling requirements have been specified, but neither a third-party solution nor a SQL Server Row-Level security solution is implemented that reliably maintains labels on information in storage, this is a finding.</xccdf:check-content>
          </xccdf:check>
        </xccdf:Rule>
      </xccdf:Group>
      <xccdf:Group id="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213919">
        <xccdf:title>SRG-APP-000313-DB-000309</xccdf:title>
        <xccdf:description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</xccdf:description>
        <xccdf:Rule id="xccdf_navy.navwar.niwcatlantic.scc.ms_rule_SV-213919r961272_rule" weight="10.0" severity="medium">
          <xccdf:version>SQL6-D0-002600</xccdf:version>
          <xccdf:title>SQL Server must associate organization-defined types of security labels having organization-defined security label values with information in process.</xccdf:title>
          <xccdf:description>&lt;VulnDiscussion&gt;Without the association of security labels to information, there is no basis for SQL Server to make security-related access-control decisions.

Security labels are abstractions representing the basic properties or characteristics of an entity (e.g., subjects and objects) with respect to safeguarding information.

These labels are typically associated with internal data structures (e.g., tables, rows) within the database and are used to enable the implementation of access control and flow control policies; reflect special dissemination, handling, or distribution instructions; or support other aspects of the information security policy.

One example includes marking data as classified or FOUO. These security labels may be assigned manually or during data processing, but, either way, it is imperative these assignments are maintained while the data is in storage. If the security labels are lost when the data is stored, there is the risk of a data compromise.

The mechanism used to support security labeling may be a feature of SQL Server, a third-party product, or custom application code.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</xccdf:description>
          <xccdf:reference>
            <dc:title>DPMS Target MS SQL Server 2016 Database</dc:title>
            <dc:publisher>DISA</dc:publisher>
            <dc:type>DPMS Target</dc:type>
            <dc:subject>MS SQL Server 2016 Database</dc:subject>
            <dc:identifier>3992</dc:identifier>
          </xccdf:reference>
          <xccdf:ident system="http://cyber.mil/legacy">SV-93807</xccdf:ident>
          <xccdf:ident system="http://cyber.mil/legacy">V-79101</xccdf:ident>
          <xccdf:ident system="http://cyber.mil/cci">CCI-002263</xccdf:ident>
          <xccdf:fixtext fixref="F-15135r313190_fix">Deploy SQL Server Row-Level Security (see link below) or a third-party software, or add custom data structures, data elements and application code, to provide reliable security labeling of information in process.

https://msdn.microsoft.com/en-us/library/dn765131.aspx</xccdf:fixtext>
          <xccdf:fix id="F-15135r313190_fix"/>
          <xccdf:check system="http://scap.nist.gov/schema/ocil/2" selector="">
            <xccdf:check-content-ref href="U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-ocil.xml" name="ocil:navy.navwar.niwcatlantic.scc.sql.server:questionnaire:3901"/>
          </xccdf:check>
          <xccdf:check system="http://scap.nist.gov/schema/ocil/2" selector="manual">
            <xccdf:check-content-ref href="U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-ocil.xml" name="ocil:navy.navwar.niwcatlantic.scc.sql.server:questionnaire:3901"/>
            <xccdf:check-content>If security labeling is not required, this is not a finding.

If security labeling requirements have been specified, but neither a third-party solution nor a SQL Server Row-Level security solution is implemented that reliably maintains labels on information in process, this is a finding.</xccdf:check-content>
          </xccdf:check>
        </xccdf:Rule>
      </xccdf:Group>
      <xccdf:Group id="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213920">
        <xccdf:title>SRG-APP-000314-DB-000310</xccdf:title>
        <xccdf:description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</xccdf:description>
        <xccdf:Rule id="xccdf_navy.navwar.niwcatlantic.scc.ms_rule_SV-213920r961275_rule" weight="10.0" severity="medium">
          <xccdf:version>SQL6-D0-002700</xccdf:version>
          <xccdf:title>SQL Server must associate organization-defined types of security labels having organization-defined security label values with information in transmission.</xccdf:title>
          <xccdf:description>&lt;VulnDiscussion&gt;Without the association of security labels to information, there is no basis for SQL Server to make security-related access-control decisions.

Security labels are abstractions representing the basic properties or characteristics of an entity (e.g., subjects and objects) with respect to safeguarding information. These labels are typically associated with internal data structures (e.g., tables, rows) within the database and are used to enable the implementation of access control and flow control policies; reflect special dissemination, handling, or distribution instructions; or support other aspects of the information security policy. One example includes marking data as classified or FOUO. These security labels may be assigned manually or during data processing, but, either way, it is imperative these assignments are maintained while the data is in storage. If the security labels are lost when the data is stored, there is the risk of a data compromise.

The mechanism used to support security labeling may be a feature of SQL Server, a third-party product, or custom application code.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</xccdf:description>
          <xccdf:reference>
            <dc:title>DPMS Target MS SQL Server 2016 Database</dc:title>
            <dc:publisher>DISA</dc:publisher>
            <dc:type>DPMS Target</dc:type>
            <dc:subject>MS SQL Server 2016 Database</dc:subject>
            <dc:identifier>3992</dc:identifier>
          </xccdf:reference>
          <xccdf:ident system="http://cyber.mil/legacy">SV-93809</xccdf:ident>
          <xccdf:ident system="http://cyber.mil/legacy">V-79103</xccdf:ident>
          <xccdf:ident system="http://cyber.mil/cci">CCI-002264</xccdf:ident>
          <xccdf:fixtext fixref="F-15136r313193_fix">Deploy SQL Server Row-Level Security (see link below) or a third-party software, or add custom data structures, data elements and application code, to provide reliable security labeling of information in transmission.

https://msdn.microsoft.com/en-us/library/dn765131.aspx</xccdf:fixtext>
          <xccdf:fix id="F-15136r313193_fix"/>
          <xccdf:check system="http://scap.nist.gov/schema/ocil/2" selector="">
            <xccdf:check-content-ref href="U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-ocil.xml" name="ocil:navy.navwar.niwcatlantic.scc.sql.server:questionnaire:4101"/>
          </xccdf:check>
          <xccdf:check system="http://scap.nist.gov/schema/ocil/2" selector="manual">
            <xccdf:check-content-ref href="U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-ocil.xml" name="ocil:navy.navwar.niwcatlantic.scc.sql.server:questionnaire:4101"/>
            <xccdf:check-content>If security labeling is not required, this is not a finding.

If security labeling requirements have been specified, but neither a third-party solution nor a SQL Server Row-Level security solution is implemented that reliably maintains labels on information in transmission, this is a finding.</xccdf:check-content>
          </xccdf:check>
        </xccdf:Rule>
      </xccdf:Group>
      <xccdf:Group id="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213921">
        <xccdf:title>SRG-APP-000328-DB-000301</xccdf:title>
        <xccdf:description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</xccdf:description>
        <xccdf:Rule id="xccdf_navy.navwar.niwcatlantic.scc.ms_rule_SV-213921r961317_rule" weight="10.0" severity="low">
          <xccdf:version>SQL6-D0-002800</xccdf:version>
          <xccdf:title>SQL Server must enforce discretionary access control policies, as defined by the data owner, over defined subjects and objects.</xccdf:title>
          <xccdf:description>&lt;VulnDiscussion&gt;Discretionary Access Control (DAC) is based on the notion that individual users are "owners" of objects and therefore have discretion over who should be authorized to access the object and in which mode (e.g., read or write). Ownership is usually acquired as a consequence of creating the object or via specified ownership assignment. DAC allows the owner to determine who will have access to objects they control. An example of DAC includes user-controlled table permissions.

When discretionary access control policies are implemented, subjects are not constrained with regard to what actions they can take with information for which they have already been granted access. Thus, subjects that have been granted access to information are not prevented from passing (i.e., the subjects have the discretion to pass) the information to other subjects or objects. 

A subject that is constrained in its operation by Mandatory Access Control policies is still able to operate under the less rigorous constraints of this requirement. Thus, while Mandatory Access Control imposes constraints preventing a subject from passing information to another subject operating at a different sensitivity level, this requirement permits the subject to pass the information to any subject at the same sensitivity level. 

The policy is bounded by the information system boundary. Once the information is passed outside of the control of the information system, additional means may be required to ensure the constraints remain in effect. While the older, more traditional definitions of discretionary access control require identity-based access control, that limitation is not required for this use of discretionary access control.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</xccdf:description>
          <xccdf:reference>
            <dc:title>DPMS Target MS SQL Server 2016 Database</dc:title>
            <dc:publisher>DISA</dc:publisher>
            <dc:type>DPMS Target</dc:type>
            <dc:subject>MS SQL Server 2016 Database</dc:subject>
            <dc:identifier>3992</dc:identifier>
          </xccdf:reference>
          <xccdf:ident system="http://cyber.mil/legacy">SV-93811</xccdf:ident>
          <xccdf:ident system="http://cyber.mil/legacy">V-79105</xccdf:ident>
          <xccdf:ident system="http://cyber.mil/cci">CCI-002165</xccdf:ident>
          <xccdf:fixtext fixref="F-15137r313196_fix">To correct object ownership:

ALTER AUTHORIZATION ON &lt;Securable&gt; TO &lt;Principal&gt;

To revoke any unauthorized permissions:

REVOKE [Permission] ON &lt;Securable&gt; TO &lt;Principal&gt;</xccdf:fixtext>
          <xccdf:fix id="F-15137r313196_fix"/>
          <xccdf:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5" selector="">
            <xccdf:check-content-ref href="U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-oval2.xml" name="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:def:213921"/>
            <xccdf:check-content-ref href="U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-ocil.xml" name="ocil:navy.navwar.niwcatlantic.scc.ms.sql.server.db.hybrid:questionnaire:213921"/>
            <xccdf:check-content>oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:21392104;;Database;;user_name;;Array</xccdf:check-content>
          </xccdf:check>
          <xccdf:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5" selector="hybrid">
            <xccdf:check-content-ref href="U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-oval2.xml" name="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:def:213921"/>
            <xccdf:check-content-ref href="U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-ocil.xml" name="ocil:navy.navwar.niwcatlantic.scc.ms.sql.server.db.hybrid:questionnaire:213921"/>
            <xccdf:check-content>oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:21392104;;Database;;user_name;;Array</xccdf:check-content>
          </xccdf:check>
          <xccdf:check system="http://scap.nist.gov/schema/ocil/2" selector="manual">
            <xccdf:check-content-ref href="U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-ocil.xml" name="ocil:navy.navwar.niwcatlantic.scc.sql.server:questionnaire:4301"/>
            <xccdf:check-content>Review system documentation to determine requirements for object ownership and authorization delegation.

Use the following query to discover database object ownership:

Schemas not owned by the schema or dbo:

SELECT name AS schema_name, USER_NAME(principal_id) AS schema_owner
FROM sys.schemas
WHERE schema_id != principal_id
 AND principal_id != 1

Objects owned by an individual principal:

SELECT object_id, name AS securable, 
  USER_NAME(principal_id) AS object_owner,
  type_desc
FROM sys.objects
WHERE is_ms_shipped = 0 AND principal_id IS NOT NULL
ORDER BY type_desc, securable, object_owner

Use the following query to discover database users who have been delegated the right to assign additional permissions:

SELECT U.type_desc, U.name AS grantee,
 DP.class_desc AS securable_type,
   CASE DP.class
    WHEN 0 THEN DB_NAME()
    WHEN 1 THEN OBJECT_NAME(DP.major_id) 
    WHEN 3 THEN SCHEMA_NAME(DP.major_id)
   ELSE CAST(DP.major_id AS nvarchar)
   END AS securable,
       permission_name, state_desc
FROM sys.database_permissions DP
JOIN sys.database_principals U ON DP.grantee_principal_id = U.principal_id
WHERE DP.state = 'W'
ORDER BY grantee, securable_type, securable

If any of these rights are not documented and authorized, this is a finding.</xccdf:check-content>
          </xccdf:check>
        </xccdf:Rule>
      </xccdf:Group>
      <xccdf:Group id="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213922">
        <xccdf:title>SRG-APP-000342-DB-000302</xccdf:title>
        <xccdf:description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</xccdf:description>
        <xccdf:Rule id="xccdf_navy.navwar.niwcatlantic.scc.ms_rule_SV-213922r961359_rule" weight="10.0" severity="medium">
          <xccdf:version>SQL6-D0-002900</xccdf:version>
          <xccdf:title>Execution of stored procedures and functions that utilize execute as must be restricted to necessary cases only.</xccdf:title>
          <xccdf:description>&lt;VulnDiscussion&gt;In certain situations, to provide required functionality, a DBMS needs to execute internal logic (stored procedures, functions, triggers, etc.) and/or external code modules with elevated privileges. However, if the privileges required for execution are at a higher level than the privileges assigned to organizational users invoking the functionality applications/programs, those users are indirectly provided with greater privileges than assigned by organizations.

Privilege elevation must be utilized only where necessary and protected from misuse.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</xccdf:description>
          <xccdf:reference>
            <dc:title>DPMS Target MS SQL Server 2016 Database</dc:title>
            <dc:publisher>DISA</dc:publisher>
            <dc:type>DPMS Target</dc:type>
            <dc:subject>MS SQL Server 2016 Database</dc:subject>
            <dc:identifier>3992</dc:identifier>
          </xccdf:reference>
          <xccdf:ident system="http://cyber.mil/legacy">SV-93813</xccdf:ident>
          <xccdf:ident system="http://cyber.mil/legacy">V-79107</xccdf:ident>
          <xccdf:ident system="http://cyber.mil/cci">CCI-002233</xccdf:ident>
          <xccdf:fixtext fixref="F-15138r313199_fix">Alter stored procedures and functions to remove the "EXECUTE AS" statement.</xccdf:fixtext>
          <xccdf:fix id="F-15138r313199_fix"/>
          <xccdf:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5" selector="">
            <xccdf:check-content-ref href="U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-oval2.xml" name="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:def:213922"/>
            <xccdf:check-content-ref href="U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-ocil.xml" name="ocil:navy.navwar.niwcatlantic.scc.ms.sql.server.db.hybrid:questionnaire:213922"/>
            <xccdf:check-content>oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:21392204;;Database;;module_name;;Array</xccdf:check-content>
          </xccdf:check>
          <xccdf:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5" selector="hybrid">
            <xccdf:check-content-ref href="U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-oval2.xml" name="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:def:213922"/>
            <xccdf:check-content-ref href="U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-ocil.xml" name="ocil:navy.navwar.niwcatlantic.scc.ms.sql.server.db.hybrid:questionnaire:213922"/>
            <xccdf:check-content>oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:21392204;;Database;;module_name;;Array</xccdf:check-content>
          </xccdf:check>
          <xccdf:check system="http://scap.nist.gov/schema/ocil/2" selector="manual">
            <xccdf:check-content-ref href="U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-ocil.xml" name="ocil:navy.navwar.niwcatlantic.scc.sql.server:questionnaire:4501"/>
            <xccdf:check-content>Review the system documentation to obtain a listing of stored procedures and functions that utilize impersonation. Execute the following query:


SELECT S.name AS schema_name, O.name AS module_name,
USER_NAME(
CASE M.execute_as_principal_id
WHEN -2 THEN COALESCE(O.principal_id, S.principal_id)
ELSE M.execute_as_principal_id
END
) AS execute_as
FROM sys.sql_modules M
JOIN sys.objects O ON M.object_id = O.object_id
JOIN sys.schemas S ON O.schema_id = S.schema_id
WHERE execute_as_principal_id IS NOT NULL
and       o.name not in 
(             
'fn_sysdac_get_username',
                             'fn_sysutility_ucp_get_instance_is_mi',
                             'sp_send_dbmail',
                             'sp_SendMailMessage',
                             'sp_syscollector_create_collection_set',
                             'sp_syscollector_delete_collection_set',
                             'sp_syscollector_disable_collector',
                             'sp_syscollector_enable_collector',
                             'sp_syscollector_get_collection_set_execution_status',
                             'sp_syscollector_run_collection_set',
                             'sp_syscollector_start_collection_set',
                             'sp_syscollector_update_collection_set',
                             'sp_syscollector_upload_collection_set',
                             'sp_syscollector_verify_collector_state',
                             'sp_syspolicy_add_policy',
                             'sp_syspolicy_add_policy_category_subscription',
                             'sp_syspolicy_delete_policy',
                             'sp_syspolicy_delete_policy_category_subscription',
                             'sp_syspolicy_update_policy',
                             'sp_sysutility_mi_add_ucp_registration',
                             'sp_sysutility_mi_disable_collection',
                             'sp_sysutility_mi_enroll',
                             'sp_sysutility_mi_initialize_collection',
                             'sp_sysutility_mi_remove',
                             'sp_sysutility_mi_remove_ucp_registration',
                             'sp_sysutility_mi_upload',
                             'sp_sysutility_mi_validate_enrollment_preconditions',
                             'sp_sysutility_ucp_add_mi',
                             'sp_sysutility_ucp_add_policy',
                             'sp_sysutility_ucp_calculate_aggregated_dac_health',
                             'sp_sysutility_ucp_calculate_aggregated_mi_health',
                             'sp_sysutility_ucp_calculate_computer_health',
                             'sp_sysutility_ucp_calculate_dac_file_space_health',
                             'sp_sysutility_ucp_calculate_dac_health',
                            'sp_sysutility_ucp_calculate_filegroups_with_policy_violations',
                             'sp_sysutility_ucp_calculate_health',
                             'sp_sysutility_ucp_calculate_mi_file_space_health',
                             'sp_sysutility_ucp_calculate_mi_health',
                             'sp_sysutility_ucp_configure_policies',
                             'sp_sysutility_ucp_create',
                             'sp_sysutility_ucp_delete_policy',
                             'sp_sysutility_ucp_delete_policy_history',
                             'sp_sysutility_ucp_get_policy_violations',
                             'sp_sysutility_ucp_initialize',
                             'sp_sysutility_ucp_initialize_mdw',
                             'sp_sysutility_ucp_remove_mi',
                             'sp_sysutility_ucp_update_policy',
                             'sp_sysutility_ucp_update_utility_configuration',
                             'sp_sysutility_ucp_validate_prerequisites',
                             'sp_validate_user',
                             'syscollector_collection_set_is_running_update_trigger',
                             'sysmail_help_status_sp'
)

ORDER BY schema_name, module_name

If any procedures or functions are returned that are not documented, this is a finding.</xccdf:check-content>
          </xccdf:check>
        </xccdf:Rule>
      </xccdf:Group>
      <xccdf:Group id="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213923">
        <xccdf:title>SRG-APP-000378-DB-000365</xccdf:title>
        <xccdf:description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</xccdf:description>
        <xccdf:Rule id="xccdf_navy.navwar.niwcatlantic.scc.ms_rule_SV-213923r1018608_rule" weight="10.0" severity="medium">
          <xccdf:version>SQL6-D0-003000</xccdf:version>
          <xccdf:title>SQL Server must prohibit user installation of logic modules (stored procedures, functions, triggers, views, etc.) without explicit privileged status.</xccdf:title>
          <xccdf:description>&lt;VulnDiscussion&gt;Allowing regular users to install software, without explicit privileges, creates the risk that untested or potentially malicious software will be installed on the system. Explicit privileges (escalated or administrative privileges) provide the regular user with explicit capabilities and control that exceed the rights of a regular user.

DBMS functionality and the nature and requirements of databases will vary; so while users are not permitted to install unapproved software, there may be instances where the organization allows the user to install approved software packages such as from an approved software repository. The requirements for production servers will be more restrictive than those used for development and research.

SQL Server must enforce software installation by users based upon what types of software installations are permitted (e.g., updates and security patches to existing software) and what types of installations are prohibited (e.g., software whose pedigree with regard to being potentially malicious is unknown or suspect) by the organization. 

In the case of a database management system, this requirement covers stored procedures, functions, triggers, views, etc.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</xccdf:description>
          <xccdf:reference>
            <dc:title>DPMS Target MS SQL Server 2016 Database</dc:title>
            <dc:publisher>DISA</dc:publisher>
            <dc:type>DPMS Target</dc:type>
            <dc:subject>MS SQL Server 2016 Database</dc:subject>
            <dc:identifier>3992</dc:identifier>
          </xccdf:reference>
          <xccdf:ident system="http://cyber.mil/legacy">SV-93815</xccdf:ident>
          <xccdf:ident system="http://cyber.mil/legacy">V-79109</xccdf:ident>
          <xccdf:ident system="http://cyber.mil/cci">CCI-003980</xccdf:ident>
          <xccdf:ident system="http://cyber.mil/cci">CCI-001812</xccdf:ident>
          <xccdf:fixtext fixref="F-15139r998241_fix">Document and obtain approval for any nonadministrative users who require the ability to create, alter, or replace logic modules.

Revoke the ALTER permission from unauthorized users and roles:
REVOKE ALTER ON [&lt;Object Name&gt;] TO [&lt;Principal Name&gt;]</xccdf:fixtext>
          <xccdf:fix id="F-15139r998241_fix"/>
          <xccdf:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5" selector="">
            <xccdf:check-content-ref href="U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-oval2.xml" name="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.2016.db:def:213923"/>
            <xccdf:check-content-ref href="U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-ocil.xml" name="ocil:navy.navwar.niwcatlantic.scc.ms.sql.server.db.hybrid:questionnaire:213923"/>
            <xccdf:check-content>oval:navy.navwar.niwcatlantic.scc.ms.sql.server.2016.db:var:21392304;;Database;;user_name;;Array</xccdf:check-content>
          </xccdf:check>
          <xccdf:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5" selector="hybrid">
            <xccdf:check-content-ref href="U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-oval2.xml" name="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.2016.db:def:213923"/>
            <xccdf:check-content-ref href="U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-ocil.xml" name="ocil:navy.navwar.niwcatlantic.scc.ms.sql.server.db.hybrid:questionnaire:213923"/>
            <xccdf:check-content>oval:navy.navwar.niwcatlantic.scc.ms.sql.server.2016.db:var:21392304;;Database;;user_name;;Array</xccdf:check-content>
          </xccdf:check>
          <xccdf:check system="http://scap.nist.gov/schema/ocil/2" selector="manual">
            <xccdf:check-content-ref href="U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-ocil.xml" name="ocil:navy.navwar.niwcatlantic.scc.sql.server:questionnaire:4701"/>
            <xccdf:check-content>If the SQL Server instance supports only software development, experimentation, and/or developer-level testing (i.e., excluding production systems, integration testing, stress testing, and user acceptance testing), this is not a finding. 

Obtain a listing of users and roles who are authorized to create, alter, or replace logic modules from the server documentation.

In each user database, execute the following query:

SELECT P.type_desc AS principal_type, P.name AS principal_name,
O.type_desc,
CASE class
WHEN 0 THEN DB_NAME()
WHEN 1 THEN OBJECT_SCHEMA_NAME(major_id) + '.' + OBJECT_NAME(major_id)
WHEN 3 THEN SCHEMA_NAME(major_id)
ELSE class_desc + '(' + CAST(major_id AS nvarchar) + ')'
END AS securable_name, DP.state_desc, DP.permission_name
FROM sys.database_permissions DP
JOIN sys.database_principals P ON DP.grantee_principal_id = P.principal_id
LEFT OUTER JOIN sys.all_objects O ON O.object_id = DP.major_id AND O.type IN ('TR','TA','P','X','RF','PC','IF','FN','TF','U')
WHERE DP.type IN ('AL','ALTG') AND DP.class IN (0, 1, 53)

SELECT R.name AS role_name, M.type_desc AS principal_type, M.name AS principal_name
FROM sys.database_principals R
JOIN sys.database_role_members DRM ON R.principal_id = DRM.role_principal_id
JOIN sys.database_principals M ON DRM.member_principal_id = M.principal_id
WHERE R.name IN ('db_ddladmin','db_owner')
AND M.name != 'dbo'

If any users or role permissions returned are not authorized to modify the specified object or type, this is a finding. 

If any user or role membership is not authorized, this is a finding.</xccdf:check-content>
          </xccdf:check>
        </xccdf:Rule>
      </xccdf:Group>
      <xccdf:Group id="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213924">
        <xccdf:title>SRG-APP-000380-DB-000360</xccdf:title>
        <xccdf:description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</xccdf:description>
        <xccdf:Rule id="xccdf_navy.navwar.niwcatlantic.scc.ms_rule_SV-213924r961461_rule" weight="10.0" severity="medium">
          <xccdf:version>SQL6-D0-003100</xccdf:version>
          <xccdf:title>SQL Server must enforce access restrictions associated with changes to the configuration of the database(s).</xccdf:title>
          <xccdf:description>&lt;VulnDiscussion&gt;Failure to provide logical access restrictions associated with changes to configuration may have significant effects on the overall security of the system. 

When dealing with access restrictions pertaining to change control, it should be noted that any changes to the hardware, software, and/or firmware components of the information system can potentially have significant effects on the overall security of the system. 

Accordingly, only qualified and authorized individuals should be allowed to obtain access to system components for the purposes of initiating changes, including upgrades and modifications.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</xccdf:description>
          <xccdf:reference>
            <dc:title>DPMS Target MS SQL Server 2016 Database</dc:title>
            <dc:publisher>DISA</dc:publisher>
            <dc:type>DPMS Target</dc:type>
            <dc:subject>MS SQL Server 2016 Database</dc:subject>
            <dc:identifier>3992</dc:identifier>
          </xccdf:reference>
          <xccdf:ident system="http://cyber.mil/legacy">SV-93817</xccdf:ident>
          <xccdf:ident system="http://cyber.mil/legacy">V-79111</xccdf:ident>
          <xccdf:ident system="http://cyber.mil/cci">CCI-001813</xccdf:ident>
          <xccdf:fixtext fixref="F-15140r313205_fix">Remove unauthorized users from roles:

ALTER ROLE DROP MEMBER user;

https://msdn.microsoft.com/en-us/library/ms189775.aspx

Set the owner of the database to an authorized login:

ALTER AUTHORIZATION ON database::DatabaseName TO login;

https://msdn.microsoft.com/en-us/library/ms187359.aspx</xccdf:fixtext>
          <xccdf:fix id="F-15140r313205_fix"/>
          <xccdf:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5" selector="">
            <xccdf:check-content-ref href="U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-oval2.xml" name="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:def:213924"/>
            <xccdf:check-content-ref href="U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-ocil.xml" name="ocil:navy.navwar.niwcatlantic.scc.ms.sql.server.db.hybrid:questionnaire:213924"/>
            <xccdf:check-content>oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:21392404;;Database;;database_name;;Array</xccdf:check-content>
          </xccdf:check>
          <xccdf:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5" selector="hybrid">
            <xccdf:check-content-ref href="U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-oval2.xml" name="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:def:213924"/>
            <xccdf:check-content-ref href="U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-ocil.xml" name="ocil:navy.navwar.niwcatlantic.scc.ms.sql.server.db.hybrid:questionnaire:213924"/>
            <xccdf:check-content>oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:21392404;;Database;;database_name;;Array</xccdf:check-content>
          </xccdf:check>
          <xccdf:check system="http://scap.nist.gov/schema/ocil/2" selector="manual">
            <xccdf:check-content-ref href="U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-ocil.xml" name="ocil:navy.navwar.niwcatlantic.scc.sql.server:questionnaire:4901"/>
            <xccdf:check-content>Execute the following query to obtain a listing of user databases whose owner is a member of a fixed server role:

 SELECT 
              D.name AS database_name, SUSER_SNAME(D.owner_sid) AS owner_name,
              FRM.is_fixed_role_member
FROM sys.databases D
OUTER APPLY (
              SELECT MAX(fixed_role_member) AS is_fixed_role_member
              FROM (
                            SELECT IS_SRVROLEMEMBER(R.name, SUSER_SNAME(D.owner_sid)) AS fixed_role_member
                            FROM sys.server_principals R
                            WHERE is_fixed_role = 1
              ) A
) FRM
WHERE D.database_id &gt; 4
              AND (FRM.is_fixed_role_member = 1 
                            OR FRM.is_fixed_role_member IS NULL)
ORDER BY database_name 

If no databases are returned, this is not a finding. 

For each database/login returned, review the Server Role memberships 

1.	In SQL Server Management Studio, Expand &#8220;Logins&#8221;
2.	Double-click the name of the Login
3.	Click the &#8220;Server Roles&#8221; tab 

If any server roles are selected, but not documented and authorized, this is a finding.</xccdf:check-content>
          </xccdf:check>
        </xccdf:Rule>
      </xccdf:Group>
      <xccdf:Group id="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213926">
        <xccdf:title>SRG-APP-000428-DB-000386</xccdf:title>
        <xccdf:description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</xccdf:description>
        <xccdf:Rule id="xccdf_navy.navwar.niwcatlantic.scc.ms_rule_SV-213926r1018576_rule" weight="10.0" severity="high">
          <xccdf:version>SQL6-D0-003300</xccdf:version>
          <xccdf:title>SQL Server must implement cryptographic mechanisms to prevent unauthorized modification of organization-defined information at rest (to include, at a minimum, PII and classified information) on organization-defined information system components.</xccdf:title>
          <xccdf:description>&lt;VulnDiscussion&gt;DBMSs handling data requiring "data at rest" protections must employ cryptographic mechanisms to prevent unauthorized disclosure and modification of the information at rest. These cryptographic mechanisms may be native to SQL Server or implemented via additional software or operating system/file system settings, as appropriate to the situation.

Selection of a cryptographic mechanism is based on the need to protect the integrity of organizational information. The strength of the mechanism is commensurate with the security category and/or classification of the information. Organizations have the flexibility to either encrypt all information on storage devices (i.e., full disk encryption) or encrypt specific data structures (e.g., files, records, or fields). 

The decision whether and what to encrypt rests with the data owner and is also influenced by the physical measures taken to secure the equipment and media on which the information resides.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</xccdf:description>
          <xccdf:reference>
            <dc:title>DPMS Target MS SQL Server 2016 Database</dc:title>
            <dc:publisher>DISA</dc:publisher>
            <dc:type>DPMS Target</dc:type>
            <dc:subject>MS SQL Server 2016 Database</dc:subject>
            <dc:identifier>3992</dc:identifier>
          </xccdf:reference>
          <xccdf:ident system="http://cyber.mil/legacy">SV-93821</xccdf:ident>
          <xccdf:ident system="http://cyber.mil/legacy">V-79115</xccdf:ident>
          <xccdf:ident system="http://cyber.mil/cci">CCI-002475</xccdf:ident>
          <xccdf:fixtext fixref="F-15142r313211_fix">Where full-disk encryption is required, configure Windows and/or the storage system to provide this. 

Where transparent data encryption (TDE) is required, create a master key, obtain a certificate protected by the master key, create a database encryption key and protect it by the certificate, and then set the database to use encryption. For guidance from MSDN on how to do this: https://msdn.microsoft.com/en-us/library/bb934049.aspx. 

Where table/column encryption is required, enable encryption on the tables/columns in question. For guidance from the Microsoft Developer Network on how to do this with Always Encrypted: https://msdn.microsoft.com/en-us/library/mt163865.aspx.</xccdf:fixtext>
          <xccdf:fix id="F-15142r313211_fix"/>
          <xccdf:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5" selector="">
            <xccdf:check-content-ref href="U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-oval2.xml" name="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:def:213926"/>
            <xccdf:check-content-ref href="U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-ocil.xml" name="ocil:navy.navwar.niwcatlantic.scc.ms.sql.server.db.hybrid:questionnaire:213926"/>
            <xccdf:check-content>oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:21392604;;Database;;encryption_state;;Array</xccdf:check-content>
          </xccdf:check>
          <xccdf:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5" selector="hybrid">
            <xccdf:check-content-ref href="U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-oval2.xml" name="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:def:213926"/>
            <xccdf:check-content-ref href="U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-ocil.xml" name="ocil:navy.navwar.niwcatlantic.scc.ms.sql.server.db.hybrid:questionnaire:213926"/>
            <xccdf:check-content>oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:21392604;;Database;;encryption_state;;Array</xccdf:check-content>
          </xccdf:check>
          <xccdf:check system="http://scap.nist.gov/schema/ocil/2" selector="manual">
            <xccdf:check-content-ref href="U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-ocil.xml" name="ocil:navy.navwar.niwcatlantic.scc.sql.server:questionnaire:5101"/>
            <xccdf:check-content>Review the system documentation to determine whether the organization has defined the information at rest that is to be protected from modification, which must include, at a minimum, PII and classified information. 

If no information is identified as requiring such protection, this is not a finding. 

Review the configuration of SQL Server, Windows, and additional software as relevant. 

If full-disk encryption is required, and Windows or the storage system is not configured for this, this is a finding. 

If database transparent data encryption (TDE) is called for, check whether it is enabled: 

SELECT
DB_NAME(database_id) AS [Database Name], CASE encryption_state WHEN 0 THEN 'No database encryption key present, no encryption' 
WHEN 1 THEN 'Unencrypted' 
WHEN 2 THEN 'Encryption in progress' 
WHEN 3 THEN 'Encrypted' 
WHEN 4 THEN 'Key change in progress' 
WHEN 5 THEN 'Decryption in progress' 
WHEN 6 THEN 'Protection change in progress' 
END AS [Encryption State]
FROM sys.dm_database_encryption_keys

For each user database for which encryption is called for and it is marked Unencrypted, this is a finding. 

If table/column encryption and/or a separation between those who own the data (and can view it) and those who manage the data (but should have no access) is required for PII or similar types of data, use Always Encrypted.  The details for configuring Always Encrypted are located here: https://msdn.microsoft.com/en-us/library/mt163865.aspx.

Review the definitions and contents of the relevant tables/columns for the Always Encryption settings, if any of the information defined as requiring cryptographic protection is not encrypted this is a finding.</xccdf:check-content>
          </xccdf:check>
        </xccdf:Rule>
      </xccdf:Group>
      <xccdf:Group id="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-213927">
        <xccdf:title>SRG-APP-000429-DB-000387</xccdf:title>
        <xccdf:description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</xccdf:description>
        <xccdf:Rule id="xccdf_navy.navwar.niwcatlantic.scc.ms_rule_SV-213927r1018577_rule" weight="10.0" severity="high">
          <xccdf:version>SQL6-D0-003400</xccdf:version>
          <xccdf:title>SQL Server must implement cryptographic mechanisms preventing the unauthorized disclosure of organization-defined information at rest on organization-defined information system components.</xccdf:title>
          <xccdf:description>&lt;VulnDiscussion&gt;SQL Server&#8217;s handling data requiring "data at rest" protections must employ cryptographic mechanisms to prevent unauthorized disclosure and modification of the information at rest. These cryptographic mechanisms may be native to SQL Server or implemented via additional software or operating system/file system settings, as appropriate to the situation.

Selection of a cryptographic mechanism is based on the need to protect the integrity of organizational information. The strength of the mechanism is commensurate with the security category and/or classification of the information. Organizations have the flexibility to either encrypt all information on storage devices (i.e., full disk encryption) or encrypt specific data structures (e.g., files, records, or fields). 

The decision whether and what to encrypt rests with the data owner and is also influenced by the physical measures taken to secure the equipment and media on which the information resides.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</xccdf:description>
          <xccdf:reference>
            <dc:title>DPMS Target MS SQL Server 2016 Database</dc:title>
            <dc:publisher>DISA</dc:publisher>
            <dc:type>DPMS Target</dc:type>
            <dc:subject>MS SQL Server 2016 Database</dc:subject>
            <dc:identifier>3992</dc:identifier>
          </xccdf:reference>
          <xccdf:ident system="http://cyber.mil/legacy">SV-93823</xccdf:ident>
          <xccdf:ident system="http://cyber.mil/legacy">V-79117</xccdf:ident>
          <xccdf:ident system="http://cyber.mil/cci">CCI-002476</xccdf:ident>
          <xccdf:fixtext fixref="F-15143r313214_fix">Where full-disk encryption is required, configure Windows and/or the storage system to provide this. 

Where transparent data encryption (TDE) is required, create a master key, obtain a certificate protected by the master key, create a database encryption key and protect it by the certificate, and then set the database to use encryption. For guidance from MSDN on how to do this: https://msdn.microsoft.com/en-us/library/bb934049.aspx. 

Where table/column encryption is required, enable encryption on the table/columns in question. For guidance from the Microsoft Developer Network on how to do this with Always Encrypted: https://msdn.microsoft.com/en-us/library/mt163865.aspx.</xccdf:fixtext>
          <xccdf:fix id="F-15143r313214_fix"/>
          <xccdf:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5" selector="">
            <xccdf:check-content-ref href="U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-oval2.xml" name="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:def:213926"/>
            <xccdf:check-content-ref href="U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-ocil.xml" name="ocil:navy.navwar.niwcatlantic.scc.ms.sql.server.db.hybrid:questionnaire:213926"/>
            <xccdf:check-content>oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:21392604;;Database;;encryption_state;;Array</xccdf:check-content>
          </xccdf:check>
          <xccdf:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5" selector="hybrid">
            <xccdf:check-content-ref href="U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-oval2.xml" name="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:def:213926"/>
            <xccdf:check-content-ref href="U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-ocil.xml" name="ocil:navy.navwar.niwcatlantic.scc.ms.sql.server.db.hybrid:questionnaire:213926"/>
            <xccdf:check-content>oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:21392604;;Database;;encryption_state;;Array</xccdf:check-content>
          </xccdf:check>
          <xccdf:check system="http://scap.nist.gov/schema/ocil/2" selector="manual">
            <xccdf:check-content-ref href="U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-ocil.xml" name="ocil:navy.navwar.niwcatlantic.scc.sql.server:questionnaire:5301"/>
            <xccdf:check-content>Review the system documentation to determine whether the organization has defined the information at rest that is to be protected from disclosure, which must include, at a minimum, PII and classified information. 

If no information is identified as requiring such protection, this is not a finding. 

If full-disk encryption is required, and Windows or the storage system is not configured for this, this is a finding. 

If database transparent data encryption (TDE) is called for, check whether it is enabled: 

SELECT
DB_NAME(database_id) AS [Database Name], CASE encryption_state WHEN 0 THEN 'No database encryption key present, no encryption' 
WHEN 1 THEN 'Unencrypted' 
WHEN 2 THEN 'Encryption in progress' 
WHEN 3 THEN 'Encrypted' 
WHEN 4 THEN 'Key change in progress' 
WHEN 5 THEN 'Decryption in progress' 
WHEN 6 THEN 'Protection change in progress' 
END AS [Encryption State]
FROM sys.dm_database_encryption_keys

For each user database for which encryption is called for and it is marked Unencrypted, this is a finding. 

If table/column encryption and/or a separation between those who own the data (and can view it) and those who manage the data (but should have no access) is required for PII or similar types of data, use Always Encrypted.&#160; The details for configuring Always Encrypted are located here: https://msdn.microsoft.com/en-us/library/mt163865.aspx.

Review the definitions and contents of the relevant tables/columns for the Always Encryption settings, if any of the information defined as requiring cryptographic protection is not encrypted this is a finding.</xccdf:check-content>
          </xccdf:check>
        </xccdf:Rule>
      </xccdf:Group>
      <xccdf:Group id="xccdf_navy.navwar.niwcatlantic.scc.ms_group_V-251040">
        <xccdf:title>SRG-APP-000416-DB-000380</xccdf:title>
        <xccdf:description>&lt;GroupDescription&gt;&lt;/GroupDescription&gt;</xccdf:description>
        <xccdf:Rule id="xccdf_navy.navwar.niwcatlantic.scc.ms_rule_SV-251040r962034_rule" weight="10.0" severity="high">
          <xccdf:version>SQL6-D0-003200</xccdf:version>
          <xccdf:title>SQL Server must use NSA-approved cryptography to protect classified information in accordance with the data owners requirements.</xccdf:title>
          <xccdf:description>&lt;VulnDiscussion&gt;Use of weak or untested encryption algorithms undermines the purposes of utilizing encryption to protect data. The application must implement cryptographic modules adhering to the higher standards approved by the federal government since this provides assurance they have been tested and validated.

It is the responsibility of the data owner to assess the cryptography requirements in light of applicable federal laws, Executive Orders, directives, policies, regulations, and standards.

NSA-approved cryptography for classified networks is hardware based. This requirement addresses the compatibility of a DBMS with the encryption devices.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</xccdf:description>
          <xccdf:reference>
            <dc:title>DPMS Target MS SQL Server 2016 Database</dc:title>
            <dc:publisher>DISA</dc:publisher>
            <dc:type>DPMS Target</dc:type>
            <dc:subject>MS SQL Server 2016 Database</dc:subject>
            <dc:identifier>3992</dc:identifier>
          </xccdf:reference>
          <xccdf:ident system="http://cyber.mil/legacy">SV-93819</xccdf:ident>
          <xccdf:ident system="http://cyber.mil/legacy">V-79113</xccdf:ident>
          <xccdf:ident system="http://cyber.mil/cci">CCI-002450</xccdf:ident>
          <xccdf:fixtext fixref="F-54429r822451_fix">Configure cryptographic functions to use NSA-approved cryptography compliant algorithms.

Use DoD code-signing certificates to create asymmetric keys stored in the database used to encrypt sensitive data stored in the database.

Run the following SQL script to create a certificate:
USE 
CREATE CERTIFICATE 
 ENCRYPTION BY PASSWORD = &lt;'password'&gt;
 FROM FILE = &lt;'path/file_name'&gt;
 WITH SUBJECT = 'name of person creating key',
 EXPIRY_DATE = '&lt;'expiration date: yyyymmdd'&gt;'

Run the following SQL script to create a symmetric key and assign an existing certificate:
USE 
CREATE SYMMETRIC KEY &lt;'key name'&gt;
 WITH ALGORITHM = AES_256 
 ENCRYPTION BY CERTIFICATE

For Transparent Data Encryption (TDE):
USE master;
CREATE MASTER KEY ENCRYPTION BY PASSWORD = '';
CREATE CERTIFICATE  . . .;
USE ;
CREATE DATABASE ENCRYPTION KEY
WITH ALGORITHM = AES_256
ENCRYPTION BY SERVER CERTIFICATE ;
ALTER DATABASE 
SET ENCRYPTION ON;</xccdf:fixtext>
          <xccdf:fix id="F-54429r822451_fix"/>
          <xccdf:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5" selector="">
            <xccdf:check-content-ref href="U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-oval2.xml" name="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:def:251040"/>
            <xccdf:check-content-ref href="U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-ocil.xml" name="ocil:navy.navwar.niwcatlantic.scc.ms.sql.server.db.hybrid:questionnaire:251040"/>
            <xccdf:check-content>oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:25104002;;Database;;cryptography_required;;Single</xccdf:check-content>
          </xccdf:check>
          <xccdf:check system="http://oval.mitre.org/XMLSchema/oval-definitions-5" selector="hybrid">
            <xccdf:check-content-ref href="U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-oval2.xml" name="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:def:251040"/>
            <xccdf:check-content-ref href="U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-ocil.xml" name="ocil:navy.navwar.niwcatlantic.scc.ms.sql.server.db.hybrid:questionnaire:251040"/>
            <xccdf:check-content>oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:25104002;;Database;;cryptography_required;;Single</xccdf:check-content>
          </xccdf:check>
          <xccdf:check system="http://scap.nist.gov/schema/ocil/2" selector="manual">
            <xccdf:check-content-ref href="U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-ocil.xml" name="ocil:navy.navwar.niwcatlantic.scc.sql.server:questionnaire:5501"/>
            <xccdf:check-content>Detailed information on the NIST Cryptographic Module Validation Program (CMVP) is available at the following website: http://csrc.nist.gov/groups/STM/cmvp/index.html.

Review system documentation to determine whether cryptography for classified or sensitive information is required by the information owner.

If the system documentation does not specify the type of information hosted on SQL Server as classified, sensitive, and/or unclassified, this is a finding.

If neither classified nor sensitive information exists within SQL Server databases or configuration, this is not a finding.

Verify that Windows is configured to require the use of FIPS-compliant algorithms.

Click "Start",  enter "Local Security Policy", and then press "Enter". Expand "Local Policies", select "Security Options", and then locate "System Cryptography: Use FIPS compliant algorithms for encryption, hashing, and signing".

If the Security Setting for this option is "Disabled", this is a finding.

Note: The list of acceptable algorithms is "AES 256" and "Triple DES".

If cryptography is being used by SQL Server, verify that the cryptography is NIST FIPS 140-2 or 140-3 certified by running the following SQL query:

SELECT DISTINCT name, algorithm_desc
FROM sys.symmetric_keys
WHERE key_algorithm NOT IN ('D3','A3')
ORDER BY name

If any items listed show an uncertified NIST FIPS 140-2 algorithm type, this is a finding.</xccdf:check-content>
          </xccdf:check>
        </xccdf:Rule>
      </xccdf:Group>
    </xccdf:Benchmark>
  </component>
  <component id="scap_navy.navwar.niwcatlantic.scc_comp_U_U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-cpe-oval.xml" timestamp="2025-09-16T13:55:38.481217+00:00">
    <oval_definitions xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5" xmlns:oval="http://oval.mitre.org/XMLSchema/oval-common-5" xmlns:oval-def="http://oval.mitre.org/XMLSchema/oval-definitions-5" xmlns:independent-def="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" xmlns:windows-def="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://oval.mitre.org/XMLSchema/oval-common-5 https://github.com/OVALProject/Language/tree/5.11.2/schemas/oval-common-schema.xsd    http://oval.mitre.org/XMLSchema/oval-definitions-5 https://github.com/OVALProject/Language/tree/5.11.2/schemas/oval-definitions-schema.xsd    http://oval.mitre.org/XMLSchema/oval-definitions-5#independent https://github.com/OVALProject/Language/tree/5.11.2/schemas/independent-definitions-schema.xsd     http://oval.mitre.org/XMLSchema/oval-definitions-5#windows https://github.com/OVALProject/Language/tree/5.11.2/schemas/windows-definitions-schema.xsd">
      <oval-def:generator>
        <oval:product_name>Naval Information Warfare Center Atlantic</oval:product_name>
        <oval:schema_version>5.11.2</oval:schema_version>
        <oval:timestamp>2025-07-16T09:00:00</oval:timestamp>
      </oval-def:generator>
      <definitions>
        <definition id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.2016.db:def:100" version="3" class="inventory">
          <metadata>
            <title>SQL Server 2016-2022 STIG benchmark applicability.</title>
            <reference source="CPE" ref_id="cpe:/a:microsoft:sqlserver:2016"/>
            <description>A version of Microsoft SQL Server 2016-2019 is installed.</description>
          </metadata>
          <criteria>
            <criterion comment="Microsoft SQL Server 2016-2022 is installed." test_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.2016.db:tst:100"/>
          </criteria>
        </definition>
      </definitions>
      <tests>
        <independent-def:sqlext_test id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.2016.db:tst:100" version="1" check_existence="at_least_one_exists" check="all" comment="This benchmark is applicable if at least one SQL Server 2016-2022 instance is online.">
          <independent-def:object object_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.2016.db:obj:100"/>
        </independent-def:sqlext_test>
      </tests>
      <objects>
        <independent-def:sqlext_object id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.2016.db:obj:100" version="1">
          <independent-def:behaviors context="instance"/>
          <independent-def:engine>sqlserver</independent-def:engine>
          <independent-def:version>2016|2017|2019</independent-def:version>
          <independent-def:instance operation="pattern match">.*</independent-def:instance>
          <independent-def:database xsi:nil="true"/>
          <independent-def:sql xsi:nil="true"/>
        </independent-def:sqlext_object>
      </objects>
    </oval_definitions>
  </component>
  <component id="scap_navy.navwar.niwcatlantic.scc_comp_U_U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-cpe-dictionary.xml" timestamp="2025-09-16T13:55:38.481217+00:00">
    <cpe-list xmlns="http://cpe.mitre.org/dictionary/2.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://cpe.mitre.org/dictionary/2.0 http://cpe.mitre.org/files/cpe-dictionary_2.2.xsd">
      <cpe-item name="cpe:/a:microsoft:sqlserver:2016">
        <title>SQL Server 2016</title>
        <check system="http://oval.mitre.org/XMLSchema/oval-definitions-5" href="U_MS_SQL_Server_2016_Database_V3R2_STIG_SCAP_1-4_Benchmark-enhancedV7-cpe-oval.xml">oval:navy.navwar.niwcatlantic.scc.ms.sql.server.2016.db:def:100</check>
      </cpe-item>
    </cpe-list>
  </component>
  <component id="scap_navy.navwar.niwcatlantic.scc_comp_U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-oval2.xml" timestamp="2025-09-16T13:55:38.481217+00:00">
    <oval_definitions xmlns="http://oval.mitre.org/XMLSchema/oval-definitions-5" xmlns:oval="http://oval.mitre.org/XMLSchema/oval-common-5" xmlns:oval-def="http://oval.mitre.org/XMLSchema/oval-definitions-5" xmlns:independent-def="http://oval.mitre.org/XMLSchema/oval-definitions-5#independent" xmlns:unix-def="http://oval.mitre.org/XMLSchema/oval-definitions-5#unix" xmlns:linux-def="http://oval.mitre.org/XMLSchema/oval-definitions-5#linux" xmlns:macos-def="http://oval.mitre.org/XMLSchema/oval-definitions-5#macos" xmlns:win-def="http://oval.mitre.org/XMLSchema/oval-definitions-5#windows" xmlns:sol-def="http://oval.mitre.org/XMLSchema/oval-definitions-5#" xsi:schemaLocation="http://oval.mitre.org/XMLSchema/oval-definitions-5 https://raw.githubusercontent.com/OVAL-Community/OVAL/refs/heads/5.12.1_release/oval-schemas/oval-definitions-schema.xsd http://oval.mitre.org/XMLSchema/oval-common-5 https://raw.githubusercontent.com/OVAL-Community/OVAL/refs/heads/5.12.1_release/oval-schemas/oval-common-schema.xsd http://oval.mitre.org/XMLSchema/oval-definitions-5#windows https://raw.githubusercontent.com/OVAL-Community/OVAL/refs/heads/5.12.1_release/oval-schemas/windows-definitions-schema.xsd http://oval.mitre.org/XMLSchema/oval-definitions-5#independent https://raw.githubusercontent.com/OVAL-Community/OVAL/refs/heads/5.12.1_release/oval-schemas/independent-definitions-schema.xsd http://oval.mitre.org/XMLSchema/oval-definitions-5#unix https://raw.githubusercontent.com/OVAL-Community/OVAL/refs/heads/5.12.1_release/oval-schemas/unix-definitions-schema.xsd http://oval.mitre.org/XMLSchema/oval-definitions-5#linux https://raw.githubusercontent.com/OVAL-Community/OVAL/refs/heads/5.12.1_release/oval-schemas/linux-definitions-schema.xsd http://oval.mitre.org/XMLSchema/oval-definitions-5#macos https://raw.githubusercontent.com/OVAL-Community/OVAL/refs/heads/5.12.1_release/oval-schemas/macos-definitions-schema.xsd http://oval.mitre.org/XMLSchema/oval-definitions-5#iosxe https://raw.githubusercontent.com/OVAL-Community/OVAL/refs/heads/5.12.1_release/oval-schemas/iosxe-definitions-schema.xsd http://scap.nist.gov/schema/scap/source/1.2 http://scap.nist.gov/schema/scap/1.4/scap-source-data-stream_1.4.xsd">
      <generator>
        <oval:product_name>NIWC Atlantic - Complete Compliance v2</oval:product_name>
        <oval:schema_version>5.12.1</oval:schema_version>
        <oval:timestamp>2025-09-16T13:55:38.542540+00:00</oval:timestamp>
      </generator>
      <definitions>
        <definition id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:def:213900" version="7" class="compliance">
          <metadata>
            <title>SQL Server databases must integrate with an organization-level authentication/access mechanism providing account management and automation for all users, groups, roles, and any other principals.</title>
            <description/>
          </metadata>
          <criteria operator="OR">
            <criterion test_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:tst:21390001" comment="Contained databases are disabled"/>
            <criteria operator="AND">
              <criterion test_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:tst:21390007" comment="Contained databases are enabled"/>
              <criteria operator="AND">
                <criterion test_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:tst:21390002" comment="'contained database authentication' config_value equals 0"/>
                <criterion test_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:tst:21390003" comment="'contained database authentication' run_value equals 0"/>
              </criteria>
            </criteria>
            <criteria operator="AND">
              <criterion test_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:tst:21390007" comment="Contained databases are enabled"/>
              <criteria operator="OR">
                <criterion test_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:tst:21390008" comment="'contained database authentication' config_value equals 1"/>
                <criterion test_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:tst:21390009" comment="'contained database authentication' run_value equals 1"/>
              </criteria>
              <criterion test_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:tst:21390004" comment="Windows Authentication Mode is enabled"/>
            </criteria>
            <criteria operator="AND">
              <criterion test_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:tst:21390007" comment="Contained databases are enabled"/>
              <criteria operator="OR">
                <criterion test_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:tst:21390008" comment="'contained database authentication' config_value equals 1"/>
                <criterion test_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:tst:21390009" comment="'contained database authentication' run_value equals 1"/>
              </criteria>
              <criterion test_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:tst:21390006" comment="Windows and SQL Server Authentication mode is enabled"/>
              <criterion test_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:tst:21390005" comment="SQL Logins are approved and authorized"/>
            </criteria>
          </criteria>
        </definition>
        <definition id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.2016.db:def:213902" version="7" class="compliance">
          <metadata>
            <title>SQL Server must protect against a user falsely repudiating by ensuring only clearly unique Active Directory user accounts can connect to the database.</title>
            <description>Non-repudiation of actions taken is required in order to maintain data integrity. Examples of particular actions taken by individuals include creating information, sending a message, approving information (e.g., indicating concurrence or signing a contract), and receiving a message. 

Non-repudiation protects against later claims by a user of not having created, modified, or deleted a particular data item or collection of data in the database.

In designing a database, the organization must define the types of data and the user actions that must be protected from repudiation. The implementation must then include building audit features into the application data tables and configuring the DBMS's audit tools to capture the necessary audit trail. Design and implementation also must ensure that applications pass individual user identification to the DBMS, even where the application connects to the DBMS with a standard, shared account.

If the computer account of a remote computer is granted access to a SQL Server database, any service or scheduled task running as NT AUTHORITY\SYSTEM or NT AUTHORITY\NETWORK SERVICE can log into the instance and perform actions. These actions cannot be traced back to a specific user or process.</description>
          </metadata>
          <criteria operator="OR">
            <criterion test_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.2016.db:tst:21390202" comment="Verify that none of the SQL database logins are computer accounts."/>
          </criteria>
        </definition>
        <definition id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:def:213903" version="7" class="compliance">
          <metadata>
            <title>SQL Server must protect against a user falsely repudiating by use of system-versioned tables (Temporal Tables).</title>
            <description>Non-repudiation of actions taken is required in order to maintain data integrity. Examples of particular actions taken by individuals include creating information, sending a message, approving information (e.g., indicating concurrence or signing a contract), and receiving a message.

Non-repudiation protects against later claims by a user of not having created, modified, or deleted a particular data item or collection of data in the database. 

In designing a database, the organization must define the types of data and the user actions that must be protected from repudiation. The implementation must then include building audit features into the application data tables and configuring SQL Server's audit tools to capture the necessary audit trail. Design and implementation also must ensure that applications pass individual user identification to SQL Server, even where the application connects to SQL Server with a standard, shared account. 

Applications should use temporal tables to track the changes and history of sensitive data.</description>
          </metadata>
          <criteria operator="OR">
            <criterion test_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:tst:21390301" comment="End user provided list of authorized and documented temporal tables all exist"/>
            <criterion test_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:tst:21390302" comment="End user specified that no temporal tables are required"/>
          </criteria>
        </definition>
        <definition id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:def:213904" version="7" class="compliance">
          <metadata>
            <title>SQL Server must protect against a user falsely repudiating by ensuring databases are not in a trust relationship.</title>
            <description>Non-repudiation of actions taken is required in order to maintain data integrity. Examples of particular actions taken by individuals include creating information, sending a message, approving information (e.g., indicating concurrence or signing a contract), and receiving a message. 

Non-repudiation protects against later claims by a user of not having created, modified, or deleted a particular data item or collection of data in the database.

SQL Server provides the ability for high privileged accounts to impersonate users in a database using the TRUSTWORTHY feature.&#160;This will allow members of the fixed database role to impersonate any user within the database.&#160;</description>
          </metadata>
          <criteria operator="OR">
            <criterion test_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:tst:21390401" comment="If trustworthy is not enabled, this is not a finding."/>
            <criterion test_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:tst:21390402" comment="If trustworthy is enabled and the database owner is not a privileged account, this is not a finding."/>
            <criterion test_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:tst:21390403" comment="If trustworthy is enabled and the database owner is a privileged account, review the system documentation to determine if the trustworthy property is required and authorized. If this is not documented, this is a finding."/>
          </criteria>
        </definition>
        <definition id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:def:213905" version="7" class="compliance">
          <metadata>
            <title>SQL Server must allow only the ISSM (or individuals or roles appointed by the ISSM) to select which auditable events are to be audited.</title>
            <description>Without the capability to restrict which roles and individuals can select which events are audited, unauthorized personnel may be able to prevent or interfere with the auditing of critical events.

Suppression of auditing could permit an adversary to evade detection.

Misconfigured audits can degrade the system's performance by overwhelming the audit log. Misconfigured audits may also make it more difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.</description>
          </metadata>
          <criteria>
            <criterion test_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:tst:21390501" comment="If any role memberships are not documented and authorized, this is a finding."/>
            <criterion test_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:tst:21390502" comment="If any of the roles or users returned have permissions that are not documented, or the documented audit maintainers do not have permissions, this is a finding."/>
          </criteria>
        </definition>
        <definition id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.2016.db:def:213906" version="7" class="compliance">
          <metadata>
            <title>SQL Server must limit privileges to change software modules, to include stored procedures, functions, and triggers.</title>
            <description>If the system were to allow any user to make changes to software libraries, then those changes might be implemented without undergoing the appropriate testing and approvals that are part of a robust change management process.

Accordingly, only qualified and authorized individuals shall be allowed to obtain access to information system components for purposes of initiating changes, including upgrades and modifications.

Unmanaged changes that occur to the database software libraries or configuration can lead to unauthorized or compromised installations.</description>
          </metadata>
          <criteria operator="OR">
            <criterion test_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.2016.db:tst:21390602" comment="If any users or role permissions returned are not authorized to modify the specified object or type, this is a finding."/>
            <criterion test_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.2016.db:tst:21390603" comment="If any users or role permissions returned are not authorized to modify the specified object or type, this is a finding."/>
          </criteria>
        </definition>
        <definition id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:def:213907" version="7" class="compliance">
          <metadata>
            <title>SQL Server must limit privileges to change software modules, to include stored procedures, functions, and triggers, and links to software external to SQL Server.</title>
            <description>If the system were to allow any user to make changes to software libraries, then those changes might be implemented without undergoing the appropriate testing and approvals that are part of a robust change management process.

Accordingly, only qualified and authorized individuals shall be allowed to obtain access to information system components for purposes of initiating changes, including upgrades and modifications.

Unmanaged changes that occur to the database software libraries or configuration can lead to unauthorized or compromised installations.</description>
          </metadata>
          <criteria>
            <criterion test_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:tst:21390701" comment="If any schema is owned by an unauthorized database principal, this is a finding."/>
          </criteria>
        </definition>
        <definition id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:def:213908" version="7" class="compliance">
          <metadata>
            <title>Database objects (including but not limited to tables, indexes, storage, stored procedures, functions, triggers, links to software external to SQL Server, etc.) must be owned by database/DBMS principals authorized for ownership.</title>
            <description>Within the database, object ownership implies full privileges to the owned object, including the privilege to assign access to the owned objects to other subjects. Database functions and procedures can be coded using definer's rights. This allows anyone who utilizes the object to perform the actions if they were the owner. If not properly managed, this can lead to privileged actions being taken by unauthorized individuals.

Conversely, if critical tables or other objects in SQL Server rely on unauthorized owner accounts, these objects may be lost when an account is removed.</description>
          </metadata>
          <criteria>
            <criterion test_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:tst:21390802" comment="If any of the roles/groups is not authorized, this is a finding."/>
          </criteria>
        </definition>
        <definition id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:def:213909" version="7" class="compliance">
          <metadata>
            <title>The role(s)/group(s) used to modify database structure (including but not necessarily limited to tables, indexes, storage, etc.) and logic modules (stored procedures, functions, triggers, links to software external to SQL Server, etc.) must be restricted to authorized users.</title>
            <description>If SQL Server were to allow any user to make changes to database structure or logic, then those changes might be implemented without undergoing the appropriate testing and approvals that are part of a robust change management process.

Accordingly, only qualified and authorized individuals shall be allowed to obtain access to information system components for purposes of initiating changes, including upgrades and modifications.

Unmanaged changes that occur to the database software libraries or configuration can lead to unauthorized or compromised installations.</description>
          </metadata>
          <criteria>
            <criterion test_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:tst:21390902" comment="If any users or role permissions returned are not authorized to modify the specified object or type, this is a finding."/>
            <criterion test_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:tst:21390903" comment="If any users or role permissions returned are not authorized to modify the specified object or type, this is a finding."/>
          </criteria>
        </definition>
        <definition id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:def:213910" version="7" class="compliance">
          <metadata>
            <title>In the event of a system failure, hardware loss or disk failure, SQL Server must be able to restore necessary databases with least disruption to mission processes.</title>
            <description>Failure to a known state can address safety or security in accordance with the mission/business needs of the organization. Failure to a known secure state helps prevent a loss of confidentiality, integrity, or availability in the event of a failure of the information system or a component of the system. In the event of a system failure, SQL Server must be able to bring the database back to a consistent state.</description>
          </metadata>
          <criteria>
            <criterion test_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:tst:21391001" comment="If the recovery model description does not match the documented recovery model, this is a finding."/>
            <criterion test_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:tst:21391002" comment="If the history indicates a pattern of job failures by missing or gaps in backups, this is a finding."/>
          </criteria>
        </definition>
        <definition id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:def:213911" version="7" class="compliance">
          <metadata>
            <title>The Database Master Key encryption password must meet DOD password complexity requirements. </title>
            <description>Weak passwords may be easily guessed. When passwords are used to encrypt keys used for encryption of sensitive data, then the confidentiality of all data encrypted using that key is at risk.</description>
          </metadata>
          <criteria operator="OR">
            <criterion test_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:tst:21391101" comment="If the value returned is zero, this is not applicable."/>
            <criteria operator="AND">
              <criterion test_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:tst:21391102" comment="If the value returned is greater than zero, a Database Master Key exists and is encrypted with a password."/>
              <criterion test_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:tst:21391103" comment="Verify Windows password policy requirements are set to the DISA STIG requirements"/>
            </criteria>
          </criteria>
        </definition>
        <definition id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:def:213912" version="7" class="compliance">
          <metadata>
            <title>The Database Master Key must be encrypted by the Service Master Key, where a Database Master Key is required and another encryption method has not been specified. </title>
            <description>When not encrypted by the Service Master Key, system administrators or application administrators may access and use the Database Master Key to view sensitive data that they are not authorized to view. Where alternate encryption means are not feasible, encryption by the Service Master Key may be necessary. To help protect sensitive data from unauthorized access by DBAs, mitigations may be in order. Mitigations may include automatic alerts or other audit events when the Database Master Key is accessed outside of the application or by a DBA account.</description>
          </metadata>
          <criteria>
            <criterion test_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:tst:21391202" comment="If databases require encryption, cross check with user provided list of authorized databases from documentation."/>
          </criteria>
        </definition>
        <definition id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:def:213921" version="7" class="compliance">
          <metadata>
            <title>SQL Server must enforce discretionary access control policies, as defined by the data owner, over defined subjects and objects.</title>
            <description>Discretionary Access Control (DAC) is based on the notion that individual users are "owners" of objects and therefore have discretion over who should be authorized to access the object and in which mode (e.g., read or write). Ownership is usually acquired as a consequence of creating the object or via specified ownership assignment. DAC allows the owner to determine who will have access to objects they control. An example of DAC includes user-controlled table permissions.

When discretionary access control policies are implemented, subjects are not constrained with regard to what actions they can take with information for which they have already been granted access. Thus, subjects that have been granted access to information are not prevented from passing (i.e., the subjects have the discretion to pass) the information to other subjects or objects. 

A subject that is constrained in its operation by Mandatory Access Control policies is still able to operate under the less rigorous constraints of this requirement. Thus, while Mandatory Access Control imposes constraints preventing a subject from passing information to another subject operating at a different sensitivity level, this requirement permits the subject to pass the information to any subject at the same sensitivity level. 

The policy is bounded by the information system boundary. Once the information is passed outside of the control of the information system, additional means may be required to ensure the constraints remain in effect. While the older, more traditional definitions of discretionary access control require identity-based access control, that limitation is not required for this use of discretionary access control.</description>
          </metadata>
          <criteria operator="AND">
            <criterion test_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:tst:21392101" comment="Schemas not owned by the schema or dbo, must documented and authorized, otherwise this is a finding."/>
            <criterion test_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:tst:21392102" comment="Objects owned by an individual principal must documented and authorized, otherwise this is a finding."/>
            <criterion test_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:tst:21392103" comment="database users who have been delegated the right to assign additional permission must documented and authorized, otherwise this is a finding."/>
          </criteria>
        </definition>
        <definition id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:def:213922" version="7" class="compliance">
          <metadata>
            <title>Execution of stored procedures and functions that utilize execute as must be restricted to necessary cases only.</title>
            <description>In certain situations, to provide required functionality, a DBMS needs to execute internal logic (stored procedures, functions, triggers, etc.) and/or external code modules with elevated privileges. However, if the privileges required for execution are at a higher level than the privileges assigned to organizational users invoking the functionality applications/programs, those users are indirectly provided with greater privileges than assigned by organizations.

Privilege elevation must be utilized only where necessary and protected from misuse.</description>
          </metadata>
          <criteria>
            <criterion test_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:tst:21392202" comment="If stored procedures that require impersonation are documented and authorized, this is not a finding."/>
          </criteria>
        </definition>
        <definition id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.2016.db:def:213923" version="7" class="compliance">
          <metadata>
            <title>SQL Server must prohibit user installation of logic modules (stored procedures, functions, triggers, views, etc.) without explicit privileged status.</title>
            <description>Allowing regular users to install software, without explicit privileges, creates the risk that untested or potentially malicious software will be installed on the system. Explicit privileges (escalated or administrative privileges) provide the regular user with explicit capabilities and control that exceed the rights of a regular user.

DBMS functionality and the nature and requirements of databases will vary; so while users are not permitted to install unapproved software, there may be instances where the organization allows the user to install approved software packages such as from an approved software repository. The requirements for production servers will be more restrictive than those used for development and research.

SQL Server must enforce software installation by users based upon what types of software installations are permitted (e.g., updates and security patches to existing software) and what types of installations are prohibited (e.g., software whose pedigree with regard to being potentially malicious is unknown or suspect) by the organization. 

In the case of a database management system, this requirement covers stored procedures, functions, triggers, views, etc.</description>
          </metadata>
          <criteria operator="OR">
            <criterion test_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.2016.db:tst:21392302" comment="If users/roles are documented and authorized to perform the installation of logic modules, this is not a finding."/>
            <criterion test_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.2016.db:tst:21392303" comment="If users/roles are documented and authorized to perform the installation of logic modules, this is not a finding."/>
          </criteria>
        </definition>
        <definition id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:def:213924" version="7" class="compliance">
          <metadata>
            <title>SQL Server must enforce access restrictions associated with changes to the configuration of the database(s).</title>
            <description>Failure to provide logical access restrictions associated with changes to configuration may have significant effects on the overall security of the system. 

When dealing with access restrictions pertaining to change control, it should be noted that any changes to the hardware, software, and/or firmware components of the information system can potentially have significant effects on the overall security of the system. 

Accordingly, only qualified and authorized individuals should be allowed to obtain access to system components for the purposes of initiating changes, including upgrades and modifications.</description>
          </metadata>
          <criteria>
            <criterion test_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:tst:21392402" comment="If databases whose owner is a member of a fixed server role are documented and authorized, this is not a finding."/>
          </criteria>
        </definition>
        <definition id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:def:213926" version="7" class="compliance">
          <metadata>
            <title>SQL Server must implement cryptographic mechanisms preventing the unauthorized disclosure of organization-defined information at rest on organization-defined information system components.</title>
            <description>DBMSs handling data requiring "data at rest" protections must employ cryptographic mechanisms to prevent unauthorized disclosure and modification of the information at rest. These cryptographic mechanisms may be native to SQL Server or implemented via additional software or operating system/file system settings, as appropriate to the situation.

Selection of a cryptographic mechanism is based on the need to protect the integrity of organizational information. The strength of the mechanism is commensurate with the security category and/or classification of the information. Organizations have the flexibility to either encrypt all information on storage devices (i.e., full disk encryption) or encrypt specific data structures (e.g., files, records, or fields). 

The decision whether and what to encrypt rests with the data owner and is also influenced by the physical measures taken to secure the equipment and media on which the information resides.</description>
          </metadata>
          <criteria operator="OR">
            <criterion test_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:tst:21392601" comment="If disk full encryption is enabled, this is not a finding."/>
            <criterion test_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:tst:21392602" comment="If the database 'encryption_state' returns 'Encrypted', this is not a finding."/>
            <criterion test_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:tst:21392603" comment="If the database 'encryption_state' matches end user provided status from system documentation, this is not a finding."/>
            <criterion test_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:tst:21392604" comment="Database is not a 'user' database, and is not encryptable, this is not a finding."/>
          </criteria>
        </definition>
        <definition id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:def:251040" version="7" class="compliance">
          <metadata>
            <title>SQL Server must use NSA-approved cryptography to protect classified information in accordance with the data owners requirements.</title>
            <description>Use of weak or untested encryption algorithms undermines the purposes of utilizing encryption to protect data. The application must implement cryptographic modules adhering to the higher standards approved by the federal government since this provides assurance they have been tested and validated.

It is the responsibility of the data owner to assess the cryptography requirements in light of applicable federal laws, Executive Orders, directives, policies, regulations, and standards.

NSA-approved cryptography for classified networks is hardware based. This requirement addresses the compatibility of a DBMS with the encryption devices.</description>
          </metadata>
          <criteria operator="OR">
            <criterion test_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:tst:25104001" comment="If neither classified nor sensitive information exists within SQL Server databases or configuration, this is not a finding."/>
            <criteria operator="AND">
              <criterion test_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:tst:25104002" comment="Verify that Windows is configured to require the use of FIPS-compliant algorithms."/>
              <criterion test_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:tst:25104003" comment="If cryptography is being used by SQL Server, verify that the cryptography is NIST FIPS 140-2 or 140-3 certified"/>
            </criteria>
          </criteria>
        </definition>
      </definitions>
      <tests>
        <independent-def:sqlext_test id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:tst:21390001" version="7" comment="Contained databases are disabled" check="all">
          <independent-def:object object_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:obj:21390001"/>
          <independent-def:state state_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:ste:21390001"/>
        </independent-def:sqlext_test>
        <independent-def:sqlext_test id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:tst:21390002" version="7" comment="'contained database authentication' config_value equals 0" check="all">
          <independent-def:object object_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:obj:21390002"/>
          <independent-def:state state_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:ste:21390002"/>
        </independent-def:sqlext_test>
        <independent-def:sqlext_test id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:tst:21390003" version="7" comment="'contained database authentication' run_value equals 0" check="all">
          <independent-def:object object_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:obj:21390002"/>
          <independent-def:state state_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:ste:21390003"/>
        </independent-def:sqlext_test>
        <independent-def:sqlext_test id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:tst:21390004" version="7" comment="Windows Authentication mode is enabled" check="all">
          <independent-def:object object_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:obj:21390003"/>
          <independent-def:state state_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:ste:21390004"/>
        </independent-def:sqlext_test>
        <independent-def:sqlext_test id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:tst:21390005" version="7" comment="Verify any SQL logins are authorized" check_existence="any_exist" check="all">
          <independent-def:object object_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:obj:21390004"/>
          <independent-def:state state_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:ste:21390005"/>
        </independent-def:sqlext_test>
        <independent-def:sqlext_test id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:tst:21390006" version="7" comment="Windows and SQL Server Authentication mode is enabled" check="all">
          <independent-def:object object_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:obj:21390003"/>
          <independent-def:state state_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:ste:21390006"/>
        </independent-def:sqlext_test>
        <independent-def:sqlext_test id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:tst:21390007" version="7" comment="Contained databases are enabled" check="all">
          <independent-def:object object_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:obj:21390001"/>
          <independent-def:state state_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:ste:21390007"/>
        </independent-def:sqlext_test>
        <independent-def:sqlext_test id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:tst:21390008" version="7" comment="'contained database authentication' config_value equals 1" check="all">
          <independent-def:object object_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:obj:21390002"/>
          <independent-def:state state_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:ste:21390008"/>
        </independent-def:sqlext_test>
        <independent-def:sqlext_test id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:tst:21390009" version="7" comment="'contained database authentication' run_value equals 1" check="all">
          <independent-def:object object_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:obj:21390002"/>
          <independent-def:state state_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:ste:21390009"/>
        </independent-def:sqlext_test>
        <independent-def:shellcommand_test id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.2016.db:tst:21390202" version="7" comment="Verify that none of the SQL logins are computer accounts." check_existence="any_exist" check="all">
          <independent-def:object object_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.2016.db:obj:21390202"/>
          <independent-def:state state_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server:ste:21390201"/>
        </independent-def:shellcommand_test>
        <independent-def:sqlext_test id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:tst:21390301" version="7" comment="End user provided list of authorized and documented temporal tables all exist" check_existence="at_least_one_exists" check="all">
          <independent-def:object object_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:obj:21390301"/>
        </independent-def:sqlext_test>
        <independent-def:variable_test id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:tst:21390302" version="7" check_existence="at_least_one_exists" check="all" comment="End user specified that no temporal tables are required">
          <independent-def:object object_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:obj:21390302"/>
          <independent-def:state state_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:ste:21390301"/>
        </independent-def:variable_test>
        <independent-def:sqlext_test id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:tst:21390401" version="7" comment="If trustworthy is not enabled, this is not a finding." check="all">
          <independent-def:object object_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:obj:21390401"/>
          <independent-def:state state_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:ste:21390401"/>
        </independent-def:sqlext_test>
        <independent-def:sqlext_test id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:tst:21390402" version="7" comment="If trustworthy is enabled and the database owner is not a privileged account, this is not a finding." check="all">
          <independent-def:object object_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:obj:21390401"/>
          <independent-def:state state_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:ste:21390402"/>
        </independent-def:sqlext_test>
        <independent-def:sqlext_test id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:tst:21390403" version="7" comment="If trustworthy is enabled and the database owner is a privileged account, but account is documented/authorized, this is not a finding." check="all">
          <independent-def:object object_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:obj:21390401"/>
          <independent-def:state state_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:ste:21390403"/>
          <independent-def:state state_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:ste:21390404"/>
        </independent-def:sqlext_test>
        <independent-def:sqlext_test id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:tst:21390501" version="7" comment="If any role memberships are not documented and authorized, this is a finding." check_existence="any_exist" check="all">
          <independent-def:object object_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:obj:21390501"/>
          <independent-def:state state_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:ste:21390501"/>
        </independent-def:sqlext_test>
        <independent-def:sqlext_test id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:tst:21390502" version="7" comment="If any of the roles or users returned have permissions that are not documented, or the documented audit maintainers do not have permissions, this is a finding." check_existence="any_exist" check="all">
          <independent-def:object object_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:obj:21390502"/>
          <independent-def:state state_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:ste:21390502"/>
        </independent-def:sqlext_test>
        <independent-def:sqlext_test id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.2016.db:tst:21390602" version="7" comment="If any users or role permissions returned are not authorized to modify the specified object or type, this is a finding." check_existence="any_exist" check="all">
          <independent-def:object object_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.2016.db:obj:21390601"/>
          <independent-def:state state_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.2016.db:ste:21390601"/>
        </independent-def:sqlext_test>
        <independent-def:sqlext_test id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.2016.db:tst:21390603" version="7" comment="If any users or role permissions returned are not authorized to modify the specified object or type, this is a finding." check_existence="any_exist" check="all">
          <independent-def:object object_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.2016.db:obj:21390602"/>
          <independent-def:state state_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.2016.db:ste:21390601"/>
        </independent-def:sqlext_test>
        <independent-def:sqlext_test id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:tst:21390701" version="7" comment="If any schema is owned by an unauthorized database principal, this is a finding." check_existence="at_least_one_exists" check="all">
          <independent-def:object object_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:obj:21390701"/>
          <independent-def:state state_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:ste:21390701"/>
        </independent-def:sqlext_test>
        <independent-def:sqlext_test id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:tst:21390802" version="7" comment="If no roles/groups are documented/authorized, this is not a finding." check_existence="any_exist" check="all">
          <independent-def:object object_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:obj:21390801"/>
          <independent-def:state state_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:ste:21390801"/>
        </independent-def:sqlext_test>
        <independent-def:sqlext_test id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:tst:21390902" version="7" comment="If any users or role permissions returned are not authorized to modify the specified object or type, this is a finding." check_existence="any_exist" check="all">
          <independent-def:object object_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:obj:21390901"/>
          <independent-def:state state_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:ste:21390901"/>
        </independent-def:sqlext_test>
        <independent-def:sqlext_test id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:tst:21390903" version="7" comment="If any users or role permissions returned are not authorized to modify the specified object or type, this is a finding." check_existence="any_exist" check="all">
          <independent-def:object object_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:obj:21390902"/>
          <independent-def:state state_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:ste:21390901"/>
        </independent-def:sqlext_test>
        <independent-def:sqlext_test id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:tst:21391001" version="7" comment="If the recovery model description does not match the documented recovery model, this is a finding." check="all">
          <independent-def:object object_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:obj:21391001"/>
          <independent-def:state state_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:ste:21391001"/>
        </independent-def:sqlext_test>
        <independent-def:sqlext_test id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:tst:21391002" version="7" comment="If the history indicates a pattern of job failures by missing or gaps in backups, this is a finding." check="all">
          <independent-def:object object_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:obj:21391002"/>
        </independent-def:sqlext_test>
        <independent-def:sqlext_test id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:tst:21391101" version="7" comment="If the value returned is zero, this is not applicable." check="all">
          <independent-def:object object_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:obj:21391101"/>
          <independent-def:state state_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:ste:21391101"/>
        </independent-def:sqlext_test>
        <independent-def:sqlext_test id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:tst:21391102" version="7" comment="If the value returned is greater than zero, a Database Master Key exists and is encrypted with a password." check="all">
          <independent-def:object object_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:obj:21391101"/>
          <independent-def:state state_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:ste:21391102"/>
        </independent-def:sqlext_test>
        <win-def:passwordpolicy_test id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:tst:21391103" version="7" comment="Ensure the DISA Windows Password Policy is set on the SQL Server member server." check_existence="at_least_one_exists" check="all">
          <win-def:object object_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:obj:21391103"/>
          <win-def:state state_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:ste:21391103"/>
          <win-def:state state_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:ste:21391104"/>
        </win-def:passwordpolicy_test>
        <independent-def:sqlext_test id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:tst:21391202" version="7" comment="If databases require encryption, cross check with user provided list of authorized databases from documentation." check_existence="any_exist" check="all">
          <independent-def:object object_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:obj:21391201"/>
          <independent-def:state state_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:ste:21391201"/>
        </independent-def:sqlext_test>
        <independent-def:sqlext_test id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:tst:21392101" version="7" comment="Schemas not owned by the schema or dbo must be documented and approved, otherwise this is a finding." check_existence="any_exist" check="all">
          <independent-def:object object_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:obj:21392101"/>
          <independent-def:state state_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:ste:21392101"/>
        </independent-def:sqlext_test>
        <independent-def:sqlext_test id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:tst:21392102" version="7" comment="Objects owned by an individual principal must be documented and approved, otherwise this is a finding." check_existence="any_exist" check="all">
          <independent-def:object object_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:obj:21392102"/>
          <independent-def:state state_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:ste:21392101"/>
        </independent-def:sqlext_test>
        <independent-def:sqlext_test id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:tst:21392103" version="7" comment="database users who have been delegated the right to assign additional permissions must be documented and approved, otherwise this is a finding." check_existence="any_exist" check="all">
          <independent-def:object object_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:obj:21392103"/>
          <independent-def:state state_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:ste:21392101"/>
        </independent-def:sqlext_test>
        <independent-def:sqlext_test id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:tst:21392202" version="7" comment="If any procedures or functions are returned that are not documented, this is a finding." check_existence="any_exist" check="all">
          <independent-def:object object_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:obj:21392201"/>
          <independent-def:state state_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:ste:21392201"/>
        </independent-def:sqlext_test>
        <independent-def:sqlext_test id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.2016.db:tst:21392302" version="7" comment="If any users or role permissions returned are not authorized to perform the installation of logic modules (stored procedures, functions, triggers, views, etc.), this is a finding." check_existence="any_exist" check="all">
          <independent-def:object object_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.2016.db:obj:21392301"/>
          <independent-def:state state_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.2016.db:ste:21392301"/>
        </independent-def:sqlext_test>
        <independent-def:sqlext_test id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.2016.db:tst:21392303" version="7" comment="If any users or role permissions returned are not authorized to perform the installation of logic modules (stored procedures, functions, triggers, views, etc.), this is a finding." check_existence="any_exist" check="all">
          <independent-def:object object_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.2016.db:obj:21392302"/>
          <independent-def:state state_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.2016.db:ste:21392301"/>
        </independent-def:sqlext_test>
        <independent-def:sqlext_test id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:tst:21392402" version="7" comment="If databases whose owner is a member of a fixed server role are documented and authorized, this is not a finding." check_existence="any_exist" check="all">
          <independent-def:object object_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:obj:21392401"/>
          <independent-def:state state_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:ste:21392401"/>
        </independent-def:sqlext_test>
        <win-def:wmi57_test id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:tst:21392601" version="7" comment="BitLocker must be enabled on all fixed drives." check_existence="all_exist" check="all">
          <win-def:object object_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:obj:21392601"/>
          <win-def:state state_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:ste:21392601"/>
        </win-def:wmi57_test>
        <independent-def:sqlext_test id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:tst:21392602" version="7" comment="If the user database 'encryption_state' returns 'Encrypted', this is not a finding." check_existence="any_exist" check="all">
          <independent-def:object object_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:obj:21392602"/>
          <independent-def:state state_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:ste:21392602"/>
        </independent-def:sqlext_test>
        <independent-def:sqlext_test id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:tst:21392603" version="7" comment="If the user database 'encryption_state' matches end user provided documentation', this is not a finding." check_existence="any_exist" check="all">
          <independent-def:object object_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:obj:21392602"/>
          <independent-def:state state_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:ste:21392603"/>
        </independent-def:sqlext_test>
        <independent-def:sqlext_test id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:tst:21392604" version="7" comment="Database is not a 'user' database, and is not encryptable, this is not a finding." check_existence="any_exist" check="all">
          <independent-def:object object_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:obj:21392604"/>
        </independent-def:sqlext_test>
        <independent-def:variable_test id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:tst:25104001" version="7" comment="Review system documentation to determine whether cryptography for classified or sensitive information is required by the information owner." check_existence="at_least_one_exists" check="all">
          <independent-def:object object_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:obj:25104001"/>
          <independent-def:state state_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:ste:25104001"/>
        </independent-def:variable_test>
        <win-def:registry_test id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:tst:25104002" version="7" comment="Check if 'FIPS compliant algorithms for encryption, hashing, and signing' is enabled." check="all">
          <win-def:object object_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:obj:25104002"/>
          <win-def:state state_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:ste:25104002"/>
        </win-def:registry_test>
        <independent-def:sqlext_test id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:tst:25104003" version="7" comment="Verify that user databases cryptography is NIST FIPS 140-2 or 140-3 certified" check_existence="at_least_one_exists" check="all">
          <independent-def:object object_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:obj:25104003"/>
          <independent-def:state state_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:ste:25104003"/>
        </independent-def:sqlext_test>
      </tests>
      <objects>
        <independent-def:sqlext_object id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:obj:21390001" version="7">
          <independent-def:behaviors context="database"/>
          <independent-def:engine var_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:21390001"/>
          <independent-def:version operation="pattern match" var_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:21390002"/>
          <independent-def:instance operation="pattern match">.*</independent-def:instance>
          <independent-def:database operation="pattern match">.*</independent-def:database>
          <independent-def:sql>select containment,name from sys.databases WHERE name = DB_NAME()</independent-def:sql>
        </independent-def:sqlext_object>
        <independent-def:sqlext_object id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:obj:21390002" version="7">
          <independent-def:behaviors context="instance"/>
          <independent-def:engine var_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:21390001"/>
          <independent-def:version operation="pattern match" var_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:21390002"/>
          <independent-def:instance operation="pattern match">.*</independent-def:instance>
          <independent-def:database xsi:nil="true"/>
          <independent-def:sql>EXEC sp_configure 'contained database authentication'</independent-def:sql>
        </independent-def:sqlext_object>
        <independent-def:sqlext_object id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:obj:21390003" version="7">
          <independent-def:behaviors context="instance"/>
          <independent-def:engine var_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:21390001"/>
          <independent-def:version operation="pattern match" var_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:21390002"/>
          <independent-def:instance operation="pattern match">.*</independent-def:instance>
          <independent-def:database xsi:nil="true"/>
          <independent-def:sql>SELECT CASE SERVERPROPERTY('IsIntegratedSecurityOnly')   
WHEN 1 THEN 'Windows Authentication'   
WHEN 0 THEN 'Windows and SQL Server Authentication'   
END as [mode]</independent-def:sql>
        </independent-def:sqlext_object>
        <independent-def:sqlext_object id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:obj:21390004" version="7">
          <independent-def:behaviors context="database"/>
          <independent-def:engine var_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:21390001"/>
          <independent-def:version operation="pattern match" var_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:21390002"/>
          <independent-def:instance operation="pattern match">.*</independent-def:instance>
          <independent-def:database operation="pattern match">.*</independent-def:database>
          <independent-def:sql>SELECT name as user_name
FROM sys.database_principals
WHERE type_desc = 'SQL_USER'
AND authentication_type_desc = 'DATABASE';</independent-def:sql>
        </independent-def:sqlext_object>
        <independent-def:sqlext_object id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.2016.db:obj:21390201" version="7">
          <independent-def:behaviors context="database"/>
          <independent-def:engine>sqlserver</independent-def:engine>
          <independent-def:version operation="pattern match">.*</independent-def:version>
          <independent-def:instance operation="pattern match">.*</independent-def:instance>
          <independent-def:database operation="pattern match">.*</independent-def:database>
          <independent-def:sql>SELECT name
FROM sys.database_principals
WHERE type in ('U','G')
AND name LIKE '%$'</independent-def:sql>
        </independent-def:sqlext_object>
        <independent-def:shellcommand_object id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.2016.db:obj:21390202" version="7" comment="Check to see if any logins are computer accounts">
          <independent-def:shell>powershell</independent-def:shell>
          <independent-def:command var_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.2016.db:var:21390203"/>
          <independent-def:pattern>^(?!$|----|Path Properties).*</independent-def:pattern>
        </independent-def:shellcommand_object>
        <independent-def:sqlext_object id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:obj:21390301" version="7">
          <independent-def:behaviors context="database"/>
          <independent-def:engine var_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:21390301"/>
          <independent-def:version operation="pattern match" var_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:21390302"/>
          <independent-def:instance operation="pattern match">.*</independent-def:instance>
          <independent-def:database operation="pattern match">.*</independent-def:database>
          <independent-def:sql var_ref="oval:navy.navwar.niwcatlantic.scc.windows:var:21390304"/>
        </independent-def:sqlext_object>
        <independent-def:variable_object id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:obj:21390302" version="7" comment="End user provided list of authorized and documented temporal tables or NONE_REQUIRED">
          <independent-def:var_ref>oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:21390303</independent-def:var_ref>
        </independent-def:variable_object>
        <independent-def:sqlext_object id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:obj:21390401" version="7">
          <independent-def:behaviors context="database"/>
          <independent-def:engine var_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:21390401"/>
          <independent-def:version operation="pattern match" var_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:21390402"/>
          <independent-def:instance operation="pattern match">.*</independent-def:instance>
          <independent-def:database operation="pattern match">^(?!msdb$|MSDB$).*</independent-def:database>
          <independent-def:sql>SELECT SUSER_SNAME(d.owner_sid) AS database_owner,
CASE
WHEN d.is_trustworthy_on = 0 THEN 'No'
WHEN d.is_trustworthy_on = 1 THEN 'Yes'
END AS is_trustworthy,
CASE
WHEN role.name IN ('sysadmin','securityadmin')
OR permission.permission_name = 'CONTROL SERVER'
THEN 'YES'
ELSE 'No'
END AS 'is_owner_privileged'
FROM sys.databases d
LEFT JOIN sys.server_principals login ON d.owner_sid = login.sid
LEFT JOIN sys.server_role_members rm ON login.principal_id = rm.member_principal_id
LEFT JOIN sys.server_principals role ON rm.role_principal_id = role.principal_id
LEFT JOIN sys.server_permissions permission ON login.principal_id = permission.grantee_principal_id
WHERE d.name = DB_NAME()</independent-def:sql>
        </independent-def:sqlext_object>
        <independent-def:sqlext_object id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:obj:21390501" version="7">
          <independent-def:behaviors context="database"/>
          <independent-def:engine var_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:21390501"/>
          <independent-def:version operation="pattern match" var_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:21390502"/>
          <independent-def:instance operation="pattern match">.*</independent-def:instance>
          <independent-def:database operation="pattern match">.*</independent-def:database>
          <independent-def:sql>SELECT
    R.name AS role_name,
    RM.name AS role_member_name,
    RM.type_desc
FROM sys.database_principals R
JOIN sys.database_role_members DRM ON 
    R.principal_id = DRM.role_principal_id
JOIN sys.database_principals RM ON 
    DRM.member_principal_id = RM.principal_id
WHERE R.type = 'R'
    AND R.name = 'db_owner'
ORDER BY 
    role_member_name</independent-def:sql>
        </independent-def:sqlext_object>
        <independent-def:sqlext_object id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:obj:21390502" version="7">
          <independent-def:behaviors context="database"/>
          <independent-def:engine var_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:21390501"/>
          <independent-def:version operation="pattern match" var_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:21390502"/>
          <independent-def:instance operation="pattern match">.*</independent-def:instance>
          <independent-def:database operation="pattern match">.*</independent-def:database>
          <independent-def:sql>SELECT
	PERM.permission_name,
	DP.name AS user_name,
	DP.type_desc AS principal_type,
	DBRM.role_member_name
FROM sys.database_permissions PERM
JOIN sys.database_principals DP ON PERM.grantee_principal_id = DP.principal_id
LEFT OUTER JOIN (
	SELECT
		R.principal_id AS role_principal_id,
		R.name AS role_name,
		RM.name AS role_member_name
	FROM sys.database_principals R
	JOIN sys.database_role_members DRM ON R.principal_id = DRM.role_principal_id
	JOIN sys.database_principals RM ON DRM.member_principal_id = RM.principal_id
	WHERE R.type = 'R'
) DBRM ON DP.principal_id = DBRM.role_principal_id
WHERE PERM.permission_name IN ('CONTROL','ALTER ANY DATABASE AUDIT')
ORDER BY
	permission_name, 
	user_name, 
	role_member_name</independent-def:sql>
        </independent-def:sqlext_object>
        <independent-def:sqlext_object id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.2016.db:obj:21390601" version="7">
          <independent-def:behaviors context="database"/>
          <independent-def:engine var_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.2016.db:var:21390601"/>
          <independent-def:version operation="pattern match" var_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.2016.db:var:21390602"/>
          <independent-def:instance operation="pattern match">.*</independent-def:instance>
          <independent-def:database operation="pattern match">.*</independent-def:database>
          <independent-def:sql>SELECT P.type_desc AS principal_type, P.name AS user_name, O.type_desc,
  CASE class
   WHEN 0 THEN DB_NAME()
   WHEN 1 THEN OBJECT_SCHEMA_NAME(major_id) + '.' + OBJECT_NAME(major_id)
   WHEN 3 THEN SCHEMA_NAME(major_id)
    ELSE class_desc + '(' + CAST(major_id AS nvarchar) + ')'
   END AS securable_name, DP.state_desc, DP.permission_name
FROM sys.database_permissions DP
JOIN sys.database_principals P ON DP.grantee_principal_id = P.principal_id
LEFT OUTER JOIN sys.all_objects O ON O.object_id = DP.major_id AND O.type IN ('TR','TA','P','X','RF','PC','IF','FN','TF','U')
WHERE DP.type IN ('AL','ALTG') AND DP.class IN (0, 1, 53)</independent-def:sql>
        </independent-def:sqlext_object>
        <independent-def:sqlext_object id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.2016.db:obj:21390602" version="7">
          <independent-def:behaviors context="database"/>
          <independent-def:engine var_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.2016.db:var:21390601"/>
          <independent-def:version operation="pattern match" var_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.2016.db:var:21390602"/>
          <independent-def:instance operation="pattern match">.*</independent-def:instance>
          <independent-def:database operation="pattern match">.*</independent-def:database>
          <independent-def:sql>SELECT R.name AS role_name, M.type_desc AS principal_type, M.name AS user_name
FROM sys.database_principals R
JOIN sys.database_role_members DRM ON R.principal_id = DRM.role_principal_id
JOIN sys.database_principals M ON DRM.member_principal_id = M.principal_id
WHERE R.name IN ('db_ddladmin','db_owner')
   AND M.name != 'dbo'</independent-def:sql>
        </independent-def:sqlext_object>
        <independent-def:sqlext_object id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:obj:21390701" version="7">
          <independent-def:behaviors context="database"/>
          <independent-def:engine var_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:21390701"/>
          <independent-def:version operation="pattern match" var_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:21390702"/>
          <independent-def:instance operation="pattern match">.*</independent-def:instance>
          <independent-def:database operation="pattern match">.*</independent-def:database>
          <independent-def:sql>SELECT CONCAT(s.name,':',p.name) as schema_to_owner
FROM sys.schemas S
JOIN sys.database_principals P ON S.principal_id = P.principal_id
ORDER BY schema_to_owner</independent-def:sql>
        </independent-def:sqlext_object>
        <independent-def:sqlext_object id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:obj:21390801" version="7">
          <independent-def:behaviors context="database"/>
          <independent-def:engine var_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:21390801"/>
          <independent-def:version operation="pattern match" var_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:21390802"/>
          <independent-def:instance operation="pattern match">.*</independent-def:instance>
          <independent-def:database operation="pattern match">.*</independent-def:database>
          <independent-def:sql>;with objects_cte as
(SELECT o.name, o.type_desc,
   CASE
    WHEN o.principal_id is null then s.principal_id
     ELSE o.principal_id
    END as principal_id
 FROM sys.objects o
 INNER JOIN sys.schemas s
 ON o.schema_id = s.schema_id
 WHERE o.is_ms_shipped = 0
)
SELECT cte.name, cte.type_desc, dp.name as object_owner 
FROM objects_cte cte
INNER JOIN sys.database_principals dp
ON cte.principal_id = dp.principal_id
ORDER BY dp.name, cte.name</independent-def:sql>
        </independent-def:sqlext_object>
        <independent-def:sqlext_object id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:obj:21390901" version="7">
          <independent-def:behaviors context="database"/>
          <independent-def:engine var_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:21390901"/>
          <independent-def:version operation="pattern match" var_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:21390902"/>
          <independent-def:instance operation="pattern match">.*</independent-def:instance>
          <independent-def:database operation="pattern match">.*</independent-def:database>
          <independent-def:sql>SELECT P.type_desc AS principal_type, P.name AS user_name, O.type_desc,
  CASE class
   WHEN 0 THEN DB_NAME()
   WHEN 1 THEN OBJECT_SCHEMA_NAME(major_id) + '.' + OBJECT_NAME(major_id)
   WHEN 3 THEN SCHEMA_NAME(major_id)
    ELSE class_desc + '(' + CAST(major_id AS nvarchar) + ')'
   END AS securable_name, DP.state_desc, DP.permission_name
FROM sys.database_permissions DP
JOIN sys.database_principals P ON DP.grantee_principal_id = P.principal_id
LEFT OUTER JOIN sys.all_objects O ON O.object_id = DP.major_id AND O.type IN ('TR','TA','P','X','RF','PC','IF','FN','TF','U')
WHERE DP.type IN ('AL','ALTG') AND DP.class IN (0, 1, 53)</independent-def:sql>
        </independent-def:sqlext_object>
        <independent-def:sqlext_object id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:obj:21390902" version="7">
          <independent-def:behaviors context="database"/>
          <independent-def:engine var_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:21390901"/>
          <independent-def:version operation="pattern match" var_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:21390902"/>
          <independent-def:instance operation="pattern match">.*</independent-def:instance>
          <independent-def:database operation="pattern match">.*</independent-def:database>
          <independent-def:sql>SELECT R.name AS role_name, M.type_desc AS principal_type, M.name AS user_name
FROM sys.database_principals R
JOIN sys.database_role_members DRM ON R.principal_id = DRM.role_principal_id
JOIN sys.database_principals M ON DRM.member_principal_id = M.principal_id
WHERE R.name IN ('db_ddladmin','db_owner')
   AND M.name != 'dbo'</independent-def:sql>
        </independent-def:sqlext_object>
        <independent-def:sqlext_object id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:obj:21391001" version="7" comment="Collect recovery model desc on all database except tempdb">
          <independent-def:behaviors context="database"/>
          <independent-def:engine var_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:21391001"/>
          <independent-def:version operation="pattern match" var_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:21391002"/>
          <independent-def:instance operation="pattern match">.*</independent-def:instance>
          <independent-def:database operation="pattern match">^(?!tempdb$).*</independent-def:database>
          <independent-def:sql>SELECT name, recovery_model_desc
FROM sys.databases
WHERE name = DB_NAME()
ORDER BY name</independent-def:sql>
        </independent-def:sqlext_object>
        <independent-def:sqlext_object id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:obj:21391002" version="7" comment="Collect backup information on all databases except tempdb">
          <independent-def:behaviors context="database"/>
          <independent-def:engine var_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:21391001"/>
          <independent-def:version operation="pattern match" var_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:21391002"/>
          <independent-def:instance operation="pattern match">.*</independent-def:instance>
          <independent-def:database operation="pattern match">^(?!tempdb$).*</independent-def:database>
          <independent-def:sql>SELECT database_name,
   CASE type
    WHEN 'D' THEN 'Full'
    WHEN 'I' THEN 'Differential'
    WHEN 'L' THEN 'Log'
   ELSE type
   END AS backup_type,
 is_copy_only,
 backup_start_date, backup_finish_date
FROM msdb.dbo.backupset
WHERE backup_start_date &gt;= dateadd(day, - 30, getdate()) 
AND database_name = DB_NAME()
ORDER BY database_name, backup_start_date DESC
</independent-def:sql>
        </independent-def:sqlext_object>
        <independent-def:sqlext_object id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:obj:21391101" version="7">
          <independent-def:behaviors context="database"/>
          <independent-def:engine var_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:21391101"/>
          <independent-def:version operation="pattern match" var_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:21391102"/>
          <independent-def:instance operation="pattern match">.*</independent-def:instance>
          <independent-def:database operation="pattern match">.*</independent-def:database>
          <independent-def:sql>SELECT COUNT(name) as count
FROM sys.symmetric_keys s, sys.key_encryptions k 
WHERE s.name = '##MS_DatabaseMasterKey##' 
AND s.symmetric_key_id = k.key_id 
AND k.crypt_type in ('ESKP', 'ESP2', 'ESP3')</independent-def:sql>
        </independent-def:sqlext_object>
        <win-def:passwordpolicy_object id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:obj:21391103" version="7" comment="Retrieves a passwordpolicy_object."/>
        <independent-def:sqlext_object id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:obj:21391201" version="7">
          <independent-def:behaviors context="instance"/>
          <independent-def:engine var_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:21391201"/>
          <independent-def:version operation="pattern match" var_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:21391202"/>
          <independent-def:instance operation="pattern match">.*</independent-def:instance>
          <independent-def:database xsi:nil="true"/>
          <independent-def:sql>SELECT name as database_name 
FROM [master].sys.databases 
WHERE is_master_key_encrypted_by_server = 1 
AND owner_sid != 1 
AND state = 0;</independent-def:sql>
        </independent-def:sqlext_object>
        <independent-def:sqlext_object id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:obj:21392101" version="7">
          <independent-def:behaviors context="database"/>
          <independent-def:engine var_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:21392101"/>
          <independent-def:version operation="pattern match" var_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:21392102"/>
          <independent-def:instance operation="pattern match">.*</independent-def:instance>
          <independent-def:database operation="pattern match">.*</independent-def:database>
          <independent-def:sql>SELECT name AS schema_name, USER_NAME(principal_id) AS user_name
FROM sys.schemas
WHERE schema_id != principal_id
 AND principal_id != 1</independent-def:sql>
        </independent-def:sqlext_object>
        <independent-def:sqlext_object id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:obj:21392102" version="7">
          <independent-def:behaviors context="database"/>
          <independent-def:engine var_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:21392101"/>
          <independent-def:version operation="pattern match" var_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:21392102"/>
          <independent-def:instance operation="pattern match">.*</independent-def:instance>
          <independent-def:database operation="pattern match">.*</independent-def:database>
          <independent-def:sql>SELECT object_id, name AS securable, 
  USER_NAME(principal_id) AS user_name,
  type_desc
FROM sys.objects
WHERE is_ms_shipped = 0 AND principal_id IS NOT NULL
ORDER BY type_desc, securable, user_name</independent-def:sql>
        </independent-def:sqlext_object>
        <independent-def:sqlext_object id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:obj:21392103" version="7">
          <independent-def:behaviors context="database"/>
          <independent-def:engine var_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:21392101"/>
          <independent-def:version operation="pattern match" var_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:21392102"/>
          <independent-def:instance operation="pattern match">.*</independent-def:instance>
          <independent-def:database operation="pattern match">.*</independent-def:database>
          <independent-def:sql>SELECT U.type_desc, U.name AS user_name,
 DP.class_desc AS securable_type,
   CASE DP.class
    WHEN 0 THEN DB_NAME()
    WHEN 1 THEN OBJECT_NAME(DP.major_id) 
    WHEN 3 THEN SCHEMA_NAME(DP.major_id)
   ELSE CAST(DP.major_id AS nvarchar)
   END AS securable,
       permission_name, state_desc
FROM sys.database_permissions DP
JOIN sys.database_principals U ON DP.grantee_principal_id = U.principal_id
WHERE DP.state = 'W'
ORDER BY user_name, securable_type, securable</independent-def:sql>
        </independent-def:sqlext_object>
        <independent-def:sqlext_object id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:obj:21392201" version="7">
          <independent-def:behaviors context="database"/>
          <independent-def:engine var_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:21392201"/>
          <independent-def:version operation="pattern match" var_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:21392202"/>
          <independent-def:instance operation="pattern match">.*</independent-def:instance>
          <independent-def:database operation="pattern match">.*</independent-def:database>
          <independent-def:sql>SELECT S.name AS schema_name, O.name AS module_name,
USER_NAME(
CASE M.execute_as_principal_id
WHEN -2 THEN COALESCE(O.principal_id, S.principal_id)
ELSE M.execute_as_principal_id
END
) AS execute_as
FROM sys.sql_modules M
JOIN sys.objects O ON M.object_id = O.object_id
JOIN sys.schemas S ON O.schema_id = S.schema_id
WHERE execute_as_principal_id IS NOT NULL
and       o.name not in 
(             
'fn_sysdac_get_username',
                             'fn_sysutility_ucp_get_instance_is_mi',
                             'sp_send_dbmail',
                             'sp_SendMailMessage',
                             'sp_syscollector_create_collection_set',
                             'sp_syscollector_delete_collection_set',
                             'sp_syscollector_disable_collector',
                             'sp_syscollector_enable_collector',
                             'sp_syscollector_get_collection_set_execution_status',
                             'sp_syscollector_run_collection_set',
                             'sp_syscollector_start_collection_set',
                             'sp_syscollector_update_collection_set',
                             'sp_syscollector_upload_collection_set',
                             'sp_syscollector_verify_collector_state',
                             'sp_syspolicy_add_policy',
                             'sp_syspolicy_add_policy_category_subscription',
                             'sp_syspolicy_delete_policy',
                             'sp_syspolicy_delete_policy_category_subscription',
                             'sp_syspolicy_update_policy',
                             'sp_sysutility_mi_add_ucp_registration',
                             'sp_sysutility_mi_disable_collection',
                             'sp_sysutility_mi_enroll',
                             'sp_sysutility_mi_initialize_collection',
                             'sp_sysutility_mi_remove',
                             'sp_sysutility_mi_remove_ucp_registration',
                             'sp_sysutility_mi_upload',
                             'sp_sysutility_mi_validate_enrollment_preconditions',
                             'sp_sysutility_ucp_add_mi',
                             'sp_sysutility_ucp_add_policy',
                             'sp_sysutility_ucp_calculate_aggregated_dac_health',
                             'sp_sysutility_ucp_calculate_aggregated_mi_health',
                             'sp_sysutility_ucp_calculate_computer_health',
                             'sp_sysutility_ucp_calculate_dac_file_space_health',
                             'sp_sysutility_ucp_calculate_dac_health',
                            'sp_sysutility_ucp_calculate_filegroups_with_policy_violations',
                             'sp_sysutility_ucp_calculate_health',
                             'sp_sysutility_ucp_calculate_mi_file_space_health',
                             'sp_sysutility_ucp_calculate_mi_health',
                             'sp_sysutility_ucp_configure_policies',
                             'sp_sysutility_ucp_create',
                             'sp_sysutility_ucp_delete_policy',
                             'sp_sysutility_ucp_delete_policy_history',
                             'sp_sysutility_ucp_get_policy_violations',
                             'sp_sysutility_ucp_initialize',
                             'sp_sysutility_ucp_initialize_mdw',
                             'sp_sysutility_ucp_remove_mi',
                             'sp_sysutility_ucp_update_policy',
                             'sp_sysutility_ucp_update_utility_configuration',
                             'sp_sysutility_ucp_validate_prerequisites',
                             'sp_validate_user',
                             'syscollector_collection_set_is_running_update_trigger',
                             'sysmail_help_status_sp'
)

ORDER BY schema_name, module_name</independent-def:sql>
        </independent-def:sqlext_object>
        <independent-def:sqlext_object id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.2016.db:obj:21392301" version="7">
          <independent-def:behaviors context="database"/>
          <independent-def:engine var_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.2016.db:var:21392301"/>
          <independent-def:version operation="pattern match" var_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.2016.db:var:21392302"/>
          <independent-def:instance operation="pattern match">.*</independent-def:instance>
          <independent-def:database operation="pattern match">.*</independent-def:database>
          <independent-def:sql>SELECT P.type_desc AS principal_type, P.name AS user_name, O.type_desc,
  CASE class
   WHEN 0 THEN DB_NAME()
   WHEN 1 THEN OBJECT_SCHEMA_NAME(major_id) + '.' + OBJECT_NAME(major_id)
   WHEN 3 THEN SCHEMA_NAME(major_id)
    ELSE class_desc + '(' + CAST(major_id AS nvarchar) + ')'
   END AS securable_name, DP.state_desc, DP.permission_name
FROM sys.database_permissions DP
JOIN sys.database_principals P ON DP.grantee_principal_id = P.principal_id
LEFT OUTER JOIN sys.all_objects O ON O.object_id = DP.major_id AND O.type IN ('TR','TA','P','X','RF','PC','IF','FN','TF','U')
WHERE DP.type IN ('AL','ALTG') AND DP.class IN (0, 1, 53)</independent-def:sql>
        </independent-def:sqlext_object>
        <independent-def:sqlext_object id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.2016.db:obj:21392302" version="7">
          <independent-def:behaviors context="database"/>
          <independent-def:engine var_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.2016.db:var:21392301"/>
          <independent-def:version operation="pattern match" var_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.2016.db:var:21392302"/>
          <independent-def:instance operation="pattern match">.*</independent-def:instance>
          <independent-def:database operation="pattern match">.*</independent-def:database>
          <independent-def:sql>SELECT R.name AS role_name, M.type_desc AS principal_type, M.name AS user_name
FROM sys.database_principals R
JOIN sys.database_role_members DRM ON R.principal_id = DRM.role_principal_id
JOIN sys.database_principals M ON DRM.member_principal_id = M.principal_id
WHERE R.name IN ('db_ddladmin','db_owner')
   AND M.name != 'dbo'</independent-def:sql>
        </independent-def:sqlext_object>
        <independent-def:sqlext_object id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:obj:21392401" version="7">
          <independent-def:behaviors context="database"/>
          <independent-def:engine var_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:21392401"/>
          <independent-def:version operation="pattern match" var_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:21392402"/>
          <independent-def:instance operation="pattern match">.*</independent-def:instance>
          <independent-def:database operation="pattern match">.*</independent-def:database>
          <independent-def:sql>SELECT 
              D.name AS database_name, SUSER_SNAME(D.owner_sid) AS owner_name,
              FRM.is_fixed_role_member
FROM sys.databases D
OUTER APPLY (
              SELECT MAX(fixed_role_member) AS is_fixed_role_member
              FROM (
                            SELECT IS_SRVROLEMEMBER(R.name, SUSER_SNAME(D.owner_sid)) AS fixed_role_member
                            FROM sys.server_principals R
                            WHERE is_fixed_role = 1
              ) A
) FRM
WHERE D.database_id &gt; 4
              AND (FRM.is_fixed_role_member = 1 
                            OR FRM.is_fixed_role_member IS NULL)
ORDER BY database_name</independent-def:sql>
        </independent-def:sqlext_object>
        <win-def:wmi57_object id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:obj:21392601" version="7" comment="BitLocker status">
          <win-def:namespace datatype="string">root\cimv2\security\microsoftvolumeencryption</win-def:namespace>
          <win-def:wql datatype="string">SELECT protectionstatus FROM win32_encryptablevolume</win-def:wql>
        </win-def:wmi57_object>
        <independent-def:sqlext_object id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:obj:21392602" version="7" comment="Collect encrypt status on all 'user' databases, excluding unencryptable system databases">
          <independent-def:behaviors context="database"/>
          <independent-def:engine var_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:21392601"/>
          <independent-def:version operation="pattern match" var_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:21392602"/>
          <independent-def:instance operation="pattern match">.*</independent-def:instance>
          <independent-def:database operation="pattern match">^(?!(?:master|model|msdb|tempdb)$).*$</independent-def:database>
          <independent-def:sql>SELECT
db.name AS [database_name], db.is_encrypted,  CASE dm.encryption_state
WHEN 0 THEN 'NoDatabaseEncryptionKey' 
WHEN 1 THEN 'Unencrypted' 
WHEN 2 THEN 'Encryption in progress' 
WHEN 3 THEN 'Encrypted' 
WHEN 4 THEN 'Key change in progress' 
WHEN 5 THEN 'Decryption in progress' 
WHEN 6 THEN 'Protection change in progress' 
ELSE 'NoDatabaseEncryptionKey'
END AS [encryption_state]
FROM
    sys.databases db
    LEFT OUTER JOIN sys.dm_database_encryption_keys dm
        ON db.database_id = dm.database_id
WHERE db.name = DB_NAME();</independent-def:sql>
        </independent-def:sqlext_object>
        <independent-def:sqlext_object id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:obj:21392604" version="7" comment="databse is master, model, msdb or tempdb">
          <independent-def:behaviors context="database"/>
          <independent-def:engine>sqlserver</independent-def:engine>
          <independent-def:version>2016|2017|2019|2022</independent-def:version>
          <independent-def:instance operation="pattern match">.*</independent-def:instance>
          <independent-def:database operation="pattern match">^(master|model|msdb|tempdb)$</independent-def:database>
          <independent-def:sql xsi:nil="true"/>
        </independent-def:sqlext_object>
        <independent-def:variable_object id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:obj:25104001" version="7" comment="Variable object answer on if to determine whether cryptography for classified or sensitive information is required by the information owner">
          <independent-def:var_ref>oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:25104001</independent-def:var_ref>
        </independent-def:variable_object>
        <win-def:registry_object id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:obj:25104002" version="7" comment="Determine via the registry that FIPS is enabled in the Local security policy">
          <win-def:hive>HKEY_LOCAL_MACHINE</win-def:hive>
          <win-def:key>SYSTEM\CurrentControlSet\Control\Lsa\FipsAlgorithmPolicy</win-def:key>
          <win-def:name>Enabled</win-def:name>
        </win-def:registry_object>
        <independent-def:sqlext_object id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:obj:25104003" version="7">
          <independent-def:behaviors context="database"/>
          <independent-def:engine var_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:25104003"/>
          <independent-def:version operation="pattern match" var_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:25104004"/>
          <independent-def:instance operation="pattern match">.*</independent-def:instance>
          <independent-def:database operation="pattern match">^(?!(?:master|model|msdb|tempdb)$).*$</independent-def:database>
          <independent-def:sql>SELECT DISTINCT name, algorithm_desc
FROM sys.symmetric_keys
ORDER BY name</independent-def:sql>
        </independent-def:sqlext_object>
      </objects>
      <states>
        <independent-def:sqlext_state id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:ste:21390001" version="7" comment="Containment is equal to 0">
          <independent-def:result>
            <field name="containment">0</field>
          </independent-def:result>
        </independent-def:sqlext_state>
        <independent-def:sqlext_state id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:ste:21390002" version="7" comment="config value = 0">
          <independent-def:result>
            <field name="config_value">0</field>
          </independent-def:result>
        </independent-def:sqlext_state>
        <independent-def:sqlext_state id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:ste:21390003" version="7" comment="run_value = 0">
          <independent-def:result>
            <field name="run_value">0</field>
          </independent-def:result>
        </independent-def:sqlext_state>
        <independent-def:sqlext_state id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:ste:21390004" version="7" comment="Authentication Mode = 'Windows Authentication'">
          <independent-def:result>
            <field name="mode">Windows Authentication</field>
          </independent-def:result>
        </independent-def:sqlext_state>
        <independent-def:sqlext_state id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:ste:21390005" version="7" comment="If any SQL Server logins are not authorized, this is a finding.">
          <independent-def:result>
            <field name="user_name" operation="case insensitive equals" var_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:21390004" var_check="at least one"/>
          </independent-def:result>
        </independent-def:sqlext_state>
        <independent-def:sqlext_state id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:ste:21390006" version="7" comment="Authentication Mode = 'Windows and SQL Server Authentication'">
          <independent-def:result>
            <field name="mode">Windows and SQL Server Authentication</field>
          </independent-def:result>
        </independent-def:sqlext_state>
        <independent-def:sqlext_state id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:ste:21390007" version="7" comment="Containment is equal to 1">
          <independent-def:result>
            <field name="containment">1</field>
          </independent-def:result>
        </independent-def:sqlext_state>
        <independent-def:sqlext_state id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:ste:21390008" version="7" comment="config value = 1">
          <independent-def:result>
            <field name="config_value">1</field>
          </independent-def:result>
        </independent-def:sqlext_state>
        <independent-def:sqlext_state id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:ste:21390009" version="7" comment="run_value = 1">
          <independent-def:result>
            <field name="run_value">1</field>
          </independent-def:result>
        </independent-def:sqlext_state>
        <independent-def:shellcommand_state id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server:ste:21390201" version="7" comment="Stdout_line should not exist">
          <independent-def:stdout_line check_existence="none_exist"/>
        </independent-def:shellcommand_state>
        <independent-def:variable_state id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:ste:21390301" version="7" comment="No temporal tables are required">
          <independent-def:value datatype="string">NONE_REQUIRED</independent-def:value>
        </independent-def:variable_state>
        <independent-def:sqlext_state id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:ste:21390401" version="7" comment="If trustworthy is not enabled, this is not a finding.">
          <independent-def:result>
            <field name="is_trustworthy" operation="case insensitive equals">no</field>
          </independent-def:result>
        </independent-def:sqlext_state>
        <independent-def:sqlext_state id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:ste:21390402" version="7" comment="If trustworthy is enabled and the database owner is not a privileged account, this is not a finding.">
          <independent-def:result>
            <field name="is_trustworthy" operation="case insensitive equals">yes</field>
            <field name="is_owner_privileged" operation="case insensitive equals">no</field>
          </independent-def:result>
        </independent-def:sqlext_state>
        <independent-def:sqlext_state id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:ste:21390403" version="7" comment="Trustworthy is enabled and the database owner is a privileged account">
          <independent-def:result>
            <field name="is_trustworthy" operation="case insensitive equals">yes</field>
            <field name="is_owner_privileged" operation="case insensitive equals">yes</field>
          </independent-def:result>
        </independent-def:sqlext_state>
        <independent-def:sqlext_state id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:ste:21390404" version="7" comment="If the database_owner is documented/authorized, this is not a finding.">
          <independent-def:result>
            <field name="database_owner" operation="case insensitive equals" var_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:21390404" var_check="at least one"/>
          </independent-def:result>
        </independent-def:sqlext_state>
        <independent-def:sqlext_state id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:ste:21390501" version="7" comment="If any role memberships are not documented and authorized, this is a finding.">
          <independent-def:result>
            <field name="role_member_name" operation="case insensitive equals" var_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:21390504" var_check="at least one"/>
          </independent-def:result>
        </independent-def:sqlext_state>
        <independent-def:sqlext_state id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:ste:21390502" version="7" comment="If any of the roles or users returned have permissions that are not documented, or the documented audit maintainers do not have permissions, this is a finding.">
          <independent-def:result>
            <field name="role_member_name" operation="case insensitive equals" var_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:21390504" var_check="at least one"/>
          </independent-def:result>
        </independent-def:sqlext_state>
        <independent-def:sqlext_state id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.2016.db:ste:21390601" version="7" comment="If any users or role permissions returned are not authorized to modify the specified object or type, this is a finding.">
          <independent-def:result>
            <field name="user_name" operation="case insensitive equals" var_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.2016.db:var:21390604" var_check="at least one"/>
          </independent-def:result>
        </independent-def:sqlext_state>
        <independent-def:sqlext_state id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:ste:21390701" version="7" comment="If any schema is owned by an unauthorized database principal, this is a finding.">
          <independent-def:result>
            <field name="schema_to_owner" operation="case insensitive equals" var_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:21390704" var_check="at least one"/>
          </independent-def:result>
        </independent-def:sqlext_state>
        <independent-def:sqlext_state id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:ste:21390801" version="7" comment="If any of the listed owners is not authorized, this is a finding.">
          <independent-def:result>
            <field name="object_owner" operation="case insensitive equals" var_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:21390804" var_check="at least one"/>
          </independent-def:result>
        </independent-def:sqlext_state>
        <independent-def:sqlext_state id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:ste:21390901" version="7" comment="If any users or role permissions returned are not authorized to modify the specified object or type, this is a finding.">
          <independent-def:result>
            <field name="user_name" operation="case insensitive equals" var_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:21390904" var_check="at least one"/>
          </independent-def:result>
        </independent-def:sqlext_state>
        <independent-def:sqlext_state id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:ste:21391001" version="7" comment="If the recovery model description does not match the documented recovery model, this is a finding.">
          <independent-def:result>
            <field name="recovery_model_desc" operation="case insensitive equals" var_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:21391004" var_check="at least one"/>
          </independent-def:result>
        </independent-def:sqlext_state>
        <independent-def:sqlext_state id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:ste:21391101" version="7" comment="Authentication Mode = 'Windows Authentication'">
          <independent-def:result>
            <field name="count" datatype="int">0</field>
          </independent-def:result>
        </independent-def:sqlext_state>
        <independent-def:sqlext_state id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:ste:21391102" version="7" comment="Authentication Mode = 'Windows Authentication'">
          <independent-def:result>
            <field name="count" datatype="int" operation="greater than">0</field>
          </independent-def:result>
        </independent-def:sqlext_state>
        <win-def:passwordpolicy_state id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:ste:21391103" version="7" comment="All DISA STIG OS Password Policy Settings must be applied">
          <win-def:max_passwd_age datatype="int" operation="less than or equal">5184000</win-def:max_passwd_age>
          <win-def:min_passwd_age datatype="int" operation="greater than or equal">86400</win-def:min_passwd_age>
          <win-def:min_passwd_len operation="greater than or equal" datatype="int">14</win-def:min_passwd_len>
          <win-def:password_hist_len datatype="int" operation="greater than or equal">24</win-def:password_hist_len>
          <win-def:password_complexity datatype="boolean">1</win-def:password_complexity>
          <win-def:reversible_encryption datatype="boolean">0</win-def:reversible_encryption>
          <win-def:anonymous_name_lookup datatype="boolean">0</win-def:anonymous_name_lookup>
        </win-def:passwordpolicy_state>
        <win-def:passwordpolicy_state id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:ste:21391104" version="7" comment="All DISA STIG OS Password Policy Settings must be applied">
          <win-def:max_passwd_age datatype="int" operation="greater than">0</win-def:max_passwd_age>
        </win-def:passwordpolicy_state>
        <independent-def:sqlext_state id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:ste:21391201" version="7" comment="List of manually approved database names that comply with the STIG for all encryption and auditing requirements">
          <independent-def:result>
            <field name="database_name" operation="case insensitive equals" var_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:21391204" var_check="at least one"/>
          </independent-def:result>
        </independent-def:sqlext_state>
        <independent-def:sqlext_state id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:ste:21392101" version="7" comment="List of usernames approved to own a schema or object or be delegated the right to assign additonal permissions">
          <independent-def:result>
            <field name="user_name" operation="case insensitive equals" var_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:21392104" var_check="at least one"/>
          </independent-def:result>
        </independent-def:sqlext_state>
        <independent-def:sqlext_state id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:ste:21392201" version="7" comment="List of stored procedures and/or functions that are documented and authorized to utilize impersonation.">
          <independent-def:result>
            <field name="module_name" operation="case insensitive equals" var_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:21392204" var_check="at least one"/>
          </independent-def:result>
        </independent-def:sqlext_state>
        <independent-def:sqlext_state id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.2016.db:ste:21392301" version="7" comment="If any users are not authorized to perform the installation of logic modules (stored procedures, functions, triggers, views, etc.), this is a finding.">
          <independent-def:result>
            <field name="user_name" operation="case insensitive equals" var_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.2016.db:var:21392304" var_check="at least one"/>
          </independent-def:result>
        </independent-def:sqlext_state>
        <independent-def:sqlext_state id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:ste:21392401" version="7" comment="List of databases that are documented and authorized to have an owner who is a member of a fixed server role">
          <independent-def:result>
            <field name="module_name" operation="case insensitive equals" var_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:21392404" var_check="at least one"/>
          </independent-def:result>
        </independent-def:sqlext_state>
        <win-def:wmi57_state id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:ste:21392601" version="7" comment="BitLocker status is Protected">
          <win-def:result datatype="record" operation="equals">
            <field name="protectionstatus">1</field>
          </win-def:result>
        </win-def:wmi57_state>
        <independent-def:sqlext_state id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:ste:21392602" version="7" comment="'encryption_state' must be equal to 'Encrypted'">
          <independent-def:result>
            <field name="encryption_state">Encrypted</field>
          </independent-def:result>
        </independent-def:sqlext_state>
        <independent-def:sqlext_state id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:ste:21392603" version="7" comment="'encryption_state' must be equal to End User provided authorized/documented requirement for database level encryption">
          <independent-def:result>
            <field name="encryption_state" operation="case insensitive equals" var_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:21392604" var_check="at least one"/>
          </independent-def:result>
        </independent-def:sqlext_state>
        <independent-def:variable_state id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:ste:25104001" version="7" comment="This state checks to see if user provided to determine whether cryptography for classified or sensitive information is required by the information owner">
          <independent-def:value datatype="string" operation="case insensitive equals" var_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:25104002"/>
        </independent-def:variable_state>
        <win-def:registry_state id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:ste:25104002" version="7" comment="Registry key dword value equals 1">
          <win-def:type>reg_dword</win-def:type>
          <win-def:value datatype="int">1</win-def:value>
        </win-def:registry_state>
        <independent-def:sqlext_state id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:ste:25104003" version="7" comment="'algorithm_desc' must be equal to 'AES 256' or 'Triple DES'">
          <independent-def:result>
            <field name="algorithm_desc" operation="pattern match">AES_256|Triple_DES</field>
          </independent-def:result>
        </independent-def:sqlext_state>
      </states>
      <variables>
        <constant_variable id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:21390001" version="7" comment="Microsoft SQL Server DBMS" datatype="string">
          <value>sqlserver</value>
        </constant_variable>
        <constant_variable id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:21390002" version="7" comment="Microsoft SQL Server version 2016" datatype="string">
          <value>2016|2017|2019|2022</value>
        </constant_variable>
        <external_variable id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:21390004" version="7" comment="End user provided list of accounts authorized to be managed by SQL Server" datatype="string"/>
        <local_variable id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.2016.db:var:21390203" version="7" comment="ADSI call with User/Computer name extracted from DOMAIN\User$ string" datatype="string">
          <concat>
            <literal_component datatype="string">try{ ([ADSISearcher]"(&amp;(ObjectCategory=Computer)(Name=</literal_component>
            <regex_capture pattern=".+\\(.*)\$">
              <object_component object_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.2016.db:obj:21390201" item_field="result" record_field="name"/>
            </regex_capture>
            <literal_component datatype="string">))").FindAll() | foreach-object{ write-host($_.Properties.adspath + ", OS:" + $_.Properties.operatingsystem)}} catch{}</literal_component>
          </concat>
        </local_variable>
        <constant_variable id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:21390301" version="7" comment="Microsoft SQL Server DBMS" datatype="string">
          <value>sqlserver</value>
        </constant_variable>
        <constant_variable id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:21390302" version="7" comment="Microsoft SQL Server version" datatype="string">
          <value>2016|2017|2019|2022</value>
        </constant_variable>
        <external_variable id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:21390303" version="7" comment="End user provided list of authorized and documented temporal tables or NONE_REQUIRED" datatype="string"/>
        <local_variable id="oval:navy.navwar.niwcatlantic.scc.windows:var:21390304" version="7" datatype="string" comment="SQL that verifies that the authorized and documented temporal tables exist">
          <concat>
            <literal_component>SELECT SCHEMA_NAME(T.schema_id) AS schema_name, T.name AS table_name, T.temporal_type_desc, SCHEMA_NAME(H.schema_id) + '.' + H.name AS history_table
FROM sys.tables T
JOIN sys.tables H ON T.history_table_id = H.object_id
WHERE T.temporal_type != 0
AND T.name = '</literal_component>
            <variable_component var_ref="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:21390303"/>
            <literal_component>' ORDER BY schema_name, table_name</literal_component>
          </concat>
        </local_variable>
        <constant_variable id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:21390401" version="7" comment="Microsoft SQL Server DBMS" datatype="string">
          <value>sqlserver</value>
        </constant_variable>
        <constant_variable id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:21390402" version="7" comment="Microsoft SQL Server version 2016" datatype="string">
          <value>2016|2017|2019|2022</value>
        </constant_variable>
        <external_variable id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:21390404" version="7" comment="End user provided list of authorized and documented database owners" datatype="string"/>
        <constant_variable id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:21390501" version="7" comment="Microsoft SQL Server DBMS" datatype="string">
          <value>sqlserver</value>
        </constant_variable>
        <constant_variable id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:21390502" version="7" comment="Microsoft SQL Server version 2016" datatype="string">
          <value>2016|2017|2019|2022</value>
        </constant_variable>
        <external_variable id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:21390504" version="7" comment="End user provided list of authorized and documented list of approved audit maintainers" datatype="string"/>
        <constant_variable id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.2016.db:var:21390601" version="7" comment="Microsoft SQL Server DBMS" datatype="string">
          <value>sqlserver</value>
        </constant_variable>
        <constant_variable id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.2016.db:var:21390602" version="7" comment="Microsoft SQL Server version 2016" datatype="string">
          <value>2016|2017|2019|2022</value>
        </constant_variable>
        <external_variable id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.2016.db:var:21390604" version="7" comment="End user provided list of users and roles who are authorized to change stored procedures, functions, and triggers from the server documentation." datatype="string"/>
        <constant_variable id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:21390701" version="7" comment="Microsoft SQL Server DBMS" datatype="string">
          <value>sqlserver</value>
        </constant_variable>
        <constant_variable id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:21390702" version="7" comment="Microsoft SQL Server version 2016" datatype="string">
          <value>2016|2017|2019|2022</value>
        </constant_variable>
        <external_variable id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:21390704" version="7" comment="End user provided list of schema to owners" datatype="string"/>
        <constant_variable id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:21390801" version="7" comment="Microsoft SQL Server DBMS" datatype="string">
          <value>sqlserver</value>
        </constant_variable>
        <constant_variable id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:21390802" version="7" comment="Microsoft SQL Server version 2016" datatype="string">
          <value>2016|2017|2019|2022</value>
        </constant_variable>
        <external_variable id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:21390804" version="7" comment="End user provided list of authorized and documented database object owners" datatype="string"/>
        <constant_variable id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:21390901" version="7" comment="Microsoft SQL Server DBMS" datatype="string">
          <value>sqlserver</value>
        </constant_variable>
        <constant_variable id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:21390902" version="7" comment="Microsoft SQL Server version 2016" datatype="string">
          <value>2016|2017|2019|2022</value>
        </constant_variable>
        <external_variable id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:21390904" version="7" comment="End user provided list of users and roles who are authorized to modify database structure and logic modules from the server documentation." datatype="string"/>
        <constant_variable id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:21391001" version="7" comment="Microsoft SQL Server DBMS" datatype="string">
          <value>sqlserver</value>
        </constant_variable>
        <constant_variable id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:21391002" version="7" comment="Microsoft SQL Server version 2016" datatype="string">
          <value>2016|2017|2019|2022</value>
        </constant_variable>
        <external_variable id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:21391004" version="7" comment="End user provided authorized and documented database recovery model" datatype="string"/>
        <constant_variable id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:21391101" version="7" comment="Microsoft SQL Server DBMS" datatype="string">
          <value>sqlserver</value>
        </constant_variable>
        <constant_variable id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:21391102" version="7" comment="Microsoft SQL Server version 2016" datatype="string">
          <value>2016|2017|2019|2022</value>
        </constant_variable>
        <constant_variable id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:21391201" version="7" comment="Microsoft SQL Server DBMS" datatype="string">
          <value>sqlserver</value>
        </constant_variable>
        <constant_variable id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:21391202" version="7" comment="Microsoft SQL Server version 2016" datatype="string">
          <value>2016|2017|2019|2022</value>
        </constant_variable>
        <external_variable id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:21391204" version="7" comment="End user provided list of authorized and documented database names that have been manually tested to have correct encryption" datatype="string"/>
        <constant_variable id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:21392101" version="7" comment="Microsoft SQL Server DBMS" datatype="string">
          <value>sqlserver</value>
        </constant_variable>
        <constant_variable id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:21392102" version="7" comment="Microsoft SQL Server version 2016" datatype="string">
          <value>2016|2017|2019|2022</value>
        </constant_variable>
        <external_variable id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:21392104" version="7" comment="End user provided list of authorized and documented usernames allowed to own schemas, objects or assign additonal permissions" datatype="string"/>
        <constant_variable id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:21392201" version="7" comment="Microsoft SQL Server DBMS" datatype="string">
          <value>sqlserver</value>
        </constant_variable>
        <constant_variable id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:21392202" version="7" comment="Microsoft SQL Server version 2016" datatype="string">
          <value>2016|2017|2019|2022</value>
        </constant_variable>
        <external_variable id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:21392204" version="7" comment="End user provided list of authorized and documented module names allowed to utilize impersonation" datatype="string"/>
        <constant_variable id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.2016.db:var:21392301" version="7" comment="Microsoft SQL Server DBMS" datatype="string">
          <value>sqlserver</value>
        </constant_variable>
        <constant_variable id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.2016.db:var:21392302" version="7" comment="Microsoft SQL Server version 2016" datatype="string">
          <value>2016|2017|2019|2022</value>
        </constant_variable>
        <external_variable id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.2016.db:var:21392304" version="7" comment="End user provided list of users and roles who are authorized to perform installation of logic modules (stored procedures, functions, triggers, views, etc.)" datatype="string"/>
        <constant_variable id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:21392401" version="7" comment="Microsoft SQL Server DBMS" datatype="string">
          <value>sqlserver</value>
        </constant_variable>
        <constant_variable id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:21392402" version="7" comment="Microsoft SQL Server version 2016" datatype="string">
          <value>2016|2017|2019|2022</value>
        </constant_variable>
        <external_variable id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:21392404" version="7" comment="End user provided list of authorized and documented database names who have an owner who is a member of a fixed server role" datatype="string"/>
        <constant_variable id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:21392601" version="7" comment="Microsoft SQL Server DBMS" datatype="string">
          <value>sqlserver</value>
        </constant_variable>
        <constant_variable id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:21392602" version="7" comment="Microsoft SQL Server version 2016" datatype="string">
          <value>2016|2017|2019|2022</value>
        </constant_variable>
        <external_variable id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:21392604" version="7" comment="End user provided information on authorized/documented database level encryption requirement" datatype="string"/>
        <constant_variable id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:25104001" version="7" comment="NO" datatype="string">
          <value>NO</value>
        </constant_variable>
        <external_variable id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:25104002" version="7" comment="End user provided system documentation to determine whether cryptography for classified or sensitive information is required by the information owner" datatype="string"/>
        <constant_variable id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:25104003" version="7" comment="Microsoft SQL Server DBMS" datatype="string">
          <value>sqlserver</value>
        </constant_variable>
        <constant_variable id="oval:navy.navwar.niwcatlantic.scc.ms.sql.server.db:var:25104004" version="7" comment="Microsoft SQL Server version 2016" datatype="string">
          <value>2016|2017|2019|2022</value>
        </constant_variable>
      </variables>
    </oval_definitions>
  </component>
  <component id="scap_navy.navwar.niwcatlantic.scc_comp_U_MS_SQL_Server_2016_Database_V3R3_STIG_SCAP_1-4_Benchmark-enhancedV7-ocil.xml" timestamp="2025-09-16T13:55:38.481217+00:00">
    <ocil xmlns="http://scap.nist.gov/schema/ocil/2.0" xsi:schemaLocation="http://scap.nist.gov/schema/ocil/2.0 ocil-2.0.xsd">
      <generator>
        <schema_version>2.0</schema_version>
        <timestamp>2025-09-16T13:55:38.481217+00:00</timestamp>
      </generator>
      <document>
        <title>MS SQL Server 2016 Database Security Technical Implementation Guide OCIL Questionnaires</title>
        <description>This SCAP Benchmark was created based on the DISA MS SQL Server 2016 Database Security Technical Implementation Guide, Version 3, Release 3, by NIWC Atlantic.  For questions/issues with the content please contact:  scc.fct@navy.mil</description>
      </document>
      <questionnaires>
        <questionnaire id="ocil:navy.navwar.niwcatlantic.scc.sql.server:questionnaire:101">
          <title>SQL Server databases must integrate with an organization-level authentication/access mechanism providing account management and automation for all users, groups, roles, and any other principals.</title>
          <description>&lt;VulnDiscussion&gt;Enterprise environments make account management for applications and databases challenging and complex. A manual process for account management functions adds the risk of a potential oversight or other error. Managing accounts for the same person in multiple places is inefficient and prone to problems with consistency and synchronization.

A comprehensive application account management process that includes automation helps to ensure that accounts designated as requiring attention are consistently and promptly addressed. 

Examples include, but are not limited to, using automation to take action on multiple accounts designated as inactive, suspended, or terminated, or by disabling accounts located in noncentralized account stores, such as multiple servers. Account management functions can also include: assignment of group or role membership; identifying account type; specifying user access authorizations (i.e., privileges); account removal, update, or termination; and administrative alerts. The use of automated mechanisms can include, for example: using email or text messaging to notify account managers when users are terminated or transferred; using the information system to monitor account usage; and using automated telephone notification to report atypical system account usage.

SQL Server must be configured to automatically utilize organization-level account management functions, and these functions must immediately enforce the organization's current account policy. 

Automation may be comprised of differing technologies that when placed together, contain an overall mechanism supporting an organization's automated account management requirements.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
          <actions operation="AND">
            <test_action_ref>ocil:navy.navwar.niwcatlantic.scc.sql.server:testaction:101</test_action_ref>
          </actions>
        </questionnaire>
        <questionnaire id="ocil:navy.navwar.niwcatlantic.scc.sql.server:questionnaire:301">
          <title>SQL Server must enforce approved authorizations for logical access to database information and system resources in accordance with applicable access control policies.</title>
          <description>&lt;VulnDiscussion&gt;Authentication with a DoD-approved PKI certificate does not necessarily imply authorization to access SQL Server. To mitigate the risk of unauthorized access to sensitive information by entities that have been issued certificates by DoD-approved PKIs, all DoD systems, including databases, must be properly configured to implement access control policies. 

Successful authentication must not automatically give an entity access to an asset or security boundary. Authorization procedures and controls must be implemented to ensure each authenticated entity also has a validated and current authorization. Authorization is the process of determining whether an entity, once authenticated, is permitted to access a specific asset. Information systems use access control policies and enforcement mechanisms to implement this requirement. 

Access control policies include identity-based policies, role-based policies, and attribute-based policies. Access enforcement mechanisms include access control lists, access control matrices, and cryptography. These policies and mechanisms must be employed by the application to control access between users (or processes acting on behalf of users) and objects (e.g., devices, files, records, processes, programs, and domains) in the information system. 

This requirement is applicable to access control enforcement applications, a category that includes database management systems.  If SQL Server does not follow applicable policy when approving access, it may be in conflict with networks or other applications in the information system. This may result in users either gaining or being denied access inappropriately and in conflict with applicable policy.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
          <actions operation="AND">
            <test_action_ref>ocil:navy.navwar.niwcatlantic.scc.sql.server:testaction:301</test_action_ref>
          </actions>
        </questionnaire>
        <questionnaire id="ocil:navy.navwar.niwcatlantic.scc.sql.server:questionnaire:501">
          <title>SQL Server must protect against a user falsely repudiating by ensuring only clearly unique Active Directory user accounts can connect to the database.</title>
          <description>&lt;VulnDiscussion&gt;Non-repudiation of actions taken is required in order to maintain data integrity. Examples of particular actions taken by individuals include creating information, sending a message, approving information (e.g., indicating concurrence or signing a contract), and receiving a message. 

Non-repudiation protects against later claims by a user of not having created, modified, or deleted a particular data item or collection of data in the database.

In designing a database, the organization must define the types of data and the user actions that must be protected from repudiation. The implementation must then include building audit features into the application data tables and configuring the DBMS's audit tools to capture the necessary audit trail. Design and implementation also must ensure that applications pass individual user identification to the DBMS, even where the application connects to the DBMS with a standard, shared account.

If the computer account of a remote computer is granted access to a SQL Server database, any service or scheduled task running as NT AUTHORITY\SYSTEM or NT AUTHORITY\NETWORK SERVICE can log into the instance and perform actions. These actions cannot be traced back to a specific user or process.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
          <actions operation="AND">
            <test_action_ref>ocil:navy.navwar.niwcatlantic.scc.sql.server:testaction:501</test_action_ref>
          </actions>
        </questionnaire>
        <questionnaire id="ocil:navy.navwar.niwcatlantic.scc.sql.server:questionnaire:701">
          <title>SQL Server must protect against a user falsely repudiating by use of system-versioned tables (Temporal Tables).</title>
          <description>&lt;VulnDiscussion&gt;Non-repudiation of actions taken is required in order to maintain data integrity. Examples of particular actions taken by individuals include creating information, sending a message, approving information (e.g., indicating concurrence or signing a contract), and receiving a message.

Non-repudiation protects against later claims by a user of not having created, modified, or deleted a particular data item or collection of data in the database. 

In designing a database, the organization must define the types of data and the user actions that must be protected from repudiation. The implementation must then include building audit features into the application data tables and configuring SQL Server's audit tools to capture the necessary audit trail. Design and implementation also must ensure that applications pass individual user identification to SQL Server, even where the application connects to SQL Server with a standard, shared account. 

Applications should use temporal tables to track the changes and history of sensitive data.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
          <actions operation="AND">
            <test_action_ref>ocil:navy.navwar.niwcatlantic.scc.sql.server:testaction:701</test_action_ref>
          </actions>
        </questionnaire>
        <questionnaire id="ocil:navy.navwar.niwcatlantic.scc.sql.server:questionnaire:901">
          <title>SQL Server must protect against a user falsely repudiating by ensuring databases are not in a trust relationship.</title>
          <description>&lt;VulnDiscussion&gt;Non-repudiation of actions taken is required in order to maintain data integrity. Examples of particular actions taken by individuals include creating information, sending a message, approving information (e.g., indicating concurrence or signing a contract), and receiving a message. 

Non-repudiation protects against later claims by a user of not having created, modified, or deleted a particular data item or collection of data in the database.

SQL Server provides the ability for high privileged accounts to impersonate users in a database using the TRUSTWORTHY feature.&#160;This will allow members of the fixed database role to impersonate any user within the database.&#160;&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
          <actions operation="AND">
            <test_action_ref>ocil:navy.navwar.niwcatlantic.scc.sql.server:testaction:901</test_action_ref>
          </actions>
        </questionnaire>
        <questionnaire id="ocil:navy.navwar.niwcatlantic.scc.sql.server:questionnaire:1101">
          <title>SQL Server must allow only the ISSM (or individuals or roles appointed by the ISSM) to select which auditable events are to be audited.</title>
          <description>&lt;VulnDiscussion&gt;Without the capability to restrict which roles and individuals can select which events are audited, unauthorized personnel may be able to prevent or interfere with the auditing of critical events.

Suppression of auditing could permit an adversary to evade detection.

Misconfigured audits can degrade the system's performance by overwhelming the audit log. Misconfigured audits may also make it more difficult to establish, correlate, and investigate the events relating to an incident or identify those responsible for one.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
          <actions operation="AND">
            <test_action_ref>ocil:navy.navwar.niwcatlantic.scc.sql.server:testaction:1101</test_action_ref>
          </actions>
        </questionnaire>
        <questionnaire id="ocil:navy.navwar.niwcatlantic.scc.sql.server:questionnaire:1301">
          <title>SQL Server must limit privileges to change software modules, to include stored procedures, functions, and triggers.</title>
          <description>&lt;VulnDiscussion&gt;If the system were to allow any user to make changes to software libraries, then those changes might be implemented without undergoing the appropriate testing and approvals that are part of a robust change management process.

Accordingly, only qualified and authorized individuals shall be allowed to obtain access to information system components for purposes of initiating changes, including upgrades and modifications.

Unmanaged changes that occur to the database software libraries or configuration can lead to unauthorized or compromised installations.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
          <actions operation="AND">
            <test_action_ref>ocil:navy.navwar.niwcatlantic.scc.sql.server:testaction:1301</test_action_ref>
          </actions>
        </questionnaire>
        <questionnaire id="ocil:navy.navwar.niwcatlantic.scc.sql.server:questionnaire:1501">
          <title>SQL Server must limit privileges to change software modules, to include stored procedures, functions, and triggers, and links to software external to SQL Server.</title>
          <description>&lt;VulnDiscussion&gt;If the system were to allow any user to make changes to software libraries, then those changes might be implemented without undergoing the appropriate testing and approvals that are part of a robust change management process.

Accordingly, only qualified and authorized individuals shall be allowed to obtain access to information system components for purposes of initiating changes, including upgrades and modifications.

Unmanaged changes that occur to the database software libraries or configuration can lead to unauthorized or compromised installations.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
          <actions operation="AND">
            <test_action_ref>ocil:navy.navwar.niwcatlantic.scc.sql.server:testaction:1501</test_action_ref>
          </actions>
        </questionnaire>
        <questionnaire id="ocil:navy.navwar.niwcatlantic.scc.sql.server:questionnaire:1701">
          <title>Database objects (including but not limited to tables, indexes, storage, stored procedures, functions, triggers, links to software external to SQL Server, etc.) must be owned by database/DBMS principals authorized for ownership.</title>
          <description>&lt;VulnDiscussion&gt;Within the database, object ownership implies full privileges to the owned object, including the privilege to assign access to the owned objects to other subjects. Database functions and procedures can be coded using definer's rights. This allows anyone who utilizes the object to perform the actions if they were the owner. If not properly managed, this can lead to privileged actions being taken by unauthorized individuals.

Conversely, if critical tables or other objects in SQL Server rely on unauthorized owner accounts, these objects may be lost when an account is removed.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
          <actions operation="AND">
            <test_action_ref>ocil:navy.navwar.niwcatlantic.scc.sql.server:testaction:1701</test_action_ref>
          </actions>
        </questionnaire>
        <questionnaire id="ocil:navy.navwar.niwcatlantic.scc.sql.server:questionnaire:1901">
          <title>The role(s)/group(s) used to modify database structure (including but not necessarily limited to tables, indexes, storage, etc.) and logic modules (stored procedures, functions, triggers, links to software external to SQL Server, etc.) must be restricted to authorized users.</title>
          <description>&lt;VulnDiscussion&gt;If SQL Server were to allow any user to make changes to database structure or logic, then those changes might be implemented without undergoing the appropriate testing and approvals that are part of a robust change management process.

Accordingly, only qualified and authorized individuals shall be allowed to obtain access to information system components for purposes of initiating changes, including upgrades and modifications.

Unmanaged changes that occur to the database software libraries or configuration can lead to unauthorized or compromised installations.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
          <actions operation="AND">
            <test_action_ref>ocil:navy.navwar.niwcatlantic.scc.sql.server:testaction:1901</test_action_ref>
          </actions>
        </questionnaire>
        <questionnaire id="ocil:navy.navwar.niwcatlantic.scc.sql.server:questionnaire:2101">
          <title>In the event of a system failure, hardware loss or disk failure, SQL Server must be able to restore necessary databases with least disruption to mission processes.</title>
          <description>&lt;VulnDiscussion&gt;Failure to a known state can address safety or security in accordance with the mission/business needs of the organization. Failure to a known secure state helps prevent a loss of confidentiality, integrity, or availability in the event of a failure of the information system or a component of the system. In the event of a system failure, SQL Server must be able to bring the database back to a consistent state.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
          <actions operation="AND">
            <test_action_ref>ocil:navy.navwar.niwcatlantic.scc.sql.server:testaction:2101</test_action_ref>
          </actions>
        </questionnaire>
        <questionnaire id="ocil:navy.navwar.niwcatlantic.scc.sql.server:questionnaire:2301">
          <title>The Database Master Key encryption password must meet DOD password complexity requirements. </title>
          <description>&lt;VulnDiscussion&gt;Weak passwords may be easily guessed. When passwords are used to encrypt keys used for encryption of sensitive data, then the confidentiality of all data encrypted using that key is at risk.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
          <actions operation="AND">
            <test_action_ref>ocil:navy.navwar.niwcatlantic.scc.sql.server:testaction:2301</test_action_ref>
          </actions>
        </questionnaire>
        <questionnaire id="ocil:navy.navwar.niwcatlantic.scc.sql.server:questionnaire:2501">
          <title>The Database Master Key must be encrypted by the Service Master Key, where a Database Master Key is required and another encryption method has not been specified. </title>
          <description>&lt;VulnDiscussion&gt;When not encrypted by the Service Master Key, system administrators or application administrators may access and use the Database Master Key to view sensitive data that they are not authorized to view. Where alternate encryption means are not feasible, encryption by the Service Master Key may be necessary. To help protect sensitive data from unauthorized access by DBAs, mitigations may be in order. Mitigations may include automatic alerts or other audit events when the Database Master Key is accessed outside of the application or by a DBA account.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
          <actions operation="AND">
            <test_action_ref>ocil:navy.navwar.niwcatlantic.scc.sql.server:testaction:2501</test_action_ref>
          </actions>
        </questionnaire>
        <questionnaire id="ocil:navy.navwar.niwcatlantic.scc.sql.server:questionnaire:2701">
          <title>The Certificate used for encryption must be backed up and stored in a secure location that is not on the SQL Server.</title>
          <description>&lt;VulnDiscussion&gt;Backup and recovery of the Certificate used for encryption is critical to the complete recovery of the database. Not having this key can lead to loss of data during recovery.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
          <actions operation="AND">
            <test_action_ref>ocil:navy.navwar.niwcatlantic.scc.sql.server:testaction:2701</test_action_ref>
          </actions>
        </questionnaire>
        <questionnaire id="ocil:navy.navwar.niwcatlantic.scc.sql.server:questionnaire:2901">
          <title>SQL Server must isolate security functions from non-security functions.</title>
          <description>&lt;VulnDiscussion&gt;An isolation boundary provides access control and protects the integrity of the hardware, software, and firmware that perform security functions. 

Security functions are the hardware, software, and/or firmware of the information system responsible for enforcing the system security policy and supporting the isolation of code and data on which the protection is based.

Developers and implementers can increase the assurance in security functions by employing well-defined security policy models; structured, disciplined, and rigorous hardware and software development techniques; and sound system/security engineering principles. 

Database Management Systems typically separate security functionality from non-security functionality via separate databases or schemas. Database objects or code implementing security functionality should not be commingled with objects or code implementing application logic. When security and non-security functionality are commingled, users who have access to non-security functionality may be able to access security functionality.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
          <actions operation="AND">
            <test_action_ref>ocil:navy.navwar.niwcatlantic.scc.sql.server:testaction:2901</test_action_ref>
          </actions>
        </questionnaire>
        <questionnaire id="ocil:navy.navwar.niwcatlantic.scc.sql.server:questionnaire:3101">
          <title>Database contents must be protected from unauthorized and unintended information transfer by enforcement of a data-transfer policy.</title>
          <description>&lt;VulnDiscussion&gt;Applications, including DBMSs, must prevent unauthorized and unintended information transfer via shared system resources. 

Data used for the development and testing of applications often involves copying data from production. It is important that specific procedures exist for this process, to include the conditions under which such transfer may take place, where the copies may reside, and the rules for ensuring sensitive data are not exposed.

Copies of sensitive data must not be misplaced or left in a temporary location without the proper controls.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
          <actions operation="AND">
            <test_action_ref>ocil:navy.navwar.niwcatlantic.scc.sql.server:testaction:3101</test_action_ref>
          </actions>
        </questionnaire>
        <questionnaire id="ocil:navy.navwar.niwcatlantic.scc.sql.server:questionnaire:3301">
          <title>SQL Server must check the validity of all data inputs except those specifically identified by the organization.</title>
          <description>&lt;VulnDiscussion&gt;Invalid user input occurs when a user inserts data or characters into an application's data entry fields and the application is unprepared to process that data. This results in unanticipated application behavior, potentially leading to an application or information system compromise. Invalid user input is one of the primary methods employed when attempting to compromise an application.

With respect to database management systems, one class of threat is known as SQL Injection, or more generally, code injection. It takes advantage of the dynamic execution capabilities of various programming languages, including dialects of SQL. Potentially, the attacker can gain unauthorized access to data, including security settings, and severely corrupt or destroy the database.

Even when no such hijacking takes place, invalid input that gets recorded in the database, whether accidental or malicious, reduces the reliability and usability of the system. Available protections include data types, referential constraints, uniqueness constraints, range checking, and application-specific logic. Application-specific logic can be implemented within the database in stored procedures and triggers, where appropriate.

This calls for inspection of application source code, which will require collaboration with the application developers. It is recognized that in many cases, the database administrator (DBA) is organizationally separate from the application developers, and may have limited, if any, access to source code. Nevertheless, protections of this type are so important to the secure operation of databases that they must not be ignored. At a minimum, the DBA must attempt to obtain assurances from the development organization that this issue has been addressed, and must document what has been discovered.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
          <actions operation="AND">
            <test_action_ref>ocil:navy.navwar.niwcatlantic.scc.sql.server:testaction:3301</test_action_ref>
          </actions>
        </questionnaire>
        <questionnaire id="ocil:navy.navwar.niwcatlantic.scc.sql.server:questionnaire:3501">
          <title>SQL Server must provide non-privileged users with error messages that provide information necessary for corrective actions without revealing information that could be exploited by adversaries.</title>
          <description>&lt;VulnDiscussion&gt;Any DBMS or associated application providing too much information in error messages on the screen or printout risks compromising the data and security of the system. The structure and content of error messages need to be carefully considered by the organization and development team.

Databases can inadvertently provide a wealth of information to an attacker through improperly handled error messages. In addition to sensitive business or personal information, database errors can provide host names, IP addresses, user names, and other system information not required for troubleshooting but very useful to someone targeting the system.

Carefully consider the structure/content of error messages. The extent to which information systems are able to identify and handle error conditions is guided by organizational policy and operational requirements. Information that could be exploited by adversaries includes, for example, logon attempts with passwords entered by mistake as the username, mission/business information that can be derived from (if not stated explicitly by) information recorded, and personal information, such as account numbers, social security numbers, and credit card numbers.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
          <actions operation="AND">
            <test_action_ref>ocil:navy.navwar.niwcatlantic.scc.sql.server:testaction:3501</test_action_ref>
          </actions>
        </questionnaire>
        <questionnaire id="ocil:navy.navwar.niwcatlantic.scc.sql.server:questionnaire:3701">
          <title>SQL Server must associate organization-defined types of security labels having organization-defined security label values with information in storage.</title>
          <description>&lt;VulnDiscussion&gt;Without the association of security labels to information, there is no basis for&#160;SQL Server&#160;to make security-related access-control decisions.

Security labels are abstractions representing the basic properties or characteristics of an entity (e.g., subjects and objects) with respect to safeguarding information.

These labels are typically associated with internal data structures (e.g., tables, rows) within the database and are used to enable the implementation of access control and flow control policies; reflect special dissemination, handling, or distribution instructions; or support other aspects of the information security policy.

One example includes marking data as classified or FOUO. These security labels may be assigned manually or during data processing, but, either way, it is imperative these assignments are maintained while the data is in storage. If the security labels are lost when the data is stored, there is the risk of a data compromise.

The mechanism used to support security labeling may be a feature of SQL Server, a third-party product, or custom application code.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
          <actions operation="AND">
            <test_action_ref>ocil:navy.navwar.niwcatlantic.scc.sql.server:testaction:3701</test_action_ref>
          </actions>
        </questionnaire>
        <questionnaire id="ocil:navy.navwar.niwcatlantic.scc.sql.server:questionnaire:3901">
          <title>SQL Server must associate organization-defined types of security labels having organization-defined security label values with information in process.</title>
          <description>&lt;VulnDiscussion&gt;Without the association of security labels to information, there is no basis for SQL Server to make security-related access-control decisions.

Security labels are abstractions representing the basic properties or characteristics of an entity (e.g., subjects and objects) with respect to safeguarding information.

These labels are typically associated with internal data structures (e.g., tables, rows) within the database and are used to enable the implementation of access control and flow control policies; reflect special dissemination, handling, or distribution instructions; or support other aspects of the information security policy.

One example includes marking data as classified or FOUO. These security labels may be assigned manually or during data processing, but, either way, it is imperative these assignments are maintained while the data is in storage. If the security labels are lost when the data is stored, there is the risk of a data compromise.

The mechanism used to support security labeling may be a feature of SQL Server, a third-party product, or custom application code.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
          <actions operation="AND">
            <test_action_ref>ocil:navy.navwar.niwcatlantic.scc.sql.server:testaction:3901</test_action_ref>
          </actions>
        </questionnaire>
        <questionnaire id="ocil:navy.navwar.niwcatlantic.scc.sql.server:questionnaire:4101">
          <title>SQL Server must associate organization-defined types of security labels having organization-defined security label values with information in transmission.</title>
          <description>&lt;VulnDiscussion&gt;Without the association of security labels to information, there is no basis for SQL Server to make security-related access-control decisions.

Security labels are abstractions representing the basic properties or characteristics of an entity (e.g., subjects and objects) with respect to safeguarding information. These labels are typically associated with internal data structures (e.g., tables, rows) within the database and are used to enable the implementation of access control and flow control policies; reflect special dissemination, handling, or distribution instructions; or support other aspects of the information security policy. One example includes marking data as classified or FOUO. These security labels may be assigned manually or during data processing, but, either way, it is imperative these assignments are maintained while the data is in storage. If the security labels are lost when the data is stored, there is the risk of a data compromise.

The mechanism used to support security labeling may be a feature of SQL Server, a third-party product, or custom application code.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
          <actions operation="AND">
            <test_action_ref>ocil:navy.navwar.niwcatlantic.scc.sql.server:testaction:4101</test_action_ref>
          </actions>
        </questionnaire>
        <questionnaire id="ocil:navy.navwar.niwcatlantic.scc.sql.server:questionnaire:4301">
          <title>SQL Server must enforce discretionary access control policies, as defined by the data owner, over defined subjects and objects.</title>
          <description>&lt;VulnDiscussion&gt;Discretionary Access Control (DAC) is based on the notion that individual users are "owners" of objects and therefore have discretion over who should be authorized to access the object and in which mode (e.g., read or write). Ownership is usually acquired as a consequence of creating the object or via specified ownership assignment. DAC allows the owner to determine who will have access to objects they control. An example of DAC includes user-controlled table permissions.

When discretionary access control policies are implemented, subjects are not constrained with regard to what actions they can take with information for which they have already been granted access. Thus, subjects that have been granted access to information are not prevented from passing (i.e., the subjects have the discretion to pass) the information to other subjects or objects. 

A subject that is constrained in its operation by Mandatory Access Control policies is still able to operate under the less rigorous constraints of this requirement. Thus, while Mandatory Access Control imposes constraints preventing a subject from passing information to another subject operating at a different sensitivity level, this requirement permits the subject to pass the information to any subject at the same sensitivity level. 

The policy is bounded by the information system boundary. Once the information is passed outside of the control of the information system, additional means may be required to ensure the constraints remain in effect. While the older, more traditional definitions of discretionary access control require identity-based access control, that limitation is not required for this use of discretionary access control.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
          <actions operation="AND">
            <test_action_ref>ocil:navy.navwar.niwcatlantic.scc.sql.server:testaction:4301</test_action_ref>
          </actions>
        </questionnaire>
        <questionnaire id="ocil:navy.navwar.niwcatlantic.scc.sql.server:questionnaire:4501">
          <title>Execution of stored procedures and functions that utilize execute as must be restricted to necessary cases only.</title>
          <description>&lt;VulnDiscussion&gt;In certain situations, to provide required functionality, a DBMS needs to execute internal logic (stored procedures, functions, triggers, etc.) and/or external code modules with elevated privileges. However, if the privileges required for execution are at a higher level than the privileges assigned to organizational users invoking the functionality applications/programs, those users are indirectly provided with greater privileges than assigned by organizations.

Privilege elevation must be utilized only where necessary and protected from misuse.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
          <actions operation="AND">
            <test_action_ref>ocil:navy.navwar.niwcatlantic.scc.sql.server:testaction:4501</test_action_ref>
          </actions>
        </questionnaire>
        <questionnaire id="ocil:navy.navwar.niwcatlantic.scc.sql.server:questionnaire:4701">
          <title>SQL Server must prohibit user installation of logic modules (stored procedures, functions, triggers, views, etc.) without explicit privileged status.</title>
          <description>&lt;VulnDiscussion&gt;Allowing regular users to install software, without explicit privileges, creates the risk that untested or potentially malicious software will be installed on the system. Explicit privileges (escalated or administrative privileges) provide the regular user with explicit capabilities and control that exceed the rights of a regular user.

DBMS functionality and the nature and requirements of databases will vary; so while users are not permitted to install unapproved software, there may be instances where the organization allows the user to install approved software packages such as from an approved software repository. The requirements for production servers will be more restrictive than those used for development and research.

SQL Server must enforce software installation by users based upon what types of software installations are permitted (e.g., updates and security patches to existing software) and what types of installations are prohibited (e.g., software whose pedigree with regard to being potentially malicious is unknown or suspect) by the organization. 

In the case of a database management system, this requirement covers stored procedures, functions, triggers, views, etc.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
          <actions operation="AND">
            <test_action_ref>ocil:navy.navwar.niwcatlantic.scc.sql.server:testaction:4701</test_action_ref>
          </actions>
        </questionnaire>
        <questionnaire id="ocil:navy.navwar.niwcatlantic.scc.sql.server:questionnaire:4901">
          <title>SQL Server must enforce access restrictions associated with changes to the configuration of the database(s).</title>
          <description>&lt;VulnDiscussion&gt;Failure to provide logical access restrictions associated with changes to configuration may have significant effects on the overall security of the system. 

When dealing with access restrictions pertaining to change control, it should be noted that any changes to the hardware, software, and/or firmware components of the information system can potentially have significant effects on the overall security of the system. 

Accordingly, only qualified and authorized individuals should be allowed to obtain access to system components for the purposes of initiating changes, including upgrades and modifications.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
          <actions operation="AND">
            <test_action_ref>ocil:navy.navwar.niwcatlantic.scc.sql.server:testaction:4901</test_action_ref>
          </actions>
        </questionnaire>
        <questionnaire id="ocil:navy.navwar.niwcatlantic.scc.sql.server:questionnaire:5101">
          <title>SQL Server must implement cryptographic mechanisms to prevent unauthorized modification of organization-defined information at rest (to include, at a minimum, PII and classified information) on organization-defined information system components.</title>
          <description>&lt;VulnDiscussion&gt;DBMSs handling data requiring "data at rest" protections must employ cryptographic mechanisms to prevent unauthorized disclosure and modification of the information at rest. These cryptographic mechanisms may be native to SQL Server or implemented via additional software or operating system/file system settings, as appropriate to the situation.

Selection of a cryptographic mechanism is based on the need to protect the integrity of organizational information. The strength of the mechanism is commensurate with the security category and/or classification of the information. Organizations have the flexibility to either encrypt all information on storage devices (i.e., full disk encryption) or encrypt specific data structures (e.g., files, records, or fields). 

The decision whether and what to encrypt rests with the data owner and is also influenced by the physical measures taken to secure the equipment and media on which the information resides.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
          <actions operation="AND">
            <test_action_ref>ocil:navy.navwar.niwcatlantic.scc.sql.server:testaction:5101</test_action_ref>
          </actions>
        </questionnaire>
        <questionnaire id="ocil:navy.navwar.niwcatlantic.scc.sql.server:questionnaire:5301">
          <title>SQL Server must implement cryptographic mechanisms preventing the unauthorized disclosure of organization-defined information at rest on organization-defined information system components.</title>
          <description>&lt;VulnDiscussion&gt;SQL Server&#8217;s handling data requiring "data at rest" protections must employ cryptographic mechanisms to prevent unauthorized disclosure and modification of the information at rest. These cryptographic mechanisms may be native to SQL Server or implemented via additional software or operating system/file system settings, as appropriate to the situation.

Selection of a cryptographic mechanism is based on the need to protect the integrity of organizational information. The strength of the mechanism is commensurate with the security category and/or classification of the information. Organizations have the flexibility to either encrypt all information on storage devices (i.e., full disk encryption) or encrypt specific data structures (e.g., files, records, or fields). 

The decision whether and what to encrypt rests with the data owner and is also influenced by the physical measures taken to secure the equipment and media on which the information resides.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
          <actions operation="AND">
            <test_action_ref>ocil:navy.navwar.niwcatlantic.scc.sql.server:testaction:5301</test_action_ref>
          </actions>
        </questionnaire>
        <questionnaire id="ocil:navy.navwar.niwcatlantic.scc.sql.server:questionnaire:5501">
          <title>SQL Server must use NSA-approved cryptography to protect classified information in accordance with the data owners requirements.</title>
          <description>&lt;VulnDiscussion&gt;Use of weak or untested encryption algorithms undermines the purposes of utilizing encryption to protect data. The application must implement cryptographic modules adhering to the higher standards approved by the federal government since this provides assurance they have been tested and validated.

It is the responsibility of the data owner to assess the cryptography requirements in light of applicable federal laws, Executive Orders, directives, policies, regulations, and standards.

NSA-approved cryptography for classified networks is hardware based. This requirement addresses the compatibility of a DBMS with the encryption devices.&lt;/VulnDiscussion&gt;&lt;FalsePositives&gt;&lt;/FalsePositives&gt;&lt;FalseNegatives&gt;&lt;/FalseNegatives&gt;&lt;Documentable&gt;false&lt;/Documentable&gt;&lt;Mitigations&gt;&lt;/Mitigations&gt;&lt;SeverityOverrideGuidance&gt;&lt;/SeverityOverrideGuidance&gt;&lt;PotentialImpacts&gt;&lt;/PotentialImpacts&gt;&lt;ThirdPartyTools&gt;&lt;/ThirdPartyTools&gt;&lt;MitigationControl&gt;&lt;/MitigationControl&gt;&lt;Responsibility&gt;&lt;/Responsibility&gt;&lt;IAControls&gt;&lt;/IAControls&gt;</description>
          <actions operation="AND">
            <test_action_ref>ocil:navy.navwar.niwcatlantic.scc.sql.server:testaction:5501</test_action_ref>
          </actions>
        </questionnaire>
        <questionnaire id="ocil:navy.navwar.niwcatlantic.scc.ms.sql.server.db.hybrid:questionnaire:213900">
          <title>If contained databases are enabled, and if mixed mode authentication is enabled, SQL Logins must be documented and authorized</title>
          <description/>
          <actions operation="AND">
            <test_action_ref>ocil:navy.navwar.niwcatlantic.scc.ms.sql.server.db.hybrid:testaction:21390001</test_action_ref>
          </actions>
        </questionnaire>
        <questionnaire id="ocil:navy.navwar.niwcatlantic.scc.ms.sql.server.db.hybrid:questionnaire:213903">
          <title>SQL Server must protect against a user falsely repudiating by use of system-versioned tables (Temporal Tables).</title>
          <description/>
          <actions operation="AND">
            <test_action_ref>ocil:navy.navwar.niwcatlantic.scc.ms.sql.server.db.hybrid:testaction:21390301</test_action_ref>
          </actions>
        </questionnaire>
        <questionnaire id="ocil:navy.navwar.niwcatlantic.scc.ms.sql.server.db.hybrid:questionnaire:213904">
          <title>SQL Server must protect against a user falsely repudiating by ensuring databases are not in a trust relationship.</title>
          <description/>
          <actions operation="AND">
            <test_action_ref>ocil:navy.navwar.niwcatlantic.scc.ms.sql.server.db.hybrid:testaction:21390401</test_action_ref>
          </actions>
        </questionnaire>
        <questionnaire id="ocil:navy.navwar.niwcatlantic.scc.ms.sql.server.db.hybrid:questionnaire:213905">
          <title>SQL Server must allow only the ISSM (or individuals or roles appointed by the ISSM) to select which auditable events are to be audited.</title>
          <description/>
          <actions operation="AND">
            <test_action_ref>ocil:navy.navwar.niwcatlantic.scc.ms.sql.server.db.hybrid:testaction:21390501</test_action_ref>
          </actions>
        </questionnaire>
        <questionnaire id="ocil:navy.navwar.niwcatlantic.scc.ms.sql.server.db.hybrid:questionnaire:213906">
          <title>SQL Server must limit privileges to change software modules, to include stored procedures, functions, and triggers.</title>
          <description/>
          <actions operation="AND">
            <test_action_ref>ocil:navy.navwar.niwcatlantic.scc.ms.sql.server.db.hybrid:testaction:21390601</test_action_ref>
          </actions>
        </questionnaire>
        <questionnaire id="ocil:navy.navwar.niwcatlantic.scc.ms.sql.server.db.hybrid:questionnaire:213907">
          <title>SQL Server must limit privileges to change software modules, to include stored procedures, functions, and triggers, and links to software external to SQL Server.</title>
          <description/>
          <actions operation="AND">
            <test_action_ref>ocil:navy.navwar.niwcatlantic.scc.ms.sql.server.db.hybrid:testaction:21390701</test_action_ref>
          </actions>
        </questionnaire>
        <questionnaire id="ocil:navy.navwar.niwcatlantic.scc.ms.sql.server.db.hybrid:questionnaire:213908">
          <title>Database objects (including but not limited to tables, indexes, storage, stored procedures, functions, triggers, links to software external to SQL Server, etc.) must be owned by database/DBMS principals authorized for ownership.</title>
          <description/>
          <actions operation="AND">
            <test_action_ref>ocil:navy.navwar.niwcatlantic.scc.ms.sql.server.db.hybrid:testaction:21390801</test_action_ref>
          </actions>
        </questionnaire>
        <questionnaire id="ocil:navy.navwar.niwcatlantic.scc.ms.sql.server.db.hybrid:questionnaire:213909">
          <title>The role(s)/group(s) used to modify database structure (including but not necessarily limited to tables, indexes, storage, etc.) and logic modules (stored procedures, functions, triggers, links to software external to SQL Server, etc.) must be restricted to authorized users.</title>
          <description/>
          <actions operation="AND">
            <test_action_ref>ocil:navy.navwar.niwcatlantic.scc.ms.sql.server.db.hybrid:testaction:21390901</test_action_ref>
          </actions>
        </questionnaire>
        <questionnaire id="ocil:navy.navwar.niwcatlantic.scc.ms.sql.server.16.db.hybrid:questionnaire:213910">
          <title>In the event of a system failure, hardware loss or disk failure, SQL Server must be able to restore necessary databases with least disruption to mission processes</title>
          <description/>
          <actions operation="AND">
            <test_action_ref>ocil:navy.navwar.niwcatlantic.scc.ms.sql.server.16.db.hybrid:testaction:21391001</test_action_ref>
          </actions>
        </questionnaire>
        <questionnaire id="ocil:navy.navwar.niwcatlantic.scc.ms.sql.server.db.hybrid:questionnaire:213912">
          <title>The Database Master Key must be encrypted by the Service Master Key, where a Database Master Key is required and another encryption method has not been specified.</title>
          <description/>
          <actions operation="AND">
            <test_action_ref>ocil:navy.navwar.niwcatlantic.scc.ms.sql.server.db.hybrid:testaction:21391201</test_action_ref>
          </actions>
        </questionnaire>
        <questionnaire id="ocil:navy.navwar.niwcatlantic.scc.ms.sql.server.db.hybrid:questionnaire:213921">
          <title>SQL Server must enforce discretionary access control policies, as defined by the data owner, over defined subjects and objects.</title>
          <description/>
          <actions operation="AND">
            <test_action_ref>ocil:navy.navwar.niwcatlantic.scc.ms.sql.server.db.hybrid:testaction:21392101</test_action_ref>
          </actions>
        </questionnaire>
        <questionnaire id="ocil:navy.navwar.niwcatlantic.scc.ms.sql.server.db.hybrid:questionnaire:213922">
          <title>Execution of stored procedures and functions that utilize execute as must be restricted to necessary cases only.</title>
          <description/>
          <actions operation="AND">
            <test_action_ref>ocil:navy.navwar.niwcatlantic.scc.ms.sql.server.db.hybrid:testaction:21392201</test_action_ref>
          </actions>
        </questionnaire>
        <questionnaire id="ocil:navy.navwar.niwcatlantic.scc.ms.sql.server.db.hybrid:questionnaire:213923">
          <title>SQL Server must prohibit user installation of logic modules (stored procedures, functions, triggers, views, etc.) without explicit privileged status.</title>
          <description/>
          <actions operation="AND">
            <test_action_ref>ocil:navy.navwar.niwcatlantic.scc.ms.sql.server.db.hybrid:testaction:21392301</test_action_ref>
          </actions>
        </questionnaire>
        <questionnaire id="ocil:navy.navwar.niwcatlantic.scc.ms.sql.server.db.hybrid:questionnaire:213924">
          <title>SQL Server must enforce access restrictions associated with changes to the configuration of the database(s).</title>
          <description/>
          <actions operation="AND">
            <test_action_ref>ocil:navy.navwar.niwcatlantic.scc.ms.sql.server.db.hybrid:testaction:21392401</test_action_ref>
          </actions>
        </questionnaire>
        <questionnaire id="ocil:navy.navwar.niwcatlantic.scc.ms.sql.server.db.hybrid:questionnaire:213926">
          <title>SQL Server must implement cryptographic mechanisms to prevent unauthorized modification of organization-defined information at rest (to include, at a minimum, PII and classified information) on organization-defined information system components.</title>
          <description/>
          <actions operation="AND">
            <test_action_ref>ocil:navy.navwar.niwcatlantic.scc.ms.sql.server.db.hybrid:testaction:21392601</test_action_ref>
          </actions>
        </questionnaire>
        <questionnaire id="ocil:navy.navwar.niwcatlantic.scc.ms.sql.server.db.hybrid:questionnaire:251040">
          <title>SQL Server must use NSA-approved cryptography to protect classified information in accordance with the data owners requirements.</title>
          <description/>
          <actions operation="AND">
            <test_action_ref>ocil:navy.navwar.niwcatlantic.scc.ms.sql.server.db.hybrid:testaction:25104001</test_action_ref>
          </actions>
        </questionnaire>
      </questionnaires>
      <test_actions>
        <choice_question_test_action question_ref="ocil:navy.navwar.niwcatlantic.scc.sql.server:question:101" id="ocil:navy.navwar.niwcatlantic.scc.sql.server:testaction:101">
          <title>CAT I, V-213900, SV-213900r1043176, SRG-APP-000023-DB-000001</title>
          <when_choice>
            <result>FAIL</result>
            <choice_ref>ocil:navy.navwar.niwcatlantic.scc:choice:1</choice_ref>
          </when_choice>
          <when_choice>
            <result>PASS</result>
            <choice_ref>ocil:navy.navwar.niwcatlantic.scc:choice:2</choice_ref>
          </when_choice>
          <when_choice>
            <result>NOT_APPLICABLE</result>
            <choice_ref>ocil:navy.navwar.niwcatlantic.scc:choice:3</choice_ref>
          </when_choice>
          <when_choice>
            <result>NOT_TESTED</result>
            <choice_ref>ocil:navy.navwar.niwcatlantic.scc:choice:4</choice_ref>
          </when_choice>
        </choice_question_test_action>
        <choice_question_test_action question_ref="ocil:navy.navwar.niwcatlantic.scc.sql.server:question:301" id="ocil:navy.navwar.niwcatlantic.scc.sql.server:testaction:301">
          <title>CAT I, V-213901, SV-213901r1112497, SRG-APP-000033-DB-000084</title>
          <when_choice>
            <result>FAIL</result>
            <choice_ref>ocil:navy.navwar.niwcatlantic.scc:choice:1</choice_ref>
          </when_choice>
          <when_choice>
            <result>PASS</result>
            <choice_ref>ocil:navy.navwar.niwcatlantic.scc:choice:2</choice_ref>
          </when_choice>
          <when_choice>
            <result>NOT_APPLICABLE</result>
            <choice_ref>ocil:navy.navwar.niwcatlantic.scc:choice:3</choice_ref>
          </when_choice>
          <when_choice>
            <result>NOT_TESTED</result>
            <choice_ref>ocil:navy.navwar.niwcatlantic.scc:choice:4</choice_ref>
          </when_choice>
        </choice_question_test_action>
        <choice_question_test_action question_ref="ocil:navy.navwar.niwcatlantic.scc.sql.server:question:501" id="ocil:navy.navwar.niwcatlantic.scc.sql.server:testaction:501">
          <title>CAT II, V-213902, SV-213902r960864, SRG-APP-000080-DB-000063</title>
          <when_choice>
            <result>FAIL</result>
            <choice_ref>ocil:navy.navwar.niwcatlantic.scc:choice:1</choice_ref>
          </when_choice>
          <when_choice>
            <result>PASS</result>
            <choice_ref>ocil:navy.navwar.niwcatlantic.scc:choice:2</choice_ref>
          </when_choice>
          <when_choice>
            <result>NOT_APPLICABLE</result>
            <choice_ref>ocil:navy.navwar.niwcatlantic.scc:choice:3</choice_ref>
          </when_choice>
          <when_choice>
            <result>NOT_TESTED</result>
            <choice_ref>ocil:navy.navwar.niwcatlantic.scc:choice:4</choice_ref>
          </when_choice>
        </choice_question_test_action>
        <choice_question_test_action question_ref="ocil:navy.navwar.niwcatlantic.scc.sql.server:question:701" id="ocil:navy.navwar.niwcatlantic.scc.sql.server:testaction:701">
          <title>CAT III, V-213903, SV-213903r960864, SRG-APP-000080-DB-000063</title>
          <when_choice>
            <result>FAIL</result>
            <choice_ref>ocil:navy.navwar.niwcatlantic.scc:choice:1</choice_ref>
          </when_choice>
          <when_choice>
            <result>PASS</result>
            <choice_ref>ocil:navy.navwar.niwcatlantic.scc:choice:2</choice_ref>
          </when_choice>
          <when_choice>
            <result>NOT_APPLICABLE</result>
            <choice_ref>ocil:navy.navwar.niwcatlantic.scc:choice:3</choice_ref>
          </when_choice>
          <when_choice>
            <result>NOT_TESTED</result>
            <choice_ref>ocil:navy.navwar.niwcatlantic.scc:choice:4</choice_ref>
          </when_choice>
        </choice_question_test_action>
        <choice_question_test_action question_ref="ocil:navy.navwar.niwcatlantic.scc.sql.server:question:901" id="ocil:navy.navwar.niwcatlantic.scc.sql.server:testaction:901">
          <title>CAT II, V-213904, SV-213904r960864, SRG-APP-000080-DB-000063</title>
          <when_choice>
            <result>FAIL</result>
            <choice_ref>ocil:navy.navwar.niwcatlantic.scc:choice:1</choice_ref>
          </when_choice>
          <when_choice>
            <result>PASS</result>
            <choice_ref>ocil:navy.navwar.niwcatlantic.scc:choice:2</choice_ref>
          </when_choice>
          <when_choice>
            <result>NOT_APPLICABLE</result>
            <choice_ref>ocil:navy.navwar.niwcatlantic.scc:choice:3</choice_ref>
          </when_choice>
          <when_choice>
            <result>NOT_TESTED</result>
            <choice_ref>ocil:navy.navwar.niwcatlantic.scc:choice:4</choice_ref>
          </when_choice>
        </choice_question_test_action>
        <choice_question_test_action question_ref="ocil:navy.navwar.niwcatlantic.scc.sql.server:question:1101" id="ocil:navy.navwar.niwcatlantic.scc.sql.server:testaction:1101">
          <title>CAT II, V-213905, SV-213905r960882, SRG-APP-000090-DB-000065</title>
          <when_choice>
            <result>FAIL</result>
            <choice_ref>ocil:navy.navwar.niwcatlantic.scc:choice:1</choice_ref>
          </when_choice>
          <when_choice>
            <result>PASS</result>
            <choice_ref>ocil:navy.navwar.niwcatlantic.scc:choice:2</choice_ref>
          </when_choice>
          <when_choice>
            <result>NOT_APPLICABLE</result>
            <choice_ref>ocil:navy.navwar.niwcatlantic.scc:choice:3</choice_ref>
          </when_choice>
          <when_choice>
            <result>NOT_TESTED</result>
            <choice_ref>ocil:navy.navwar.niwcatlantic.scc:choice:4</choice_ref>
          </when_choice>
        </choice_question_test_action>
        <choice_question_test_action question_ref="ocil:navy.navwar.niwcatlantic.scc.sql.server:question:1301" id="ocil:navy.navwar.niwcatlantic.scc.sql.server:testaction:1301">
          <title>CAT II, V-213906, SV-213906r960960, SRG-APP-000133-DB-000179</title>
          <when_choice>
            <result>FAIL</result>
            <choice_ref>ocil:navy.navwar.niwcatlantic.scc:choice:1</choice_ref>
          </when_choice>
          <when_choice>
            <result>PASS</result>
            <choice_ref>ocil:navy.navwar.niwcatlantic.scc:choice:2</choice_ref>
          </when_choice>
          <when_choice>
            <result>NOT_APPLICABLE</result>
            <choice_ref>ocil:navy.navwar.niwcatlantic.scc:choice:3</choice_ref>
          </when_choice>
          <when_choice>
            <result>NOT_TESTED</result>
            <choice_ref>ocil:navy.navwar.niwcatlantic.scc:choice:4</choice_ref>
          </when_choice>
        </choice_question_test_action>
        <choice_question_test_action question_ref="ocil:navy.navwar.niwcatlantic.scc.sql.server:question:1501" id="ocil:navy.navwar.niwcatlantic.scc.sql.server:testaction:1501">
          <title>CAT II, V-213907, SV-213907r960960, SRG-APP-000133-DB-000179</title>
          <when_choice>
            <result>FAIL</result>
            <choice_ref>ocil:navy.navwar.niwcatlantic.scc:choice:1</choice_ref>
          </when_choice>
          <when_choice>
            <result>PASS</result>
            <choice_ref>ocil:navy.navwar.niwcatlantic.scc:choice:2</choice_ref>
          </when_choice>
          <when_choice>
            <result>NOT_APPLICABLE</result>
            <choice_ref>ocil:navy.navwar.niwcatlantic.scc:choice:3</choice_ref>
          </when_choice>
          <when_choice>
            <result>NOT_TESTED</result>
            <choice_ref>ocil:navy.navwar.niwcatlantic.scc:choice:4</choice_ref>
          </when_choice>
        </choice_question_test_action>
        <choice_question_test_action question_ref="ocil:navy.navwar.niwcatlantic.scc.sql.server:question:1701" id="ocil:navy.navwar.niwcatlantic.scc.sql.server:testaction:1701">
          <title>CAT II, V-213908, SV-213908r960960, SRG-APP-000133-DB-000200</title>
          <when_choice>
            <result>FAIL</result>
            <choice_ref>ocil:navy.navwar.niwcatlantic.scc:choice:1</choice_ref>
          </when_choice>
          <when_choice>
            <result>PASS</result>
            <choice_ref>ocil:navy.navwar.niwcatlantic.scc:choice:2</choice_ref>
          </when_choice>
          <when_choice>
            <result>NOT_APPLICABLE</result>
            <choice_ref>ocil:navy.navwar.niwcatlantic.scc:choice:3</choice_ref>
          </when_choice>
          <when_choice>
            <result>NOT_TESTED</result>
            <choice_ref>ocil:navy.navwar.niwcatlantic.scc:choice:4</choice_ref>
          </when_choice>
        </choice_question_test_action>
        <choice_question_test_action question_ref="ocil:navy.navwar.niwcatlantic.scc.sql.server:question:1901" id="ocil:navy.navwar.niwcatlantic.scc.sql.server:testaction:1901">
          <title>CAT II, V-213909, SV-213909r960960, SRG-APP-000133-DB-000362</title>
          <when_choice>
            <result>FAIL</result>
            <choice_ref>ocil:navy.navwar.niwcatlantic.scc:choice:1</choice_ref>
          </when_choice>
          <when_choice>
            <result>PASS</result>
            <choice_ref>ocil:navy.navwar.niwcatlantic.scc:choice:2</choice_ref>
          </when_choice>
          <when_choice>
            <result>NOT_APPLICABLE</result>
            <choice_ref>ocil:navy.navwar.niwcatlantic.scc:choice:3</choice_ref>
          </when_choice>
          <when_choice>
            <result>NOT_TESTED</result>
            <choice_ref>ocil:navy.navwar.niwcatlantic.scc:choice:4</choice_ref>
          </when_choice>
        </choice_question_test_action>
        <choice_question_test_action question_ref="ocil:navy.navwar.niwcatlantic.scc.sql.server:question:2101" id="ocil:navy.navwar.niwcatlantic.scc.sql.server:testaction:2101">
          <title>CAT II, V-213910, SV-213910r961125, SRG-APP-000226-DB-000147</title>
          <when_choice>
            <result>FAIL</result>
            <choice_ref>ocil:navy.navwar.niwcatlantic.scc:choice:1</choice_ref>
          </when_choice>
          <when_choice>
            <result>PASS</result>
            <choice_ref>ocil:navy.navwar.niwcatlantic.scc:choice:2</choice_ref>
          </when_choice>
          <when_choice>
            <result>NOT_APPLICABLE</result>
            <choice_ref>ocil:navy.navwar.niwcatlantic.scc:choice:3</choice_ref>
          </when_choice>
          <when_choice>
            <result>NOT_TESTED</result>
            <choice_ref>ocil:navy.navwar.niwcatlantic.scc:choice:4</choice_ref>
          </when_choice>
        </choice_question_test_action>
        <choice_question_test_action question_ref="ocil:navy.navwar.niwcatlantic.scc.sql.server:question:2301" id="ocil:navy.navwar.niwcatlantic.scc.sql.server:testaction:2301">
          <title>CAT II, V-213911, SV-213911r961128, SRG-APP-000231-DB-000154</title>
          <when_choice>
            <result>FAIL</result>
            <choice_ref>ocil:navy.navwar.niwcatlantic.scc:choice:1</choice_ref>
          </when_choice>
          <when_choice>
            <result>PASS</result>
            <choice_ref>ocil:navy.navwar.niwcatlantic.scc:choice:2</choice_ref>
          </when_choice>
          <when_choice>
            <result>NOT_APPLICABLE</result>
            <choice_ref>ocil:navy.navwar.niwcatlantic.scc:choice:3</choice_ref>
          </when_choice>
          <when_choice>
            <result>NOT_TESTED</result>
            <choice_ref>ocil:navy.navwar.niwcatlantic.scc:choice:4</choice_ref>
          </when_choice>
        </choice_question_test_action>
        <choice_question_test_action question_ref="ocil:navy.navwar.niwcatlantic.scc.sql.server:question:2501" id="ocil:navy.navwar.niwcatlantic.scc.sql.server:testaction:2501">
          <title>CAT II, V-213912, SV-213912r961128, SRG-APP-000231-DB-000154</title>
          <when_choice>
            <result>FAIL</result>
            <choice_ref>ocil:navy.navwar.niwcatlantic.scc:choice:1</choice_ref>
          </when_choice>
          <when_choice>
            <result>PASS</result>
            <choice_ref>ocil:navy.navwar.niwcatlantic.scc:choice:2</choice_ref>
          </when_choice>
          <when_choice>
            <result>NOT_APPLICABLE</result>
            <choice_ref>ocil:navy.navwar.niwcatlantic.scc:choice:3</choice_ref>
          </when_choice>
          <when_choice>
            <result>NOT_TESTED</result>
            <choice_ref>ocil:navy.navwar.niwcatlantic.scc:choice:4</choice_ref>
          </when_choice>
        </choice_question_test_action>
        <choice_question_test_action question_ref="ocil:navy.navwar.niwcatlantic.scc.sql.server:question:2701" id="ocil:navy.navwar.niwcatlantic.scc.sql.server:testaction:2701">
          <title>CAT II, V-213913, SV-213913r961128, SRG-APP-000231-DB-000154</title>
          <when_choice>
            <result>FAIL</result>
            <choice_ref>ocil:navy.navwar.niwcatlantic.scc:choice:1</choice_ref>
          </when_choice>
          <when_choice>
            <result>PASS</result>
            <choice_ref>ocil:navy.navwar.niwcatlantic.scc:choice:2</choice_ref>
          </when_choice>
          <when_choice>
            <result>NOT_APPLICABLE</result>
            <choice_ref>ocil:navy.navwar.niwcatlantic.scc:choice:3</choice_ref>
          </when_choice>
          <when_choice>
            <result>NOT_TESTED</result>
            <choice_ref>ocil:navy.navwar.niwcatlantic.scc:choice:4</choice_ref>
          </when_choice>
        </choice_question_test_action>
        <choice_question_test_action question_ref="ocil:navy.navwar.niwcatlantic.scc.sql.server:question:2901" id="ocil:navy.navwar.niwcatlantic.scc.sql.server:testaction:2901">
          <title>CAT III, V-213914, SV-213914r961131, SRG-APP-000233-DB-000124</title>
          <when_choice>
            <result>FAIL</result>
            <choice_ref>ocil:navy.navwar.niwcatlantic.scc:choice:1</choice_ref>
          </when_choice>
          <when_choice>
            <result>PASS</result>
            <choice_ref>ocil:navy.navwar.niwcatlantic.scc:choice:2</choice_ref>
          </when_choice>
          <when_choice>
            <result>NOT_APPLICABLE</result>
            <choice_ref>ocil:navy.navwar.niwcatlantic.scc:choice:3</choice_ref>
          </when_choice>
          <when_choice>
            <result>NOT_TESTED</result>
            <choice_ref>ocil:navy.navwar.niwcatlantic.scc:choice:4</choice_ref>
          </when_choice>
        </choice_question_test_action>
        <choice_question_test_action question_ref="ocil:navy.navwar.niwcatlantic.scc.sql.server:question:3101" id="ocil:navy.navwar.niwcatlantic.scc.sql.server:testaction:3101">
          <title>CAT II, V-213915, SV-213915r961149, SRG-APP-000243-DB-000128</title>
          <when_choice>
            <result>FAIL</result>
            <choice_ref>ocil:navy.navwar.niwcatlantic.scc:choice:1</choice_ref>
          </when_choice>
          <when_choice>
            <result>PASS</result>
            <choice_ref>ocil:navy.navwar.niwcatlantic.scc:choice:2</choice_ref>
          </when_choice>
          <when_choice>
            <result>NOT_APPLICABLE</result>
            <choice_ref>ocil:navy.navwar.niwcatlantic.scc:choice:3</choice_ref>
          </when_choice>
          <when_choice>
            <result>NOT_TESTED</result>
            <choice_ref>ocil:navy.navwar.niwcatlantic.scc:choice:4</choice_ref>
          </when_choice>
        </choice_question_test_action>
        <choice_question_test_action question_ref="ocil:navy.navwar.niwcatlantic.scc.sql.server:question:3301" id="ocil:navy.navwar.niwcatlantic.scc.sql.server:testaction:3301">
          <title>CAT II, V-213916, SV-213916r961158, SRG-APP-000251-DB-000160</title>
          <when_choice>
            <result>FAIL</result>
            <choice_ref>ocil:navy.navwar.niwcatlantic.scc:choice:1</choice_ref>
          </when_choice>
          <when_choice>
            <result>PASS</result>
            <choice_ref>ocil:navy.navwar.niwcatlantic.scc:choice:2</choice_ref>
          </when_choice>
          <when_choice>
            <result>NOT_APPLICABLE</result>
            <choice_ref>ocil:navy.navwar.niwcatlantic.scc:choice:3</choice_ref>
          </when_choice>
          <when_choice>
            <result>NOT_TESTED</result>
            <choice_ref>ocil:navy.navwar.niwcatlantic.scc:choice:4</choice_ref>
          </when_choice>
        </choice_question_test_action>
        <choice_question_test_action question_ref="ocil:navy.navwar.niwcatlantic.scc.sql.server:question:3501" id="ocil:navy.navwar.niwcatlantic.scc.sql.server:testaction:3501">
          <title>CAT II, V-213917, SV-213917r961167, SRG-APP-000266-DB-000162</title>
          <when_choice>
            <result>FAIL</result>
            <choice_ref>ocil:navy.navwar.niwcatlantic.scc:choice:1</choice_ref>
          </when_choice>
          <when_choice>
            <result>PASS</result>
            <choice_ref>ocil:navy.navwar.niwcatlantic.scc:choice:2</choice_ref>
          </when_choice>
          <when_choice>
            <result>NOT_APPLICABLE</result>
            <choice_ref>ocil:navy.navwar.niwcatlantic.scc:choice:3</choice_ref>
          </when_choice>
          <when_choice>
            <result>NOT_TESTED</result>
            <choice_ref>ocil:navy.navwar.niwcatlantic.scc:choice:4</choice_ref>
          </when_choice>
        </choice_question_test_action>
        <choice_question_test_action question_ref="ocil:navy.navwar.niwcatlantic.scc.sql.server:question:3701" id="ocil:navy.navwar.niwcatlantic.scc.sql.server:testaction:3701">
          <title>CAT II, V-213918, SV-213918r961269, SRG-APP-000311-DB-000308</title>
          <when_choice>
            <result>FAIL</result>
            <choice_ref>ocil:navy.navwar.niwcatlantic.scc:choice:1</choice_ref>
          </when_choice>
          <when_choice>
            <result>PASS</result>
            <choice_ref>ocil:navy.navwar.niwcatlantic.scc:choice:2</choice_ref>
          </when_choice>
          <when_choice>
            <result>NOT_APPLICABLE</result>
            <choice_ref>ocil:navy.navwar.niwcatlantic.scc:choice:3</choice_ref>
          </when_choice>
          <when_choice>
            <result>NOT_TESTED</result>
            <choice_ref>ocil:navy.navwar.niwcatlantic.scc:choice:4</choice_ref>
          </when_choice>
        </choice_question_test_action>
        <choice_question_test_action question_ref="ocil:navy.navwar.niwcatlantic.scc.sql.server:question:3901" id="ocil:navy.navwar.niwcatlantic.scc.sql.server:testaction:3901">
          <title>CAT II, V-213919, SV-213919r961272, SRG-APP-000313-DB-000309</title>
          <when_choice>
            <result>FAIL</result>
            <choice_ref>ocil:navy.navwar.niwcatlantic.scc:choice:1</choice_ref>
          </when_choice>
          <when_choice>
            <result>PASS</result>
            <choice_ref>ocil:navy.navwar.niwcatlantic.scc:choice:2</choice_ref>
          </when_choice>
          <when_choice>
            <result>NOT_APPLICABLE</result>
            <choice_ref>ocil:navy.navwar.niwcatlantic.scc:choice:3</choice_ref>
          </when_choice>
          <when_choice>
            <result>NOT_TESTED</result>
            <choice_ref>ocil:navy.navwar.niwcatlantic.scc:choice:4</choice_ref>
          </when_choice>
        </choice_question_test_action>
        <choice_question_test_action question_ref="ocil:navy.navwar.niwcatlantic.scc.sql.server:question:4101" id="ocil:navy.navwar.niwcatlantic.scc.sql.server:testaction:4101">
          <title>CAT II, V-213920, SV-213920r961275, SRG-APP-000314-DB-000310</title>
          <when_choice>
            <result>FAIL</result>
            <choice_ref>ocil:navy.navwar.niwcatlantic.scc:choice:1</choice_ref>
          </when_choice>
          <when_choice>
            <result>PASS</result>
            <choice_ref>ocil:navy.navwar.niwcatlantic.scc:choice:2</choice_ref>
          </when_choice>
          <when_choice>
            <result>NOT_APPLICABLE</result>
            <choice_ref>ocil:navy.navwar.niwcatlantic.scc:choice:3</choice_ref>
          </when_choice>
          <when_choice>
            <result>NOT_TESTED</result>
            <choice_ref>ocil:navy.navwar.niwcatlantic.scc:choice:4</choice_ref>
          </when_choice>
        </choice_question_test_action>
        <choice_question_test_action question_ref="ocil:navy.navwar.niwcatlantic.scc.sql.server:question:4301" id="ocil:navy.navwar.niwcatlantic.scc.sql.server:testaction:4301">
          <title>CAT III, V-213921, SV-213921r961317, SRG-APP-000328-DB-000301</title>
          <when_choice>
            <result>FAIL</result>
            <choice_ref>ocil:navy.navwar.niwcatlantic.scc:choice:1</choice_ref>
          </when_choice>
          <when_choice>
            <result>PASS</result>
            <choice_ref>ocil:navy.navwar.niwcatlantic.scc:choice:2</choice_ref>
          </when_choice>
          <when_choice>
            <result>NOT_APPLICABLE</result>
            <choice_ref>ocil:navy.navwar.niwcatlantic.scc:choice:3</choice_ref>
          </when_choice>
          <when_choice>
            <result>NOT_TESTED</result>
            <choice_ref>ocil:navy.navwar.niwcatlantic.scc:choice:4</choice_ref>
          </when_choice>
        </choice_question_test_action>
        <choice_question_test_action question_ref="ocil:navy.navwar.niwcatlantic.scc.sql.server:question:4501" id="ocil:navy.navwar.niwcatlantic.scc.sql.server:testaction:4501">
          <title>CAT II, V-213922, SV-213922r961359, SRG-APP-000342-DB-000302</title>
          <when_choice>
            <result>FAIL</result>
            <choice_ref>ocil:navy.navwar.niwcatlantic.scc:choice:1</choice_ref>
          </when_choice>
          <when_choice>
            <result>PASS</result>
            <choice_ref>ocil:navy.navwar.niwcatlantic.scc:choice:2</choice_ref>
          </when_choice>
          <when_choice>
            <result>NOT_APPLICABLE</result>
            <choice_ref>ocil:navy.navwar.niwcatlantic.scc:choice:3</choice_ref>
          </when_choice>
          <when_choice>
            <result>NOT_TESTED</result>
            <choice_ref>ocil:navy.navwar.niwcatlantic.scc:choice:4</choice_ref>
          </when_choice>
        </choice_question_test_action>
        <choice_question_test_action question_ref="ocil:navy.navwar.niwcatlantic.scc.sql.server:question:4701" id="ocil:navy.navwar.niwcatlantic.scc.sql.server:testaction:4701">
          <title>CAT II, V-213923, SV-213923r1018608, SRG-APP-000378-DB-000365</title>
          <when_choice>
            <result>FAIL</result>
            <choice_ref>ocil:navy.navwar.niwcatlantic.scc:choice:1</choice_ref>
          </when_choice>
          <when_choice>
            <result>PASS</result>
            <choice_ref>ocil:navy.navwar.niwcatlantic.scc:choice:2</choice_ref>
          </when_choice>
          <when_choice>
            <result>NOT_APPLICABLE</result>
            <choice_ref>ocil:navy.navwar.niwcatlantic.scc:choice:3</choice_ref>
          </when_choice>
          <when_choice>
            <result>NOT_TESTED</result>
            <choice_ref>ocil:navy.navwar.niwcatlantic.scc:choice:4</choice_ref>
          </when_choice>
        </choice_question_test_action>
        <choice_question_test_action question_ref="ocil:navy.navwar.niwcatlantic.scc.sql.server:question:4901" id="ocil:navy.navwar.niwcatlantic.scc.sql.server:testaction:4901">
          <title>CAT II, V-213924, SV-213924r961461, SRG-APP-000380-DB-000360</title>
          <when_choice>
            <result>FAIL</result>
            <choice_ref>ocil:navy.navwar.niwcatlantic.scc:choice:1</choice_ref>
          </when_choice>
          <when_choice>
            <result>PASS</result>
            <choice_ref>ocil:navy.navwar.niwcatlantic.scc:choice:2</choice_ref>
          </when_choice>
          <when_choice>
            <result>NOT_APPLICABLE</result>
            <choice_ref>ocil:navy.navwar.niwcatlantic.scc:choice:3</choice_ref>
          </when_choice>
          <when_choice>
            <result>NOT_TESTED</result>
            <choice_ref>ocil:navy.navwar.niwcatlantic.scc:choice:4</choice_ref>
          </when_choice>
        </choice_question_test_action>
        <choice_question_test_action question_ref="ocil:navy.navwar.niwcatlantic.scc.sql.server:question:5101" id="ocil:navy.navwar.niwcatlantic.scc.sql.server:testaction:5101">
          <title>CAT I, V-213926, SV-213926r1018576, SRG-APP-000428-DB-000386</title>
          <when_choice>
            <result>FAIL</result>
            <choice_ref>ocil:navy.navwar.niwcatlantic.scc:choice:1</choice_ref>
          </when_choice>
          <when_choice>
            <result>PASS</result>
            <choice_ref>ocil:navy.navwar.niwcatlantic.scc:choice:2</choice_ref>
          </when_choice>
          <when_choice>
            <result>NOT_APPLICABLE</result>
            <choice_ref>ocil:navy.navwar.niwcatlantic.scc:choice:3</choice_ref>
          </when_choice>
          <when_choice>
            <result>NOT_TESTED</result>
            <choice_ref>ocil:navy.navwar.niwcatlantic.scc:choice:4</choice_ref>
          </when_choice>
        </choice_question_test_action>
        <choice_question_test_action question_ref="ocil:navy.navwar.niwcatlantic.scc.sql.server:question:5301" id="ocil:navy.navwar.niwcatlantic.scc.sql.server:testaction:5301">
          <title>CAT I, V-213927, SV-213927r1018577, SRG-APP-000429-DB-000387</title>
          <when_choice>
            <result>FAIL</result>
            <choice_ref>ocil:navy.navwar.niwcatlantic.scc:choice:1</choice_ref>
          </when_choice>
          <when_choice>
            <result>PASS</result>
            <choice_ref>ocil:navy.navwar.niwcatlantic.scc:choice:2</choice_ref>
          </when_choice>
          <when_choice>
            <result>NOT_APPLICABLE</result>
            <choice_ref>ocil:navy.navwar.niwcatlantic.scc:choice:3</choice_ref>
          </when_choice>
          <when_choice>
            <result>NOT_TESTED</result>
            <choice_ref>ocil:navy.navwar.niwcatlantic.scc:choice:4</choice_ref>
          </when_choice>
        </choice_question_test_action>
        <choice_question_test_action question_ref="ocil:navy.navwar.niwcatlantic.scc.sql.server:question:5501" id="ocil:navy.navwar.niwcatlantic.scc.sql.server:testaction:5501">
          <title>CAT I, V-251040, SV-251040r962034, SRG-APP-000416-DB-000380</title>
          <when_choice>
            <result>FAIL</result>
            <choice_ref>ocil:navy.navwar.niwcatlantic.scc:choice:1</choice_ref>
          </when_choice>
          <when_choice>
            <result>PASS</result>
            <choice_ref>ocil:navy.navwar.niwcatlantic.scc:choice:2</choice_ref>
          </when_choice>
          <when_choice>
            <result>NOT_APPLICABLE</result>
            <choice_ref>ocil:navy.navwar.niwcatlantic.scc:choice:3</choice_ref>
          </when_choice>
          <when_choice>
            <result>NOT_TESTED</result>
            <choice_ref>ocil:navy.navwar.niwcatlantic.scc:choice:4</choice_ref>
          </when_choice>
        </choice_question_test_action>
        <string_question_test_action question_ref="ocil:navy.navwar.niwcatlantic.scc.ms.sql.server.db.hybrid:question:21390001" id="ocil:navy.navwar.niwcatlantic.scc.ms.sql.server.db.hybrid:testaction:21390001">
          <title>CAT I, V-213900, SV-213900r1043176, SRG-APP-000023-DB-000001</title>
          <when_pattern>
            <result>UNKNOWN</result>
            <pattern>^.*$</pattern>
          </when_pattern>
        </string_question_test_action>
        <string_question_test_action question_ref="ocil:navy.navwar.niwcatlantic.scc.ms.sql.server.db.hybrid:question:21390301" id="ocil:navy.navwar.niwcatlantic.scc.ms.sql.server.db.hybrid:testaction:21390301">
          <title>CAT III, V-213903, SV-213903r960864, SRG-APP-000080-DB-000063</title>
          <when_pattern>
            <result>UNKNOWN</result>
            <pattern>^.*$</pattern>
          </when_pattern>
        </string_question_test_action>
        <string_question_test_action question_ref="ocil:navy.navwar.niwcatlantic.scc.ms.sql.server.db.hybrid:question:21390401" id="ocil:navy.navwar.niwcatlantic.scc.ms.sql.server.db.hybrid:testaction:21390401">
          <title>CAT II, V-213904, SV-213904r960864, SRG-APP-000080-DB-000063</title>
          <when_pattern>
            <result>UNKNOWN</result>
            <pattern>^.*$</pattern>
          </when_pattern>
        </string_question_test_action>
        <string_question_test_action question_ref="ocil:navy.navwar.niwcatlantic.scc.ms.sql.server.db.hybrid:question:21390501" id="ocil:navy.navwar.niwcatlantic.scc.ms.sql.server.db.hybrid:testaction:21390501">
          <title>CAT II, V-213905, SV-213905r960882, SRG-APP-000090-DB-000065</title>
          <when_pattern>
            <result>UNKNOWN</result>
            <pattern>^.*$</pattern>
          </when_pattern>
        </string_question_test_action>
        <string_question_test_action question_ref="ocil:navy.navwar.niwcatlantic.scc.ms.sql.server.db.hybrid:question:21390601" id="ocil:navy.navwar.niwcatlantic.scc.ms.sql.server.db.hybrid:testaction:21390601">
          <title>CAT II, V-213906, SV-213906r960960, SRG-APP-000133-DB-000179</title>
          <when_pattern>
            <result>UNKNOWN</result>
            <pattern>^.*$</pattern>
          </when_pattern>
        </string_question_test_action>
        <string_question_test_action question_ref="ocil:navy.navwar.niwcatlantic.scc.ms.sql.server.db.hybrid:question:21390701" id="ocil:navy.navwar.niwcatlantic.scc.ms.sql.server.db.hybrid:testaction:21390701">
          <title>CAT II, V-213907, SV-213907r960960, SRG-APP-000133-DB-000179</title>
          <when_pattern>
            <result>UNKNOWN</result>
            <pattern>^.*$</pattern>
          </when_pattern>
        </string_question_test_action>
        <string_question_test_action question_ref="ocil:navy.navwar.niwcatlantic.scc.ms.sql.server.db.hybrid:question:21390801" id="ocil:navy.navwar.niwcatlantic.scc.ms.sql.server.db.hybrid:testaction:21390801">
          <title>CAT II, V-213908, SV-213908r960960, SRG-APP-000133-DB-000200</title>
          <when_pattern>
            <result>UNKNOWN</result>
            <pattern>^.*$</pattern>
          </when_pattern>
        </string_question_test_action>
        <string_question_test_action question_ref="ocil:navy.navwar.niwcatlantic.scc.ms.sql.server.db.hybrid:question:21390901" id="ocil:navy.navwar.niwcatlantic.scc.ms.sql.server.db.hybrid:testaction:21390901">
          <title>CAT II, V-213909, SV-213909r960960, SRG-APP-000133-DB-000362</title>
          <when_pattern>
            <result>UNKNOWN</result>
            <pattern>^.*$</pattern>
          </when_pattern>
        </string_question_test_action>
        <string_question_test_action question_ref="ocil:navy.navwar.niwcatlantic.scc.ms.sql.server.16.db.hybrid:question:21391001" id="ocil:navy.navwar.niwcatlantic.scc.ms.sql.server.16.db.hybrid:testaction:21391001">
          <title>CAT II, V-213910, SV-213910r961125, SRG-APP-000226-DB-000147</title>
          <when_pattern>
            <result>UNKNOWN</result>
            <pattern>^.*$</pattern>
          </when_pattern>
        </string_question_test_action>
        <string_question_test_action question_ref="ocil:navy.navwar.niwcatlantic.scc.ms.sql.server.db.hybrid:question:21391201" id="ocil:navy.navwar.niwcatlantic.scc.ms.sql.server.db.hybrid:testaction:21391201">
          <title>CAT II, V-213912, SV-213912r961128, SRG-APP-000231-DB-000154</title>
          <when_pattern>
            <result>UNKNOWN</result>
            <pattern>^.*$</pattern>
          </when_pattern>
        </string_question_test_action>
        <string_question_test_action question_ref="ocil:navy.navwar.niwcatlantic.scc.ms.sql.server.db.hybrid:question:21392101" id="ocil:navy.navwar.niwcatlantic.scc.ms.sql.server.db.hybrid:testaction:21392101">
          <title>CAT III, V-213921, SV-213921r961317, SRG-APP-000328-DB-000301</title>
          <when_pattern>
            <result>UNKNOWN</result>
            <pattern>^.*$</pattern>
          </when_pattern>
        </string_question_test_action>
        <string_question_test_action question_ref="ocil:navy.navwar.niwcatlantic.scc.ms.sql.server.db.hybrid:question:21392201" id="ocil:navy.navwar.niwcatlantic.scc.ms.sql.server.db.hybrid:testaction:21392201">
          <title>CAT II, V-213922, SV-213922r961359, SRG-APP-000342-DB-000302</title>
          <when_pattern>
            <result>UNKNOWN</result>
            <pattern>^.*$</pattern>
          </when_pattern>
        </string_question_test_action>
        <string_question_test_action question_ref="ocil:navy.navwar.niwcatlantic.scc.ms.sql.server.db.hybrid:question:21392301" id="ocil:navy.navwar.niwcatlantic.scc.ms.sql.server.db.hybrid:testaction:21392301">
          <title>CAT II, V-213923, SV-213923r1018608, SRG-APP-000378-DB-000365</title>
          <when_pattern>
            <result>UNKNOWN</result>
            <pattern>^.*$</pattern>
          </when_pattern>
        </string_question_test_action>
        <string_question_test_action question_ref="ocil:navy.navwar.niwcatlantic.scc.ms.sql.server.db.hybrid:question:21392401" id="ocil:navy.navwar.niwcatlantic.scc.ms.sql.server.db.hybrid:testaction:21392401">
          <title>CAT II, V-213924, SV-213924r961461, SRG-APP-000380-DB-000360</title>
          <when_pattern>
            <result>UNKNOWN</result>
            <pattern>^.*$</pattern>
          </when_pattern>
        </string_question_test_action>
        <string_question_test_action question_ref="ocil:navy.navwar.niwcatlantic.scc.ms.sql.server.db.hybrid:question:21392601" id="ocil:navy.navwar.niwcatlantic.scc.ms.sql.server.db.hybrid:testaction:21392601">
          <title>CAT I, V-213927, SV-213927r1018577, SRG-APP-000429-DB-000387</title>
          <when_pattern>
            <result>UNKNOWN</result>
            <pattern>^.*$</pattern>
          </when_pattern>
        </string_question_test_action>
        <string_question_test_action question_ref="ocil:navy.navwar.niwcatlantic.scc.ms.sql.server.db.hybrid:question:25104001" id="ocil:navy.navwar.niwcatlantic.scc.ms.sql.server.db.hybrid:testaction:25104001">
          <title>CAT I, V-251040, SV-251040r962034, SRG-APP-000416-DB-000380</title>
          <when_pattern>
            <result>UNKNOWN</result>
            <pattern>^.*$</pattern>
          </when_pattern>
        </string_question_test_action>
      </test_actions>
      <questions>
        <string_question id="ocil:navy.navwar.niwcatlantic.scc.ms.sql.server.db.hybrid:question:25104001">
          <question_text>Review system documentation to determine whether cryptography for classified or sensitive information is required by the information owner.
Valid 'cryptography_required' options are:
YES
NO
				</question_text>
        </string_question>
        <string_question id="ocil:navy.navwar.niwcatlantic.scc.ms.sql.server.db.hybrid:question:21392601">
          <question_text>Note:  This check covers two duplicate requirements in the SQL Database STIG:
Vul ID: V-213926	   	Rule ID: SV-213926r1018576_rule	   	STIG ID: SQL6-D0-003300
Vul ID: V-213927	   	Rule ID: SV-213927r1018577_rule	   	STIG ID: SQL6-D0-003400	

Enter the required database tranparent data encryption (TDE) requirements.  Valid 'encryption_state' options are:
NoDatabaseEncryptionKey
Unencrypted
Encrypted

Example:
DATABASE:ALL=NoDatabaseEncryptionKey</question_text>
        </string_question>
        <string_question id="ocil:navy.navwar.niwcatlantic.scc.ms.sql.server.db.hybrid:question:21392401">
          <question_text>Enter the documented and authorized list databases whose owner is a member of a fixed server role.
				</question_text>
        </string_question>
        <string_question id="ocil:navy.navwar.niwcatlantic.scc.ms.sql.server.db.hybrid:question:21392301">
          <question_text>Enter the list users and roles who are authorized to create, alter, or replace logic modules.
				</question_text>
        </string_question>
        <string_question id="ocil:navy.navwar.niwcatlantic.scc.ms.sql.server.db.hybrid:question:21392201">
          <question_text>Enter the list of stored procedures that are authorized to utilize impersonation.
				</question_text>
        </string_question>
        <string_question id="ocil:navy.navwar.niwcatlantic.scc.ms.sql.server.db.hybrid:question:21392101">
          <question_text>Enter the list of database user names that are authorized to own schema, own objects and assign additional permissions.
				</question_text>
        </string_question>
        <string_question id="ocil:navy.navwar.niwcatlantic.scc.ms.sql.server.db.hybrid:question:21391201">
          <question_text>Enter the list of database names that have been documented to have the correct encryption type.
				</question_text>
        </string_question>
        <string_question id="ocil:navy.navwar.niwcatlantic.scc.ms.sql.server.16.db.hybrid:question:21391001">
          <question_text>Enter the authorized/documented database recovery model
Valid 'recovery_model_desc' options are:
Simple
Full
Bulk-logged
				</question_text>
        </string_question>
        <string_question id="ocil:navy.navwar.niwcatlantic.scc.ms.sql.server.db.hybrid:question:21390901">
          <question_text>Enter the list of users and roles who are authorized to modify database structure and logic modules from the server documentation (role = 'db_ddladmin' or 'db_owner)
				</question_text>
        </string_question>
        <string_question id="ocil:navy.navwar.niwcatlantic.scc.ms.sql.server.db.hybrid:question:21390801">
          <question_text>Enter the list of authorized database object owners (user names)
				</question_text>
        </string_question>
        <string_question id="ocil:navy.navwar.niwcatlantic.scc.ms.sql.server.db.hybrid:question:21390701">
          <question_text>Enter the list of schema to owner in the format of: schema_name:owning_principal  (no space between fields, just a colon)
Example:
DATABASE:ALL=db_accessadmin:db_accessadmin, db_backupoperator:db_backupoperator, db_datareader:db_datareader, db_datawriter:db_datawriter, db_ddladmin:db_ddladmin, db_denydatareader:db_denydatareader, db_denydatawriter:db_denydatawriter, db_owner:db_owner, db_securityadmin:db_securityadmin, dbo:dbo, guest:guest, INFORMATION_SCHEMA:INFORMATION_SCHEMA, sys:sys
				</question_text>
        </string_question>
        <string_question id="ocil:navy.navwar.niwcatlantic.scc.ms.sql.server.db.hybrid:question:21390601">
          <question_text>Enter the list of database user names and roles who are authorized to change stored procedures, functions, and triggers from the server documentation. (role = 'db_ddladmin' or 'db_owner)
				</question_text>
        </string_question>
        <string_question id="ocil:navy.navwar.niwcatlantic.scc.ms.sql.server.db.hybrid:question:21390501">
          <question_text>Enter the list of approved audit maintainers from the system documentation. 
				</question_text>
        </string_question>
        <string_question id="ocil:navy.navwar.niwcatlantic.scc.ms.sql.server.db.hybrid:question:21390401">
          <question_text>Enter the list of database owners authorized to be trustworthy and privileged
				</question_text>
        </string_question>
        <string_question id="ocil:navy.navwar.niwcatlantic.scc.ms.sql.server.db.hybrid:question:21390301">
          <question_text>Enter the list of database tables that are required to be temporal. If no database tables are required to be temporal, enter "NONE_REQUIRED" without quotes.
				</question_text>
        </string_question>
        <string_question id="ocil:navy.navwar.niwcatlantic.scc.ms.sql.server.db.hybrid:question:21390001">
          <question_text>If contained databases are enabled, and if mixed mode authentication is in use:  
From the documentation, obtain the list of accounts authorized to be managed by SQL Server.
Determine the accounts (SQL Logins) actually managed by SQL Server.
				</question_text>
        </string_question>
        <choice_question id="ocil:navy.navwar.niwcatlantic.scc.sql.server:question:101" default_answer_ref="ocil:navy.navwar.niwcatlantic.scc:choice:4">
          <question_text>Determine if SQL Server is configured to allow the use of contained databases, if it is, take the appropriate precautions to limit their risk.

1) In the Object Explorer in SQL Server Management Studio (SSMS), right-click on the server instance, select "Properties", and then select the "Advanced" page.
If "Enabled Contained Databases" is "False", this is not a finding.

2) If "Enabled Contained Databases" is "True", then in a query interface such as the SSMS Transact-SQL editor, run the statement:
EXEC sp_configure 'contained database authentication'
If the returned value in the "config_value" and/or "run_value" column is "0", this is not a finding.

3) Determine whether SQL Server is configured to use only Windows authentication.
In a query interface such as the SSMS Transact-SQL editor, run the statement:
SELECT CASE SERVERPROPERTY('IsIntegratedSecurityOnly')  
 WHEN 1 THEN 'Windows Authentication'  
 WHEN 0 THEN 'Windows and SQL Server Authentication'  
END as [Authentication Mode]
If the returned value in the "Authentication Mode" column is "Windows Authentication", this is not a finding.

If mixed mode (both SQL Server authentication and Windows authentication) is in use, then it must be documented and approved.

From the documentation, obtain the list of accounts authorized to be managed by SQL Server.
Determine the accounts (SQL Logins) actually managed by SQL Server.

Run the statement:

SELECT name
FROM sys.database_principals
WHERE type_desc = 'SQL_USER'
AND authentication_type_desc = 'DATABASE';

If any accounts listed by the query are not listed in the documentation, this is a finding.
Documentation must be approved by the information system security officer (ISSO)/ information system security manager (ISSM).

References:
SV-93767
V-79061
CCI-000015</question_text>
          <choice_group_ref>ocil:navy.navwar.niwcatlantic.scc:choicegroup:1</choice_group_ref>
        </choice_question>
        <choice_question id="ocil:navy.navwar.niwcatlantic.scc.sql.server:question:301" default_answer_ref="ocil:navy.navwar.niwcatlantic.scc:choice:4">
          <question_text>Review the system documentation to determine the required levels of protection for securables in the database by type of login. 

If the database is tempdb, this is not applicable.

Review the permissions actually in place in the database. 

If the actual permissions do not match the documented requirements, this is a finding.

Use the supplemental file "Database permission assignments to users and roles.sql".

References:
SV-93771
V-79065
CCI-000213</question_text>
          <choice_group_ref>ocil:navy.navwar.niwcatlantic.scc:choicegroup:1</choice_group_ref>
        </choice_question>
        <choice_question id="ocil:navy.navwar.niwcatlantic.scc.sql.server:question:501" default_answer_ref="ocil:navy.navwar.niwcatlantic.scc:choice:4">
          <question_text>Execute the following query:

SELECT name
FROM sys.database_principals
WHERE type in ('U','G')
AND name LIKE '%$'

If no users are returned, this is not a finding.

If users are returned, determine whether each user is a computer account.

Launch PowerShell.

Execute the following code:

Note: &lt;name&gt; represents the username portion of the user. For example; if the user is "CONTOSO\user1$", the username is "user1".

([ADSISearcher]"(&amp;(ObjectCategory=Computer)(Name=&lt;name&gt;))").FindAll()

If no account information is returned, this is not a finding.

If account information is returned, this is a finding.

References:
SV-93773
V-79067
CCI-000166</question_text>
          <choice_group_ref>ocil:navy.navwar.niwcatlantic.scc:choicegroup:1</choice_group_ref>
        </choice_question>
        <choice_question id="ocil:navy.navwar.niwcatlantic.scc.sql.server:question:701" default_answer_ref="ocil:navy.navwar.niwcatlantic.scc:choice:4">
          <question_text>Check the server documentation to determine if collecting and keeping historical versions of a table is required.

If collecting and keeping historical versions of a table is NOT required, this is not a finding.

Find all of the temporal tables in the database using the following query:

SELECT SCHEMA_NAME(T.schema_id) AS schema_name, T.name AS table_name, T.temporal_type_desc, SCHEMA_NAME(H.schema_id) + '.' + H.name AS history_table
FROM sys.tables T
JOIN sys.tables H ON T.history_table_id = H.object_id
WHERE T.temporal_type != 0
ORDER BY schema_name, table_name

Using the system documentation, determine which tables are required to be temporal tables.

If any tables listed in the documentation are not in the list created by running the above statement, this is a finding.

Ensure a field exists documenting the login and/or user who last modified the record. 

If this does not exist, this is a finding.

References:
SV-93775
V-79069
CCI-000166</question_text>
          <choice_group_ref>ocil:navy.navwar.niwcatlantic.scc:choicegroup:1</choice_group_ref>
        </choice_question>
        <choice_question id="ocil:navy.navwar.niwcatlantic.scc.sql.server:question:901" default_answer_ref="ocil:navy.navwar.niwcatlantic.scc:choice:4">
          <question_text>If the database being reviewed is MSDB, trustworthy is required to be enabled, and therefore this is not a finding.

Execute the following query:

SELECT SUSER_SNAME(d.owner_sid) AS DatabaseOwner,
CASE
WHEN d.is_trustworthy_on = 0 THEN 'No'
WHEN d.is_trustworthy_on = 1 THEN 'Yes'
END AS IsTrustworthy,
CASE
WHEN role.name IN ('sysadmin','securityadmin')
OR permission.permission_name = 'CONTROL SERVER'
THEN 'YES'
ELSE 'No'
END AS 'IsOwnerPrivileged'
FROM sys.databases d
LEFT JOIN sys.server_principals login ON d.owner_sid = login.sid
LEFT JOIN sys.server_role_members rm ON login.principal_id = rm.member_principal_id
LEFT JOIN sys.server_principals role ON rm.role_principal_id = role.principal_id
LEFT JOIN sys.server_permissions permission ON login.principal_id = permission.grantee_principal_id
WHERE d.name = DB_NAME()

If trustworthy is not enabled, this is not a finding.

If trustworthy is enabled and the database owner is not a privileged account, this is not a finding.

If trustworthy is enabled and the database owner is a privileged account, review the system documentation to determine if the trustworthy property is required and authorized. If this is not documented, this is a finding.

References:
SV-93777
V-79071
CCI-000166</question_text>
          <choice_group_ref>ocil:navy.navwar.niwcatlantic.scc:choicegroup:1</choice_group_ref>
        </choice_question>
        <choice_question id="ocil:navy.navwar.niwcatlantic.scc.sql.server:question:1101" default_answer_ref="ocil:navy.navwar.niwcatlantic.scc:choice:4">
          <question_text>Obtain the list of approved audit maintainers from the system documentation.

Use the following query to review database roles and their membership, all of which enable the ability to create and maintain audit specifications.

SELECT
    R.name AS role_name,
    RM.name AS role_member_name,
    RM.type_desc
FROM sys.database_principals R
JOIN sys.database_role_members DRM ON 
    R.principal_id = DRM.role_principal_id
JOIN sys.database_principals RM ON 
    DRM.member_principal_id = RM.principal_id
WHERE R.type = 'R'
    AND R.name = 'db_owner'
ORDER BY 
    role_member_name

If any role memberships are not documented and authorized, this is a finding.	


Review the database roles and individual users that have the following permissions, all of which enable the ability to create and maintain audit definitions.

ALTER ANY DATABASE AUDIT
CONTROL

Use the following query to determine the roles and users that have the listed permissions:

SELECT
	PERM.permission_name,
	DP.name AS principal_name,
	DP.type_desc AS principal_type,
	DBRM.role_member_name
FROM sys.database_permissions PERM
JOIN sys.database_principals DP ON PERM.grantee_principal_id = DP.principal_id
LEFT OUTER JOIN (
	SELECT
		R.principal_id AS role_principal_id,
		R.name AS role_name,
		RM.name AS role_member_name
	FROM sys.database_principals R
	JOIN sys.database_role_members DRM ON R.principal_id = DRM.role_principal_id
	JOIN sys.database_principals RM ON DRM.member_principal_id = RM.principal_id
	WHERE R.type = 'R'
) DBRM ON DP.principal_id = DBRM.role_principal_id
WHERE PERM.permission_name IN ('CONTROL','ALTER ANY DATABASE AUDIT')
ORDER BY
	permission_name, 
	principal_name, 
	role_member_name


If any of the roles or users returned have permissions that are not documented, or the documented audit maintainers do not have permissions, this is a finding.

References:
SV-93779
V-79073
CCI-000171</question_text>
          <choice_group_ref>ocil:navy.navwar.niwcatlantic.scc:choicegroup:1</choice_group_ref>
        </choice_question>
        <choice_question id="ocil:navy.navwar.niwcatlantic.scc.sql.server:question:1301" default_answer_ref="ocil:navy.navwar.niwcatlantic.scc:choice:4">
          <question_text>Obtain a listing of users and roles who are authorized to change stored procedures, functions, and triggers from the server documentation.

In each user database, execute the following query:

SELECT P.type_desc AS principal_type, P.name AS principal_name, O.type_desc,
  CASE class
   WHEN 0 THEN DB_NAME()
   WHEN 1 THEN OBJECT_SCHEMA_NAME(major_id) + '.' + OBJECT_NAME(major_id)
   WHEN 3 THEN SCHEMA_NAME(major_id)
    ELSE class_desc + '(' + CAST(major_id AS nvarchar) + ')'
   END AS securable_name, DP.state_desc, DP.permission_name
FROM sys.database_permissions DP
JOIN sys.database_principals P ON DP.grantee_principal_id = P.principal_id
LEFT OUTER JOIN sys.all_objects O ON O.object_id = DP.major_id AND O.type IN ('TR','TA','P','X','RF','PC','IF','FN','TF','U')
WHERE DP.type IN ('AL','ALTG') AND DP.class IN (0, 1, 53)

SELECT R.name AS role_name, M.type_desc AS principal_type, M.name AS principal_name
FROM sys.database_principals R
JOIN sys.database_role_members DRM ON R.principal_id = DRM.role_principal_id
JOIN sys.database_principals M ON DRM.member_principal_id = M.principal_id
WHERE R.name IN ('db_ddladmin','db_owner')
   AND M.name != 'dbo'

If any users or role permissions returned are not authorized to modify the specified object or type, this is a finding.

If any user or role membership is not authorized, this is a finding.

References:
SV-93781
V-79075
CCI-001499</question_text>
          <choice_group_ref>ocil:navy.navwar.niwcatlantic.scc:choicegroup:1</choice_group_ref>
        </choice_question>
        <choice_question id="ocil:navy.navwar.niwcatlantic.scc.sql.server:question:1501" default_answer_ref="ocil:navy.navwar.niwcatlantic.scc:choice:4">
          <question_text>Obtain a listing of schema ownership from the server documentation.

Execute the following query to obtain a current listing of schema ownership.

SELECT S.name AS schema_name, P.name AS owning_principal
FROM sys.schemas S
JOIN sys.database_principals P ON S.principal_id = P.principal_id
ORDER BY schema_name

If any schema is owned by an unauthorized database principal, this is a finding.

References:
SV-93783
V-79077
CCI-001499</question_text>
          <choice_group_ref>ocil:navy.navwar.niwcatlantic.scc:choicegroup:1</choice_group_ref>
        </choice_question>
        <choice_question id="ocil:navy.navwar.niwcatlantic.scc.sql.server:question:1701" default_answer_ref="ocil:navy.navwar.niwcatlantic.scc:choice:4">
          <question_text>Review system documentation to identify SQL Server accounts authorized to own database objects. 

If the SQL Server database ownership list does not exist or needs to be updated, this is a finding. 

The following query can be of use in making this determination: 

;with objects_cte as
(SELECT o.name, o.type_desc,
   CASE
    WHEN o.principal_id is null then s.principal_id
     ELSE o.principal_id
    END as principal_id
 FROM sys.objects o
 INNER JOIN sys.schemas s
 ON o.schema_id = s.schema_id
 WHERE o.is_ms_shipped = 0
)
SELECT cte.name, cte.type_desc, dp.name as ObjectOwner 
FROM objects_cte cte
INNER JOIN sys.database_principals dp
ON cte.principal_id = dp.principal_id
ORDER BY dp.name, cte.name

If any of the listed owners is not authorized, this is a finding.

References:
SV-93785
V-79079
CCI-001499</question_text>
          <choice_group_ref>ocil:navy.navwar.niwcatlantic.scc:choicegroup:1</choice_group_ref>
        </choice_question>
        <choice_question id="ocil:navy.navwar.niwcatlantic.scc.sql.server:question:1901" default_answer_ref="ocil:navy.navwar.niwcatlantic.scc:choice:4">
          <question_text>Obtain a listing of users and roles who are authorized to modify database structure and logic modules from the server documentation.

Execute the following query:
SELECT P.type_desc AS principal_type, P.name AS principal_name, O.type_desc,
   CASE class
    WHEN 0 THEN DB_NAME()
    WHEN 1 THEN OBJECT_SCHEMA_NAME(major_id) + '.' + OBJECT_NAME(major_id)
    WHEN 3 THEN SCHEMA_NAME(major_id)
      ELSE class_desc + '(' + CAST(major_id AS nvarchar) + ')'
   END AS securable_name, DP.state_desc, DP.permission_name
FROM sys.database_permissions DP
JOIN sys.database_principals P ON DP.grantee_principal_id = P.principal_id
LEFT OUTER JOIN sys.all_objects O ON O.object_id = DP.major_id AND O.type IN ('TR','TA','P','X','RF','PC','IF','FN','TF','U')
WHERE DP.type IN ('AL','ALTG') AND DP.class IN (0, 1, 53)

SELECT R.name AS role_name, M.type_desc AS principal_type, M.name AS principal_name
FROM sys.database_principals R
JOIN sys.database_role_members DRM ON R.principal_id = DRM.role_principal_id
JOIN sys.database_principals M ON DRM.member_principal_id = M.principal_id
WHERE R.name IN ('db_ddladmin','db_owner')
AND M.name != 'dbo'

If any users or role permissions returned are not authorized to modify the specified object or type, this is a finding.

If any user or role membership is not authorized, this is a finding.

References:
SV-93787
V-79081
CCI-001499</question_text>
          <choice_group_ref>ocil:navy.navwar.niwcatlantic.scc:choicegroup:1</choice_group_ref>
        </choice_question>
        <choice_question id="ocil:navy.navwar.niwcatlantic.scc.sql.server:question:2101" default_answer_ref="ocil:navy.navwar.niwcatlantic.scc:choice:4">
          <question_text>Review the system security plan (SSP) to determine whether the database is static, the recovery model to be used, the backup schedule, and the plan for testing database restoration.

If the SSP does not state that the database is static, assume that it is not static. If any of the other information is absent, this is a finding. 

If the database is not static, and the documented recovery model is Bulk Logged, but the justification and authorization for this are not documented, this is a finding. 

Run the following to determine Recovery Model:

USE [master]
GO

SELECT name, recovery_model_desc
FROM sys.databases
ORDER BY name

If the recovery model description does not match the documented recovery model, this is a finding. 

Review the jobs set up to implement the backup plan. If they are absent, this is a finding. 

Check the history of the backups by running the following query.  It checks the last 30 days of backups by database.
USE [msdb]
GO

SELECT database_name, 
   CASE type
    WHEN 'D' THEN 'Full'
    WHEN 'I' THEN 'Differential'
    WHEN 'L' THEN 'Log'
   ELSE type
   END AS backup_type,
 is_copy_only,
 backup_start_date, backup_finish_date
FROM dbo.backupset
WHERE backup_start_date &gt;= dateadd(day, - 30, getdate()) 
ORDER BY database_name, backup_start_date DESC

If the history indicates a pattern of job failures by missing or gaps in backups, this is a finding. 

Review evidence that database recovery is tested annually or more often, and that the most recent test was successful. If not, this is a finding.

References:
SV-93789
V-79083
CCI-001665</question_text>
          <choice_group_ref>ocil:navy.navwar.niwcatlantic.scc:choicegroup:1</choice_group_ref>
        </choice_question>
        <choice_question id="ocil:navy.navwar.niwcatlantic.scc.sql.server:question:2301" default_answer_ref="ocil:navy.navwar.niwcatlantic.scc:choice:4">
          <question_text>From the query prompt: 

SELECT name 
FROM [master].sys.databases 
WHERE state = 0 

Repeat for each database: 
From the query prompt: 
USE [database name] 
SELECT COUNT(name) 
FROM sys.symmetric_keys s, sys.key_encryptions k 
WHERE s.name = '##MS_DatabaseMasterKey##' 
AND s.symmetric_key_id = k.key_id 
AND k.crypt_type in ('ESKP', 'ESP2', 'ESP3')

If the value returned is zero, this is not applicable.

If the value returned is greater than zero, a Database Master Key exists and is encrypted with a password. 

Review procedures and evidence of password requirements used to encrypt Database Master Keys. 

If the passwords are not required to meet DoD password standards, currently a minimum of 15 characters with at least 1 upper-case character, 1 lower-case character, 1 special character, and 1 numeric character, and at least 8 characters changed from the previous password, this is a finding.

References:
SV-93791
V-79085
CCI-001199</question_text>
          <choice_group_ref>ocil:navy.navwar.niwcatlantic.scc:choicegroup:1</choice_group_ref>
        </choice_question>
        <choice_question id="ocil:navy.navwar.niwcatlantic.scc.sql.server:question:2501" default_answer_ref="ocil:navy.navwar.niwcatlantic.scc:choice:4">
          <question_text>If no databases require encryption, this is not a finding. 

From the query prompt: 

SELECT name 
FROM [master].sys.databases 
WHERE is_master_key_encrypted_by_server = 1 
AND owner_sid &lt;&gt; 1 
AND state = 0; 
(Note that this query assumes that the [sa] account is not used as the owner of application databases, in keeping with other STIG guidance. If this is not the case, modify the query accordingly.) 

If no databases are returned by the query, this is not a finding. 

For any databases returned, verify in the System Security Plan that encryption of the Database Master Key using the Service Master Key is acceptable and approved by the Information Owner, and the encrypted data does not require additional protections to deter or detect DBA access. If not approved, this is a finding. 

If approved and additional protections are required, then verify the additional requirements are in place in accordance with the System Security Plan. These may include additional auditing on access of the Database Master Key with alerts or other automated monitoring. 

If the additional requirements are not in place, this is a finding.

References:
SV-93793
V-79087
CCI-001199</question_text>
          <choice_group_ref>ocil:navy.navwar.niwcatlantic.scc:choicegroup:1</choice_group_ref>
        </choice_question>
        <choice_question id="ocil:navy.navwar.niwcatlantic.scc.sql.server:question:2701" default_answer_ref="ocil:navy.navwar.niwcatlantic.scc:choice:4">
          <question_text>If the application owner and authorizing official have determined that encryption of data at rest is not required, this is not a finding.

Review procedures for and evidence of backup of the Certificate used for encryption in the System Security Plan. 

If the procedures or evidence does not exist, this is a finding. 

If the procedures do not indicate that a backup of the Certificate used for encryption is stored in a secure location that is not on the SQL Server, this is a finding. 

If procedures do not indicate access restrictions to the Certificate backup, this is a finding.

References:
SV-93795
V-79089
CCI-001199</question_text>
          <choice_group_ref>ocil:navy.navwar.niwcatlantic.scc:choicegroup:1</choice_group_ref>
        </choice_question>
        <choice_question id="ocil:navy.navwar.niwcatlantic.scc.sql.server:question:2901" default_answer_ref="ocil:navy.navwar.niwcatlantic.scc:choice:4">
          <question_text>Determine elements of security functionality (lists of permissions, additional authentication information, stored procedures, application specific auditing, etc.) that are being housed inside SQL server.

For any elements found, check SQL Server to determine if these objects or code implementing security functionality are located in a separate security domain, such as a separate database, schema, or table created specifically for security functionality.

If the database is a SQL Server default database (master, msdb, model, tempdb), this is NA.

Run the following query to list all the user-defined databases:

SELECT Name 
FROM sys.databases 
WHERE database_id &gt; 4 
ORDER BY 1;

Review the database structure to determine where security related functionality is stored. If security-related database objects or code are not kept separate, this is a finding.

References:
SV-93797
V-79091
CCI-001084</question_text>
          <choice_group_ref>ocil:navy.navwar.niwcatlantic.scc:choicegroup:1</choice_group_ref>
        </choice_question>
        <choice_question id="ocil:navy.navwar.niwcatlantic.scc.sql.server:question:3101" default_answer_ref="ocil:navy.navwar.niwcatlantic.scc:choice:4">
          <question_text>Review the procedures for the refreshing of development/test data from production. Review any scripts or code that exists for the movement of production data to development/test systems, or to any other location or for any other purpose. Verify that copies of production data are not left in unprotected locations. If the code that exists for data movement does not comply with the organization-defined data transfer policy and/or fails to remove any copies of production data from unprotected locations, this is a finding.

References:
SV-93799
V-79093
CCI-001090</question_text>
          <choice_group_ref>ocil:navy.navwar.niwcatlantic.scc:choicegroup:1</choice_group_ref>
        </choice_question>
        <choice_question id="ocil:navy.navwar.niwcatlantic.scc.sql.server:question:3301" default_answer_ref="ocil:navy.navwar.niwcatlantic.scc:choice:4">
          <question_text>Review DBMS code (stored procedures, functions, triggers), application code, settings, column and field definitions, and constraints to determine whether the database is protected against invalid input. 

If code exists that allows invalid data to be acted upon or input into the database, this is a finding. 

If column/field definitions are not reflective of the data, this is a finding. 

If columns/fields do not contain constraints and validity checking where required, this is a finding. 

Where a column/field is noted in the system documentation as necessarily free-form, even though its name and context suggest that it should be strongly typed and constrained, the absence of these protections is not a finding. 

Where a column/field is clearly identified by name, caption or context as Notes, Comments, Description, Text, etc., the absence of these protections is not a finding.

References:
SV-93801
V-79095
CCI-001310</question_text>
          <choice_group_ref>ocil:navy.navwar.niwcatlantic.scc:choicegroup:1</choice_group_ref>
        </choice_question>
        <choice_question id="ocil:navy.navwar.niwcatlantic.scc.sql.server:question:3501" default_answer_ref="ocil:navy.navwar.niwcatlantic.scc:choice:4">
          <question_text>Review application behavior and custom database code (stored procedures, triggers), to determine whether error messages contain information beyond what is needed for explaining the issue to general users.

If database error messages contain PII data, sensitive business data, or information useful for identifying the host system or database structure, this is a finding.

References:
SV-93803
V-79097
CCI-001312</question_text>
          <choice_group_ref>ocil:navy.navwar.niwcatlantic.scc:choicegroup:1</choice_group_ref>
        </choice_question>
        <choice_question id="ocil:navy.navwar.niwcatlantic.scc.sql.server:question:3701" default_answer_ref="ocil:navy.navwar.niwcatlantic.scc:choice:4">
          <question_text>If security labeling is not required, this is not a finding.

If security labeling requirements have been specified, but neither a third-party solution nor a SQL Server Row-Level security solution is implemented that reliably maintains labels on information in storage, this is a finding.

References:
SV-93805
V-79099
CCI-002262</question_text>
          <choice_group_ref>ocil:navy.navwar.niwcatlantic.scc:choicegroup:1</choice_group_ref>
        </choice_question>
        <choice_question id="ocil:navy.navwar.niwcatlantic.scc.sql.server:question:3901" default_answer_ref="ocil:navy.navwar.niwcatlantic.scc:choice:4">
          <question_text>If security labeling is not required, this is not a finding.

If security labeling requirements have been specified, but neither a third-party solution nor a SQL Server Row-Level security solution is implemented that reliably maintains labels on information in process, this is a finding.

References:
SV-93807
V-79101
CCI-002263</question_text>
          <choice_group_ref>ocil:navy.navwar.niwcatlantic.scc:choicegroup:1</choice_group_ref>
        </choice_question>
        <choice_question id="ocil:navy.navwar.niwcatlantic.scc.sql.server:question:4101" default_answer_ref="ocil:navy.navwar.niwcatlantic.scc:choice:4">
          <question_text>If security labeling is not required, this is not a finding.

If security labeling requirements have been specified, but neither a third-party solution nor a SQL Server Row-Level security solution is implemented that reliably maintains labels on information in transmission, this is a finding.

References:
SV-93809
V-79103
CCI-002264</question_text>
          <choice_group_ref>ocil:navy.navwar.niwcatlantic.scc:choicegroup:1</choice_group_ref>
        </choice_question>
        <choice_question id="ocil:navy.navwar.niwcatlantic.scc.sql.server:question:4301" default_answer_ref="ocil:navy.navwar.niwcatlantic.scc:choice:4">
          <question_text>Review system documentation to determine requirements for object ownership and authorization delegation.

Use the following query to discover database object ownership:

Schemas not owned by the schema or dbo:

SELECT name AS schema_name, USER_NAME(principal_id) AS schema_owner
FROM sys.schemas
WHERE schema_id != principal_id
 AND principal_id != 1

Objects owned by an individual principal:

SELECT object_id, name AS securable, 
  USER_NAME(principal_id) AS object_owner,
  type_desc
FROM sys.objects
WHERE is_ms_shipped = 0 AND principal_id IS NOT NULL
ORDER BY type_desc, securable, object_owner

Use the following query to discover database users who have been delegated the right to assign additional permissions:

SELECT U.type_desc, U.name AS grantee,
 DP.class_desc AS securable_type,
   CASE DP.class
    WHEN 0 THEN DB_NAME()
    WHEN 1 THEN OBJECT_NAME(DP.major_id) 
    WHEN 3 THEN SCHEMA_NAME(DP.major_id)
   ELSE CAST(DP.major_id AS nvarchar)
   END AS securable,
       permission_name, state_desc
FROM sys.database_permissions DP
JOIN sys.database_principals U ON DP.grantee_principal_id = U.principal_id
WHERE DP.state = 'W'
ORDER BY grantee, securable_type, securable

If any of these rights are not documented and authorized, this is a finding.

References:
SV-93811
V-79105
CCI-002165</question_text>
          <choice_group_ref>ocil:navy.navwar.niwcatlantic.scc:choicegroup:1</choice_group_ref>
        </choice_question>
        <choice_question id="ocil:navy.navwar.niwcatlantic.scc.sql.server:question:4501" default_answer_ref="ocil:navy.navwar.niwcatlantic.scc:choice:4">
          <question_text>Review the system documentation to obtain a listing of stored procedures and functions that utilize impersonation. Execute the following query:


SELECT S.name AS schema_name, O.name AS module_name,
USER_NAME(
CASE M.execute_as_principal_id
WHEN -2 THEN COALESCE(O.principal_id, S.principal_id)
ELSE M.execute_as_principal_id
END
) AS execute_as
FROM sys.sql_modules M
JOIN sys.objects O ON M.object_id = O.object_id
JOIN sys.schemas S ON O.schema_id = S.schema_id
WHERE execute_as_principal_id IS NOT NULL
and       o.name not in 
(             
'fn_sysdac_get_username',
                             'fn_sysutility_ucp_get_instance_is_mi',
                             'sp_send_dbmail',
                             'sp_SendMailMessage',
                             'sp_syscollector_create_collection_set',
                             'sp_syscollector_delete_collection_set',
                             'sp_syscollector_disable_collector',
                             'sp_syscollector_enable_collector',
                             'sp_syscollector_get_collection_set_execution_status',
                             'sp_syscollector_run_collection_set',
                             'sp_syscollector_start_collection_set',
                             'sp_syscollector_update_collection_set',
                             'sp_syscollector_upload_collection_set',
                             'sp_syscollector_verify_collector_state',
                             'sp_syspolicy_add_policy',
                             'sp_syspolicy_add_policy_category_subscription',
                             'sp_syspolicy_delete_policy',
                             'sp_syspolicy_delete_policy_category_subscription',
                             'sp_syspolicy_update_policy',
                             'sp_sysutility_mi_add_ucp_registration',
                             'sp_sysutility_mi_disable_collection',
                             'sp_sysutility_mi_enroll',
                             'sp_sysutility_mi_initialize_collection',
                             'sp_sysutility_mi_remove',
                             'sp_sysutility_mi_remove_ucp_registration',
                             'sp_sysutility_mi_upload',
                             'sp_sysutility_mi_validate_enrollment_preconditions',
                             'sp_sysutility_ucp_add_mi',
                             'sp_sysutility_ucp_add_policy',
                             'sp_sysutility_ucp_calculate_aggregated_dac_health',
                             'sp_sysutility_ucp_calculate_aggregated_mi_health',
                             'sp_sysutility_ucp_calculate_computer_health',
                             'sp_sysutility_ucp_calculate_dac_file_space_health',
                             'sp_sysutility_ucp_calculate_dac_health',
                            'sp_sysutility_ucp_calculate_filegroups_with_policy_violations',
                             'sp_sysutility_ucp_calculate_health',
                             'sp_sysutility_ucp_calculate_mi_file_space_health',
                             'sp_sysutility_ucp_calculate_mi_health',
                             'sp_sysutility_ucp_configure_policies',
                             'sp_sysutility_ucp_create',
                             'sp_sysutility_ucp_delete_policy',
                             'sp_sysutility_ucp_delete_policy_history',
                             'sp_sysutility_ucp_get_policy_violations',
                             'sp_sysutility_ucp_initialize',
                             'sp_sysutility_ucp_initialize_mdw',
                             'sp_sysutility_ucp_remove_mi',
                             'sp_sysutility_ucp_update_policy',
                             'sp_sysutility_ucp_update_utility_configuration',
                             'sp_sysutility_ucp_validate_prerequisites',
                             'sp_validate_user',
                             'syscollector_collection_set_is_running_update_trigger',
                             'sysmail_help_status_sp'
)

ORDER BY schema_name, module_name

If any procedures or functions are returned that are not documented, this is a finding.

References:
SV-93813
V-79107
CCI-002233</question_text>
          <choice_group_ref>ocil:navy.navwar.niwcatlantic.scc:choicegroup:1</choice_group_ref>
        </choice_question>
        <choice_question id="ocil:navy.navwar.niwcatlantic.scc.sql.server:question:4701" default_answer_ref="ocil:navy.navwar.niwcatlantic.scc:choice:4">
          <question_text>If the SQL Server instance supports only software development, experimentation, and/or developer-level testing (i.e., excluding production systems, integration testing, stress testing, and user acceptance testing), this is not a finding. 

Obtain a listing of users and roles who are authorized to create, alter, or replace logic modules from the server documentation.

In each user database, execute the following query:

SELECT P.type_desc AS principal_type, P.name AS principal_name,
O.type_desc,
CASE class
WHEN 0 THEN DB_NAME()
WHEN 1 THEN OBJECT_SCHEMA_NAME(major_id) + '.' + OBJECT_NAME(major_id)
WHEN 3 THEN SCHEMA_NAME(major_id)
ELSE class_desc + '(' + CAST(major_id AS nvarchar) + ')'
END AS securable_name, DP.state_desc, DP.permission_name
FROM sys.database_permissions DP
JOIN sys.database_principals P ON DP.grantee_principal_id = P.principal_id
LEFT OUTER JOIN sys.all_objects O ON O.object_id = DP.major_id AND O.type IN ('TR','TA','P','X','RF','PC','IF','FN','TF','U')
WHERE DP.type IN ('AL','ALTG') AND DP.class IN (0, 1, 53)

SELECT R.name AS role_name, M.type_desc AS principal_type, M.name AS principal_name
FROM sys.database_principals R
JOIN sys.database_role_members DRM ON R.principal_id = DRM.role_principal_id
JOIN sys.database_principals M ON DRM.member_principal_id = M.principal_id
WHERE R.name IN ('db_ddladmin','db_owner')
AND M.name != 'dbo'

If any users or role permissions returned are not authorized to modify the specified object or type, this is a finding. 

If any user or role membership is not authorized, this is a finding.

References:
SV-93815
V-79109
CCI-003980
CCI-001812</question_text>
          <choice_group_ref>ocil:navy.navwar.niwcatlantic.scc:choicegroup:1</choice_group_ref>
        </choice_question>
        <choice_question id="ocil:navy.navwar.niwcatlantic.scc.sql.server:question:4901" default_answer_ref="ocil:navy.navwar.niwcatlantic.scc:choice:4">
          <question_text>Execute the following query to obtain a listing of user databases whose owner is a member of a fixed server role:

 SELECT 
              D.name AS database_name, SUSER_SNAME(D.owner_sid) AS owner_name,
              FRM.is_fixed_role_member
FROM sys.databases D
OUTER APPLY (
              SELECT MAX(fixed_role_member) AS is_fixed_role_member
              FROM (
                            SELECT IS_SRVROLEMEMBER(R.name, SUSER_SNAME(D.owner_sid)) AS fixed_role_member
                            FROM sys.server_principals R
                            WHERE is_fixed_role = 1
              ) A
) FRM
WHERE D.database_id &gt; 4
              AND (FRM.is_fixed_role_member = 1 
                            OR FRM.is_fixed_role_member IS NULL)
ORDER BY database_name 

If no databases are returned, this is not a finding. 

For each database/login returned, review the Server Role memberships 

1.	In SQL Server Management Studio, Expand &#8220;Logins&#8221;
2.	Double-click the name of the Login
3.	Click the &#8220;Server Roles&#8221; tab 

If any server roles are selected, but not documented and authorized, this is a finding.

References:
SV-93817
V-79111
CCI-001813</question_text>
          <choice_group_ref>ocil:navy.navwar.niwcatlantic.scc:choicegroup:1</choice_group_ref>
        </choice_question>
        <choice_question id="ocil:navy.navwar.niwcatlantic.scc.sql.server:question:5101" default_answer_ref="ocil:navy.navwar.niwcatlantic.scc:choice:4">
          <question_text>Review the system documentation to determine whether the organization has defined the information at rest that is to be protected from modification, which must include, at a minimum, PII and classified information. 

If no information is identified as requiring such protection, this is not a finding. 

Review the configuration of SQL Server, Windows, and additional software as relevant. 

If full-disk encryption is required, and Windows or the storage system is not configured for this, this is a finding. 

If database transparent data encryption (TDE) is called for, check whether it is enabled: 

SELECT
DB_NAME(database_id) AS [Database Name], CASE encryption_state WHEN 0 THEN 'No database encryption key present, no encryption' 
WHEN 1 THEN 'Unencrypted' 
WHEN 2 THEN 'Encryption in progress' 
WHEN 3 THEN 'Encrypted' 
WHEN 4 THEN 'Key change in progress' 
WHEN 5 THEN 'Decryption in progress' 
WHEN 6 THEN 'Protection change in progress' 
END AS [Encryption State]
FROM sys.dm_database_encryption_keys

For each user database for which encryption is called for and it is marked Unencrypted, this is a finding. 

If table/column encryption and/or a separation between those who own the data (and can view it) and those who manage the data (but should have no access) is required for PII or similar types of data, use Always Encrypted.  The details for configuring Always Encrypted are located here: https://msdn.microsoft.com/en-us/library/mt163865.aspx.

Review the definitions and contents of the relevant tables/columns for the Always Encryption settings, if any of the information defined as requiring cryptographic protection is not encrypted this is a finding.

References:
SV-93821
V-79115
CCI-002475</question_text>
          <choice_group_ref>ocil:navy.navwar.niwcatlantic.scc:choicegroup:1</choice_group_ref>
        </choice_question>
        <choice_question id="ocil:navy.navwar.niwcatlantic.scc.sql.server:question:5301" default_answer_ref="ocil:navy.navwar.niwcatlantic.scc:choice:4">
          <question_text>Review the system documentation to determine whether the organization has defined the information at rest that is to be protected from disclosure, which must include, at a minimum, PII and classified information. 

If no information is identified as requiring such protection, this is not a finding. 

If full-disk encryption is required, and Windows or the storage system is not configured for this, this is a finding. 

If database transparent data encryption (TDE) is called for, check whether it is enabled: 

SELECT
DB_NAME(database_id) AS [Database Name], CASE encryption_state WHEN 0 THEN 'No database encryption key present, no encryption' 
WHEN 1 THEN 'Unencrypted' 
WHEN 2 THEN 'Encryption in progress' 
WHEN 3 THEN 'Encrypted' 
WHEN 4 THEN 'Key change in progress' 
WHEN 5 THEN 'Decryption in progress' 
WHEN 6 THEN 'Protection change in progress' 
END AS [Encryption State]
FROM sys.dm_database_encryption_keys

For each user database for which encryption is called for and it is marked Unencrypted, this is a finding. 

If table/column encryption and/or a separation between those who own the data (and can view it) and those who manage the data (but should have no access) is required for PII or similar types of data, use Always Encrypted.&#160; The details for configuring Always Encrypted are located here: https://msdn.microsoft.com/en-us/library/mt163865.aspx.

Review the definitions and contents of the relevant tables/columns for the Always Encryption settings, if any of the information defined as requiring cryptographic protection is not encrypted this is a finding.

References:
SV-93823
V-79117
CCI-002476</question_text>
          <choice_group_ref>ocil:navy.navwar.niwcatlantic.scc:choicegroup:1</choice_group_ref>
        </choice_question>
        <choice_question id="ocil:navy.navwar.niwcatlantic.scc.sql.server:question:5501" default_answer_ref="ocil:navy.navwar.niwcatlantic.scc:choice:4">
          <question_text>Detailed information on the NIST Cryptographic Module Validation Program (CMVP) is available at the following website: http://csrc.nist.gov/groups/STM/cmvp/index.html.

Review system documentation to determine whether cryptography for classified or sensitive information is required by the information owner.

If the system documentation does not specify the type of information hosted on SQL Server as classified, sensitive, and/or unclassified, this is a finding.

If neither classified nor sensitive information exists within SQL Server databases or configuration, this is not a finding.

Verify that Windows is configured to require the use of FIPS-compliant algorithms.

Click "Start",  enter "Local Security Policy", and then press "Enter". Expand "Local Policies", select "Security Options", and then locate "System Cryptography: Use FIPS compliant algorithms for encryption, hashing, and signing".

If the Security Setting for this option is "Disabled", this is a finding.

Note: The list of acceptable algorithms is "AES 256" and "Triple DES".

If cryptography is being used by SQL Server, verify that the cryptography is NIST FIPS 140-2 or 140-3 certified by running the following SQL query:

SELECT DISTINCT name, algorithm_desc
FROM sys.symmetric_keys
WHERE key_algorithm NOT IN ('D3','A3')
ORDER BY name

If any items listed show an uncertified NIST FIPS 140-2 algorithm type, this is a finding.

References:
SV-93819
V-79113
CCI-002450</question_text>
          <choice_group_ref>ocil:navy.navwar.niwcatlantic.scc:choicegroup:1</choice_group_ref>
        </choice_question>
        <choice_group id="ocil:navy.navwar.niwcatlantic.scc:choicegroup:1">
          <choice id="ocil:navy.navwar.niwcatlantic.scc:choice:1">Finding</choice>
          <choice id="ocil:navy.navwar.niwcatlantic.scc:choice:2">Not a Finding</choice>
          <choice id="ocil:navy.navwar.niwcatlantic.scc:choice:3">Not Applicable</choice>
          <choice id="ocil:navy.navwar.niwcatlantic.scc:choice:4">Not Reviewed</choice>
        </choice_group>
      </questions>
    </ocil>
  </component>
<ds:Signature xmlns:ds="http://www.w3.org/2000/09/xmldsig#"><ds:SignedInfo><ds:CanonicalizationMethod Algorithm="http://www.w3.org/2006/12/xml-c14n11"/><ds:SignatureMethod Algorithm="http://www.w3.org/2001/04/xmldsig-more#rsa-sha256"/><ds:Reference URI=""><ds:Transforms><ds:Transform Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature"/><ds:Transform Algorithm="http://www.w3.org/2006/12/xml-c14n11"/></ds:Transforms><ds:DigestMethod Algorithm="http://www.w3.org/2001/04/xmlenc#sha256"/><ds:DigestValue>SrYgSJLVqCvUeJcS34Zwh4wV0LuR8jr1Iif6sIcn6vk=</ds:DigestValue></ds:Reference></ds:SignedInfo><ds:SignatureValue>Q4kLXUnGSsa0u8fNS34Nz94y7VXaDNXCnw5+bHqwBIw/fioeFni2DL9nrgDlSJ63JBMpE8s74Rsumb2jtXOievr4kJvLyyH0Xge8Ja89aIw00vx0l3OWhlUKj4bzu6Kv1SFmG+93at+6AbmdNOuLf4NV8TaBtac8ZVQwCIzTMrmmEDpJPvVDWC5ngxQEGbnrmgLTPIGxa6JzRf504ZhZIOo1o/TKEoPI3pJx+Sh7gtEW+VGCPFHAFosGQ1BM3+FquhP0VOeeqBHogHeyVzo+RfAk441tVHqqN1jI5BoNngeCgWmFetmW1GsCyNB/qiQrleirBl84klSEtT13QzGLeQ==</ds:SignatureValue><ds:KeyInfo><ds:X509Data><ds:X509Certificate>MIIEdjCCA16gAwIBAgIDETyOMA0GCSqGSIb3DQEBCwUAMFoxCzAJBgNVBAYTAlVT
MRgwFgYDVQQKEw9VLlMuIEdvdmVybm1lbnQxDDAKBgNVBAsTA0RvRDEMMAoGA1UE
CxMDUEtJMRUwEwYDVQQDEwxET0QgSUQgQ0EtNzEwHhcNMjUwMjE4MDAwMDAwWhcN
MjgwMjE3MjM1OTU5WjBwMQswCQYDVQQGEwJVUzEYMBYGA1UEChMPVS5TLiBHb3Zl
cm5tZW50MQwwCgYDVQQLEwNEb0QxDDAKBgNVBAsTA1BLSTEMMAoGA1UECxMDVVNO
MR0wGwYDVQQDExRDUy5OSVdDLUFUTEFOVElDLjAwMTCCASIwDQYJKoZIhvcNAQEB
BQADggEPADCCAQoCggEBAPYLGN4Y/QTeMbgfqaTIFu9TymTvDgxhd3nhHdJDRCRW
HKZGA9MDnfg03pBjOH1ibNb8A6XVU04NTBPE1kNN5V7MhkdH0TprI47mJFTpIufu
rhtKIr4VmavcKOf4HbnAiXQtD1UZ1pOWlcBQOdZohyfdQrlUxug5qsw6egL96U9y
ZK6xVQCZrGJydQtggKWxtcP5Ax3ZxyLCi1Msud3q3BdluL6WCVdSo7bNF261y9FT
a/XsV55VuaCLeNWkbq4tFY9tAF8neN6Vhp8PNV73qNX8yhj5w0X3jKILYWW/eEaF
pqcJaCI0tJEo5nlIUQ9v4gRSklTn0HSH9NfY72Eu3QMCAwEAAaOCAS0wggEpMB8G
A1UdIwQYMBaAFJAlOZpZ/Ax1V7nNbkwSYXXZOulhMDcGA1UdHwQwMC4wLKAqoCiG
Jmh0dHA6Ly9jcmwuZGlzYS5taWwvY3JsL0RPRElEQ0FfNzEuY3JsMA4GA1UdDwEB
/wQEAwIHgDAWBgNVHSAEDzANMAsGCWCGSAFlAgELKjAdBgNVHQ4EFgQUM9o3yyNq
qD7IX81R/xCmunTp+WIwZQYIKwYBBQUHAQEEWTBXMDMGCCsGAQUFBzAChidodHRw
Oi8vY3JsLmRpc2EubWlsL3NpZ24vRE9ESURDQV83MS5jZXIwIAYIKwYBBQUHMAGG
FGh0dHA6Ly9vY3NwLmRpc2EubWlsMB8GA1UdJQQYMBYGCisGAQQBgjcKAw0GCCsG
AQUFBwMDMA0GCSqGSIb3DQEBCwUAA4IBAQAOeSxOWcf4Xxg/A7ErRjpD4N27nCeQ
9PqkRXktArc9ec/jA/GRuRS02aHRhZ4jwbtkDKImrLVTrfqF8zcfCCLBXOkuOakk
uFo509PFcsddfGjoNY8LA3RmggJbPjp1DFLRr3VWEZ9p9+ktoBQPGnajQCQ5X9t+
o5R5/1Lhlpq+sXo397gaj8EuIcDlXs7fSGgUiYAO3oaCMcklj3/sgQIypunDYzVR
TduLq7zHe0K+xhvL/H4ZzgifszJmuQ7Oz1/et+dw/GAPRcV1u/k2GdAYoSbz4KU3
fC0HF+L6YpP0BD4uF2g4pc7ATmeT0Wgt21W4YY2GHT19SXhDWzUWCkFx
</ds:X509Certificate></ds:X509Data></ds:KeyInfo></ds:Signature></data-stream-collection>