---
wave: 1
depends_on: []
files_modified:
  - .planning/phases/03-deterministic-mission-execution-core/03-03-SUMMARY.md
  - .planning/phases/03-deterministic-mission-execution-core/03-04-SUMMARY.md
  - .planning/phases/03-deterministic-mission-execution-core/03-05-SUMMARY.md
  - .planning/phases/03-deterministic-mission-execution-core/03-VERIFICATION.md
autonomous: true
requirements:
  - APL-02
  - VER-01
  - MAP-01
must_haves:
  truths:
    - LGPO backend wraps LGPO.exe for Machine/User policy import/export
    - Convergence tracking limits reboots to 3 and tracks ConvergenceStatus
    - Verify wrappers normalize SCAP/SCC outputs with provenance (RawArtifactPath, BenchmarkId)
    - Per-STIG SCAP mapping enforces single benchmark with no cross-STIG fallback
  artifacts:
    - LgpoRunner with /m and /u scope support
    - ConvergenceStatus enum and RebootCount tracking
    - NormalizedVerifyResult with RawArtifactPath and BenchmarkId
    - ScapMappingManifest with BenchmarkOverlap/StrictTagMatch/Unmapped methods
    - ApplyMappingManifest method for enriching results
  key_links:
    - src/STIGForge.Apply/Lgpo/LgpoRunner.cs
    - src/STIGForge.Apply/Reboot/RebootCoordinator.cs (MaxReboots=3)
    - src/STIGForge.Verify/NormalizedVerifyResult.cs (provenance fields)
    - src/STIGForge.Core/Models/ScapMappingManifest.cs
    - src/STIGForge.Verify/VerifyOrchestrator.cs (ApplyMappingManifest)
    - tests/STIGForge.UnitTests/Apply/LgpoRunnerTests.cs
    - tests/STIGForge.UnitTests/Apply/ApplyConvergenceTests.cs
    - tests/STIGForge.UnitTests/Services/ScapMappingManifestTests.cs
    - tests/STIGForge.UnitTests/Verify/VerifyOrchestratorMappingTests.cs
---

# 09-03: Verify APL-02, VER-01, MAP-01 - Multi-Backend Apply, Verify Normalization, SCAP Mapping

## Goal

Gather evidence that requirements APL-02 (multi-backend apply with convergence), VER-01 (verify normalization), and MAP-01 (per-STIG SCAP mapping) are satisfied by Phase 3 implementation.

## Tasks

<tasks>
<task>
<action>Read commit summaries for plans 03-03, 03-04, 03-05</action>
<files>.planning/phases/03-deterministic-mission-execution-core/03-03-SUMMARY.md, .planning/phases/03-deterministic-mission-execution-core/03-04-SUMMARY.md, .planning/phases/03-deterministic-mission-execution-core/03-05-SUMMARY.md</files>
<verify>Summaries confirm SCAP mapping manifest, LGPO backend with convergence, and verify normalization with provenance</verify>
<done>03-03/03-04/03-05 summaries read and verified</done>
</task>
<task>
<action>Verify ScapMappingManifest model and CanonicalScapSelector.BuildMappingManifest</action>
<files>src/STIGForge.Core/Models/ScapMappingManifest.cs, src/STIGForge.Core/Services/CanonicalScapSelector.cs</files>
<verify>ScapMappingManifest has ScapMappingMethod enum, BuildMappingManifest produces per-STIG mapping with no cross-STIG fallback</verify>
<done>ScapMappingManifest verified</done>
</task>
<task>
<action>Verify LgpoRunner and convergence tracking</action>
<files>src/STIGForge.Apply/Lgpo/LgpoRunner.cs, src/STIGForge.Apply/Reboot/RebootCoordinator.cs, src/STIGForge.Apply/ApplyModels.cs</files>
<verify>LgpoRunner has Machine/User scope, RebootCoordinator has MaxReboots=3, ConvergenceStatus enum exists</verify>
<done>LGPO and convergence verified</done>
</task>
<task>
<action>Verify NormalizedVerifyResult provenance fields</action>
<files>src/STIGForge.Verify/NormalizedVerifyResult.cs</files>
<verify>Has RawArtifactPath and BenchmarkId properties for provenance tracking</verify>
<done>Verify provenance fields verified</done>
</task>
<task>
<action>Verify VerifyOrchestrator.ApplyMappingManifest</action>
<files>src/STIGForge.Verify/VerifyOrchestrator.cs</files>
<verify>ApplyMappingManifest method enriches results with BenchmarkId and mapping status metadata</verify>
<done>ApplyMappingManifest verified</done>
</task>
<task>
<action>Verify test files for all three requirements</action>
<files>tests/STIGForge.UnitTests/Services/ScapMappingManifestTests.cs, tests/STIGForge.UnitTests/Apply/LgpoRunnerTests.cs, tests/STIGForge.UnitTests/Apply/ApplyConvergenceTests.cs, tests/STIGForge.UnitTests/Verify/VerifyOrchestratorMappingTests.cs</files>
<verify>ScapMappingManifestTests (4 tests), LgpoRunnerTests + ApplyConvergenceTests (11 tests), VerifyOrchestratorMappingTests (5 tests) all exist and pass</verify>
<done>All test files verified</done>
</task>
<task>
<action>Document verification evidence in 03-VERIFICATION.md</action>
<files>.planning/phases/03-deterministic-mission-execution-core/03-VERIFICATION.md</files>
<verify>03-VERIFICATION.md includes APL-02, VER-01, MAP-01 sections with test, source, and commit evidence</verify>
<done>APL-02/VER-01/MAP-01 verification evidence documented</done>
</task>
</tasks>

## Verification Criteria

- MAP-01 requirement is mapped to plan 03-03 with ScapMappingManifest evidence
- APL-02 requirement is mapped to plans 03-02 (preflight) and 03-04 (LGPO + convergence)
- VER-01 requirement is mapped to plan 03-05 with provenance field evidence
- ScapMappingManifest methods: BenchmarkOverlap, StrictTagMatch, Unmapped
- LGPO backend evidence includes Machine/User scope and LgpoRunner wrapper
- Convergence evidence includes MaxReboots=3, ConvergenceStatus enum, RebootCount tracking
- Verify normalization evidence includes RawArtifactPath, BenchmarkId, ApplyMappingManifest
- Test evidence counts: 4 (MAP-01), 11 (APL-02), 5 (VER-01)
- Commit hashes: fcebf8d (03-03), a81dea5 (03-04), 29482f8 (03-05)
- All three statuses set to SATISFIED with clear evidence

## Success Criteria

- 03-VERIFICATION.md has complete sections for MAP-01, APL-02, VER-01
- MAP-01 documents single benchmark per STIG and no cross-STIG fallback
- APL-02 documents LGPO backend, convergence tracking, and reboot limit
- VER-01 documents RawArtifactPath, BenchmarkId, and mapping manifest enrichment
