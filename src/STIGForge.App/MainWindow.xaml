<Window x:Class="STIGForge.App.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:views="clr-namespace:STIGForge.App.Views"
        Title="STIGForge" Height="720" Width="1200" MinHeight="680" MinWidth="980"
        WindowStartupLocation="CenterScreen" FontFamily="Bahnschrift" FontSize="13"
        Background="{DynamicResource WindowBackgroundBrush}"
        FocusManager.FocusedElement="{Binding ElementName=MainTabControl}">
  <!-- Resources moved to App.xaml Application.Resources -->

  <Window.InputBindings>
    <KeyBinding Key="S" Modifiers="Ctrl" Command="{Binding SaveManualAnswerCommand}"/>
    <KeyBinding Key="Z" Modifiers="Ctrl" Command="{Binding UndoAnswerCommand}"/>
  </Window.InputBindings>

  <Grid Margin="12">
    <Grid.RowDefinitions>
      <RowDefinition Height="Auto"/>
      <RowDefinition Height="*"/>
    </Grid.RowDefinitions>

    <DockPanel Grid.Row="0" LastChildFill="True" Margin="0,0,0,8">
      <TextBlock Text="STIGForge" FontSize="22" FontWeight="SemiBold" DockPanel.Dock="Left" VerticalAlignment="Center"
                 AutomationProperties.Name="STIGForge Application Title"/>
      <Button Content="About" Width="70" Height="28" Margin="8,0,0,0" Command="{Binding ShowAboutCommand}" DockPanel.Dock="Right"
              TabIndex="93"
              AutomationProperties.Name="About"
              ToolTipService.ToolTip="Application version, runtime, and local data root details."/>
      <Button Content="{Binding ThemeToggleLabel}" Width="50" Height="28" Margin="0,0,8,0" Command="{Binding ToggleThemeCommand}" DockPanel.Dock="Right"
              TabIndex="92"
              AutomationProperties.Name="Toggle dark/light theme"
              ToolTipService.ToolTip="Switch between dark and light mode."/>
      <Button Content="Help" Width="70" Height="28" Margin="0,0,8,0" Command="{Binding ShowHelpCommand}" DockPanel.Dock="Right"
              TabIndex="91"
              AutomationProperties.Name="Help"
              ToolTipService.ToolTip="Open full SOP and workflow guide for all STIGForge features."/>
      <ProgressBar Width="120" Height="12" Margin="0,0,12,0" IsIndeterminate="True" DockPanel.Dock="Right"
                   Visibility="{Binding IsBusy, Converter={StaticResource BoolToVisibility}}" VerticalAlignment="Center"
                   AutomationProperties.Name="Operation in progress"
                   ToolTipService.ToolTip="An operation is running. Please wait."/>
      <StackPanel VerticalAlignment="Center" Margin="14,0,0,0">
        <TextBlock Text="Import > Profile > Build > Orchestrate > Verify > Manual > Export | Fleet"
                   FontSize="11" Foreground="{DynamicResource TextMutedBrush}"/>
        <TextBlock Text="{Binding StatusText}" FontSize="11" Foreground="{DynamicResource TextMutedBrush}"
                   TextWrapping="NoWrap" TextTrimming="CharacterEllipsis" Margin="0,2,0,0"
                   ToolTipService.ToolTip="{Binding StatusText}"
                   AutomationProperties.LiveSetting="Assertive"/>
      </StackPanel>
    </DockPanel>

    <TabControl x:Name="MainTabControl" Grid.Row="1" TabIndex="0">
      <TabItem Header="Import" TabIndex="1"
               AutomationProperties.Name="Import tab"
               ToolTipService.ToolTip="Step 1: Bring in security rules (STIGs, SCAP benchmarks, Group Policy templates) and manage what you've imported.">
        <views:ImportView />
      </TabItem>

      <TabItem Header="Profile" TabIndex="2"
               AutomationProperties.Name="Profile tab"
               ToolTipService.ToolTip="Step 2: Set your preferences — how strict to be, which exceptions to allow, and what classification level applies.">
        <views:ProfileView />
      </TabItem>

      <TabItem Header="Build" TabIndex="3"
               AutomationProperties.Name="Build tab"
               ToolTipService.ToolTip="Step 3: Combine your imported rules and profile into a ready-to-run bundle folder.">
        <views:BuildView />
      </TabItem>

      <TabItem Header="Orchestrate" TabIndex="4"
               AutomationProperties.Name="Orchestrate tab"
               ToolTipService.ToolTip="Step 4: Run everything — apply security fixes, verify they worked, and export reports. The big 'Go' button.">
        <views:OrchestrateView />
      </TabItem>

      <TabItem Header="Verify" TabIndex="5"
               AutomationProperties.Name="Verify tab"
               ToolTipService.ToolTip="Step 5: Run scanners to check whether the security fixes actually stuck. Compare results from different tools.">
        <views:VerifyView />
      </TabItem>

      <TabItem Header="Manual" TabIndex="6"
               AutomationProperties.Name="Manual tab"
               ToolTipService.ToolTip="Step 6: Review controls that need a human decision. Mark each as pass, fail, or not applicable, and attach evidence.">
        <views:ManualView />
      </TabItem>

      <TabItem Header="Export" TabIndex="7"
               AutomationProperties.Name="Export tab"
               ToolTipService.ToolTip="Step 7: See your compliance dashboard and export reports — eMASS packages, Plan of Action documents, STIG checklists, and audit logs.">
        <views:ExportView />
      </TabItem>

      <TabItem Header="Fleet" TabIndex="8"
               AutomationProperties.Name="Fleet tab"
               ToolTipService.ToolTip="Manage multiple computers at once — run apply/verify remotely, track your inventory, and schedule automatic re-checks.">
        <views:FleetView />
      </TabItem>
    </TabControl>

    <views:NotificationPanel Grid.Row="1" DataContext="{Binding Notifications}"
                             VerticalAlignment="Top" HorizontalAlignment="Right"
                             Panel.ZIndex="100"/>
  </Grid>
</Window>
