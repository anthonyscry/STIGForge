<Window x:Class="STIGForge.App.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:views="clr-namespace:STIGForge.App.Views"
        Title="STIGForge" Height="720" Width="1200" MinHeight="680" MinWidth="980"
        WindowStartupLocation="CenterScreen" FontFamily="Bahnschrift" FontSize="13"
        Background="{DynamicResource WindowBackgroundBrush}"
        FocusManager.FocusedElement="{Binding ElementName=MainTabControl}">
  <!-- Resources moved to App.xaml Application.Resources -->

  <Window.InputBindings>
    <KeyBinding Key="D1" Modifiers="Ctrl" Command="{Binding GoToTabCommand}" CommandParameter="0"/>
    <KeyBinding Key="D2" Modifiers="Ctrl" Command="{Binding GoToTabCommand}" CommandParameter="1"/>
    <KeyBinding Key="D3" Modifiers="Ctrl" Command="{Binding GoToTabCommand}" CommandParameter="2"/>
    <KeyBinding Key="D4" Modifiers="Ctrl" Command="{Binding GoToTabCommand}" CommandParameter="3"/>
    <KeyBinding Key="D5" Modifiers="Ctrl" Command="{Binding GoToTabCommand}" CommandParameter="4"/>
    <KeyBinding Key="D6" Modifiers="Ctrl" Command="{Binding GoToTabCommand}" CommandParameter="5"/>
    <KeyBinding Key="D7" Modifiers="Ctrl" Command="{Binding GoToTabCommand}" CommandParameter="6"/>
    <KeyBinding Key="D8" Modifiers="Ctrl" Command="{Binding GoToTabCommand}" CommandParameter="7"/>
    <KeyBinding Key="I" Modifiers="Ctrl" Command="{Binding ImportContentPackCommand}"/>
    <KeyBinding Key="B" Modifiers="Ctrl" Command="{Binding BuildBundleCommand}"/>
    <KeyBinding Key="R" Modifiers="Ctrl" Command="{Binding OrchestrateCommand}"/>
    <KeyBinding Key="E" Modifiers="Ctrl" Command="{Binding ExportEmassCommand}"/>
  </Window.InputBindings>

  <Grid Margin="12">
    <Grid.RowDefinitions>
      <RowDefinition Height="Auto"/>
      <RowDefinition Height="*"/>
    </Grid.RowDefinitions>

    <DockPanel Grid.Row="0" LastChildFill="True" Margin="0,0,0,8">
      <TextBlock Text="STIGForge" FontSize="22" FontWeight="SemiBold" DockPanel.Dock="Left" VerticalAlignment="Center"
                 AutomationProperties.Name="STIGForge Application Title"/>
      <Button Content="About" Width="70" Height="28" Margin="8,0,0,0" Command="{Binding ShowAboutCommand}" DockPanel.Dock="Right"
              TabIndex="93"
              AutomationProperties.Name="About"
              ToolTipService.ToolTip="Application version, runtime, and local data root details."/>
      <Button Content="{Binding ThemeToggleLabel}" Width="50" Height="28" Margin="0,0,8,0" Command="{Binding ToggleThemeCommand}" DockPanel.Dock="Right"
              TabIndex="92"
              AutomationProperties.Name="Toggle dark/light theme"
              ToolTipService.ToolTip="Switch between dark and light mode."/>
      <Button Content="Help" Width="70" Height="28" Margin="0,0,8,0" Command="{Binding ShowHelpCommand}" DockPanel.Dock="Right"
              TabIndex="91"
              AutomationProperties.Name="Help"
              ToolTipService.ToolTip="Open full SOP and workflow guide for all STIGForge features."/>
      <ProgressBar Width="120" Height="12" Margin="0,0,12,0" DockPanel.Dock="Right"
                   IsIndeterminate="{Binding IsProgressIndeterminate}"
                   Value="{Binding ProgressValue}" Maximum="{Binding ProgressMax}"
                   Visibility="{Binding IsBusy, Converter={StaticResource BoolToVisibility}}" VerticalAlignment="Center"
                   AutomationProperties.Name="Operation in progress"
                   ToolTipService.ToolTip="An operation is running. Please wait."/>
      <StackPanel VerticalAlignment="Center" Margin="14,0,0,0">
        <TextBlock Text="Import > Profile > Build > Orchestrate > Verify > Manual > Export | Fleet"
                   FontSize="11" Foreground="{DynamicResource TextMutedBrush}"/>
         <TextBlock Text="{Binding StatusText}" FontSize="11"
                    TextWrapping="NoWrap" TextTrimming="CharacterEllipsis" Margin="0,2,0,0"
                    ToolTipService.ToolTip="{Binding StatusText}"
                    AutomationProperties.LiveSetting="Assertive">
           <TextBlock.Style>
             <Style TargetType="TextBlock">
               <Setter Property="Foreground" Value="{DynamicResource TextMutedBrush}"/>
               <Style.Triggers>
                 <DataTrigger Binding="{Binding StatusSeverity}" Value="Success">
                   <Setter Property="Foreground" Value="{DynamicResource SuccessBrush}"/>
                   <Setter Property="FontWeight" Value="SemiBold"/>
                 </DataTrigger>
                 <DataTrigger Binding="{Binding StatusSeverity}" Value="Error">
                   <Setter Property="Foreground" Value="{DynamicResource DangerBrush}"/>
                   <Setter Property="FontWeight" Value="SemiBold"/>
                 </DataTrigger>
                 <DataTrigger Binding="{Binding StatusSeverity}" Value="Warning">
                   <Setter Property="Foreground" Value="{DynamicResource WarningBrush}"/>
                 </DataTrigger>
               </Style.Triggers>
             </Style>
           </TextBlock.Style>
         </TextBlock>
      </StackPanel>
    </DockPanel>

    <TabControl x:Name="MainTabControl" Grid.Row="1" TabIndex="0"
                SelectedIndex="{Binding SelectedTabIndex}">
      <TabItem Header="Import" TabIndex="1"
               AutomationProperties.Name="Import tab"
               ToolTipService.ToolTip="Import STIG, SCAP, and GPO content packs; manage the content library.">
        <views:ImportView />
      </TabItem>

      <TabItem Header="Profile" TabIndex="2"
               AutomationProperties.Name="Profile tab"
               ToolTipService.ToolTip="Configure hardening profiles, overlays, and classification settings.">
        <views:ProfileView />
      </TabItem>

      <TabItem Header="Build" TabIndex="3"
               AutomationProperties.Name="Build tab"
               ToolTipService.ToolTip="Generate an offline bundle from a content pack and profile.">
        <views:BuildView />
      </TabItem>

      <TabItem Header="Orchestrate" TabIndex="4"
               AutomationProperties.Name="Orchestrate tab"
               ToolTipService.ToolTip="Run the full Apply, Verify, and Export pipeline with all settings.">
        <views:OrchestrateView />
      </TabItem>

      <TabItem Header="Verify" TabIndex="5"
               AutomationProperties.Name="Verify tab"
               ToolTipService.ToolTip="Run Evaluate-STIG and SCAP verification scans; view overlap analysis.">
        <views:VerifyView />
      </TabItem>

      <TabItem Header="Manual" TabIndex="6"
               AutomationProperties.Name="Manual tab"
               ToolTipService.ToolTip="Review manual controls, set pass/fail/NA, and capture evidence.">
        <views:ManualView />
      </TabItem>

      <TabItem Header="Export" TabIndex="7"
               AutomationProperties.Name="Export tab"
               ToolTipService.ToolTip="Dashboard metrics, eMASS export, POA&amp;M/CKL generation, and audit log.">
        <views:ExportView />
      </TabItem>

      <TabItem Header="Fleet" TabIndex="8"
               AutomationProperties.Name="Fleet tab"
               ToolTipService.ToolTip="Manage fleet inventory, run remote operations, and schedule recurring tasks.">
        <views:FleetView />
      </TabItem>
    </TabControl>
  </Grid>
</Window>
