<UserControl x:Class="STIGForge.App.Views.DashboardView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:controls="clr-namespace:STIGForge.App.Views">
    <ScrollViewer VerticalScrollBarVisibility="Auto">
        <StackPanel Margin="0,0,0,8">
            <DockPanel Margin="0,0,0,16">
                <TextBlock Text="Workflow Dashboard" FontSize="22" FontWeight="SemiBold" VerticalAlignment="Center" />
                <Button Content="Run Auto (Ctrl+R)"
                         DockPanel.Dock="Right"
                         Width="170"
                         Height="34"
                         Padding="14,4"
                         TabIndex="0"
                         Style="{DynamicResource WorkflowDashboardButtonStyle}"
                        Command="{Binding RunAutoWorkflowCommand}"
                        AutomationProperties.Name="Run auto workflow"
                        ToolTip="Run all workflow steps in order (Ctrl+R)" />
            </DockPanel>

            <TextBlock Text="Shortcuts: Ctrl+R run all, Alt+I/S/H/V run steps, Alt+K skip harden, Ctrl+O open output, Ctrl+N restart"
                       Margin="0,0,0,12"
                       FontSize="11"
                       Foreground="{DynamicResource TextMutedBrush}" />

            <Border Margin="0,0,0,12"
                    Padding="10"
                    MinHeight="40"
                    Background="{DynamicResource SurfaceMutedBrush}"
                    Visibility="{Binding StatusText, Converter={StaticResource NullOrEmptyToCollapsed}}">
                <StackPanel>
                    <TextBlock Text="{Binding StatusText}" TextWrapping="Wrap" />
                    <ProgressBar Height="8"
                                 Margin="0,8,0,0"
                                 IsIndeterminate="True"
                                 Visibility="{Binding IsBusy, Converter={StaticResource BoolToVisibility}}" />
                </StackPanel>
            </Border>

            <UniformGrid Rows="2" Columns="2" Margin="0,0,0,16">
                <controls:WorkflowStepCard StepName="Import"
                                          StepState="{Binding ImportState}"
                                          ErrorMessage="{Binding ImportError}"
                                          RunCommand="{Binding RunImportStepCommand}"
                                          RunButtonLabel="Run Import"
                                          RunButtonTabIndex="10"
                                          RunButtonAutomationName="Run Import step"
                                          RunButtonToolTip="Run Import step (Alt+I)"
                                          RecoveryButtonTabIndex="11"
                                          RecoveryButtonAutomationName="Retry Import step"
                                          RecoveryButtonToolTip="Retry Import step (Alt+I)" />

                <controls:WorkflowStepCard StepName="Scan"
                                          StepState="{Binding ScanState}"
                                          ErrorMessage="{Binding ScanError}"
                                          RunCommand="{Binding RunScanStepCommand}"
                                          RunButtonLabel="Run Scan"
                                          RunButtonTabIndex="20"
                                          RunButtonAutomationName="Run Scan step"
                                          RunButtonToolTip="Run Scan step (Alt+S)"
                                          RecoveryButtonTabIndex="21"
                                          RecoveryButtonAutomationName="Retry Scan step"
                                          RecoveryButtonToolTip="Retry Scan step (Alt+S)" />

                <controls:WorkflowStepCard StepName="Harden"
                                          StepState="{Binding HardenState}"
                                          ErrorMessage="{Binding HardenError}"
                                          RunCommand="{Binding RunHardenStepCommand}"
                                          RunButtonLabel="Run Harden"
                                          RunButtonTabIndex="30"
                                          RunButtonAutomationName="Run Harden step"
                                          RunButtonToolTip="Run Harden step (Alt+H)"
                                          SecondaryCommand="{Binding SkipHardenStepCommand}"
                                          SecondaryButtonLabel="Skip Harden"
                                          SecondaryButtonTabIndex="32"
                                          SecondaryButtonAutomationName="Skip Harden step"
                                          SecondaryButtonToolTip="Skip harden and continue to verify (Alt+K)"
                                          RecoveryButtonTabIndex="31"
                                          RecoveryButtonAutomationName="Retry Harden step"
                                          RecoveryButtonToolTip="Retry Harden step (Alt+H)" />

                <controls:WorkflowStepCard StepName="Verify"
                                          StepState="{Binding VerifyState}"
                                          ErrorMessage="{Binding VerifyError}"
                                          RunCommand="{Binding RunVerifyStepCommand}"
                                          RunButtonLabel="Run Verify"
                                          RunButtonTabIndex="40"
                                          RunButtonAutomationName="Run Verify step"
                                          RunButtonToolTip="Run Verify step (Alt+V)"
                                          RecoveryButtonTabIndex="41"
                                          RecoveryButtonAutomationName="Retry Verify step"
                                          RecoveryButtonToolTip="Retry Verify step (Alt+V)" />
            </UniformGrid>

            <Border Padding="12">
                <StackPanel>
                    <TextBlock Text="Results" FontSize="16" FontWeight="SemiBold" Margin="0,0,0,10" />

                    <TextBlock Text="Mission JSON" FontWeight="SemiBold" Margin="0,0,0,4" />
                    <TextBox Text="{Binding MissionJsonPath}" IsReadOnly="True" IsTabStop="False" Margin="0,0,0,10" />

                    <TextBlock Text="Output Folder" FontWeight="SemiBold" Margin="0,0,0,4" />
                    <TextBox Text="{Binding OutputFolderPath}" IsReadOnly="True" IsTabStop="False" Margin="0,0,0,10" />

                    <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                        <Button Content="Open Output Folder (Ctrl+O)"
                                Width="220"
                                Height="34"
                                HorizontalAlignment="Left"
                                TabIndex="90"
                                Style="{DynamicResource WorkflowDashboardButtonStyle}"
                                Command="{Binding OpenOutputFolderCommand}"
                                AutomationProperties.Name="Open output folder"
                                ToolTip="Open output folder (Ctrl+O)" />

                        <Button Content="Restart Workflow (Ctrl+N)"
                                Width="230"
                                Height="34"
                                Margin="8,0,0,0"
                                HorizontalAlignment="Left"
                                TabIndex="91"
                                Style="{DynamicResource WorkflowDashboardButtonStyle}"
                                Command="{Binding RestartWorkflowCommand}"
                                AutomationProperties.Name="Restart workflow"
                                ToolTip="Reset workflow states and clear outputs (Ctrl+N)" />
                    </StackPanel>
                </StackPanel>
            </Border>
        </StackPanel>
    </ScrollViewer>
</UserControl>
