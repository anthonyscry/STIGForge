<UserControl x:Class="STIGForge.App.Views.AdvancedWorkspaceView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
        <ScrollViewer HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Auto">
        <Grid Margin="8">
          <TabControl MinWidth="980">
      <TabItem Header="Content Packs" ToolTipService.ToolTip="Import, inspect, and manage STIG content packs.">
        <Grid Margin="10">
          <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
          </Grid.RowDefinitions>

          <StackPanel Margin="0,0,0,8">
            <WrapPanel Margin="0,0,0,6">
              <Button Content="Import STIG..." Width="150" Height="30" Margin="0,0,8,0" Command="{Binding ImportContentPackCommand}"
                      ToolTipService.ToolTip="Import STIG content — single pack or full library. Auto-detects bundles."/>
              <Button Content="Import SCAP..." Width="150" Height="30" Margin="0,0,8,0" Command="{Binding ImportScapBenchmarkCommand}"
                      ToolTipService.ToolTip="Import SCAP benchmarks — single or NIWC Atlantic bundle. Auto-detects bundles."/>
              <Button Content="Import GPO/LGPO..." Width="160" Height="30" Margin="0,0,8,0" Command="{Binding ImportGpoPackageCommand}"
                      ToolTipService.ToolTip="Import GPO/LGPO packages — ADMX templates, local and domain controller group policy."/>
              <Button Content="Compare Packs..." Width="150" Height="30" Command="{Binding ComparePacksCommand}"
                      AutomationProperties.Name="Compare content packs"
                      ToolTipService.ToolTip="Compare two content packs to see added, removed, or changed controls."/>
            </WrapPanel>
            <TextBlock Text="{Binding ImportHint}" Foreground="{StaticResource TextMutedBrush}"/>
          </StackPanel>

          <Grid Grid.Row="1">
            <Grid.ColumnDefinitions>
              <ColumnDefinition Width="2*" />
              <ColumnDefinition Width="*" />
            </Grid.ColumnDefinitions>

            <ListView Grid.Column="0" ItemsSource="{Binding ContentPacks}" SelectedItem="{Binding SelectedPack}"
                      VirtualizingPanel.IsVirtualizing="True"
                      VirtualizingPanel.VirtualizationMode="Recycling"
                      ScrollViewer.CanContentScroll="True">
              <ListView.View>
                <GridView>
                  <GridViewColumn Header="Name" DisplayMemberBinding="{Binding Name}"/>
                  <GridViewColumn Header="PackId" DisplayMemberBinding="{Binding PackId}"/>
                  <GridViewColumn Header="ImportedAt" DisplayMemberBinding="{Binding ImportedAt}"/>
                  <GridViewColumn Header="Source" DisplayMemberBinding="{Binding SourceLabel}"/>
                </GridView>
              </ListView.View>
            </ListView>

            <StackPanel Grid.Column="1" Margin="12,0,0,0">
              <TextBlock Text="Pack Details" FontWeight="SemiBold" />
              <TextBlock Text="Name:" Margin="0,6,0,0" />
              <TextBlock Text="{Binding PackDetailName}" Foreground="{StaticResource TextMutedBrush}" />

              <TextBlock Text="PackId:" Margin="0,6,0,0" />
              <TextBlock Text="{Binding PackDetailId}" Foreground="{StaticResource TextMutedBrush}" />

              <TextBlock Text="Release date:" Margin="0,6,0,0" />
              <TextBlock Text="{Binding PackDetailReleaseDate}" Foreground="{StaticResource TextMutedBrush}" />

              <TextBlock Text="Imported:" Margin="0,6,0,0" />
              <TextBlock Text="{Binding PackDetailImportedAt}" Foreground="{StaticResource TextMutedBrush}" />

              <TextBlock Text="Source:" Margin="0,6,0,0" />
              <TextBlock Text="{Binding PackDetailSource}" Foreground="{StaticResource TextMutedBrush}" />

              <TextBlock Text="Hash:" Margin="0,6,0,0" />
              <TextBlock Text="{Binding PackDetailHash}" Foreground="{StaticResource TextMutedBrush}" TextWrapping="Wrap" />

              <TextBlock Text="Controls:" Margin="0,6,0,0" />
              <TextBlock Text="{Binding PackDetailControls}" Foreground="{StaticResource TextMutedBrush}" />

              <TextBlock Text="Root:" Margin="0,6,0,0" />
              <TextBlock Text="{Binding PackDetailRoot}" Foreground="{StaticResource TextMutedBrush}" TextWrapping="Wrap" />

              <WrapPanel Margin="0,8,0,0">
                <Button Content="Open Pack" Width="120" Command="{Binding OpenPackFolderCommand}"
                        AutomationProperties.Name="Open pack folder"
                        ToolTipService.ToolTip="Open the selected content pack folder in Windows Explorer."/>
                <Button Content="Export Map" Width="120" Margin="6,0,0,0" Command="{Binding ExportPowerStigMapCommand}"
                        AutomationProperties.Name="Export PowerSTIG map"
                        ToolTipService.ToolTip="Export a PowerSTIG control-to-rule mapping file for the selected pack."/>
                <Button Content="Delete Pack" Width="100" Margin="6,0,0,0" Command="{Binding DeleteSelectedPackCommand}" Foreground="{StaticResource DangerBrush}"
                        AutomationProperties.Name="Delete selected pack"
                        ToolTipService.ToolTip="Permanently remove the selected content pack from local storage."/>
              </WrapPanel>

              <Separator Margin="0,12,0,8"/>
              <TextBlock Text="Managed Import Library" FontWeight="SemiBold"/>
              <TextBlock Text="{Binding ImportLibraryStatus}" Foreground="{StaticResource TextMutedBrush}" TextWrapping="Wrap" Margin="0,4,0,0"/>
              <WrapPanel Margin="0,8,0,0">
                <Button Content="Refresh Library" Width="120" Command="{Binding RefreshImportLibraryCommand}"
                        AutomationProperties.Name="Refresh import library"
                        ToolTipService.ToolTip="Re-scan the import library for new or changed items."/>
                <Button Content="Open Selected" Width="120" Margin="6,0,0,0" Command="{Binding OpenSelectedLibraryItemCommand}"
                        AutomationProperties.Name="Open selected library item"
                        ToolTipService.ToolTip="Open the selected library item folder in Windows Explorer."/>
              </WrapPanel>

              <TabControl Margin="0,8,0,0" Height="280">
                <TabItem Header="STIG">
                  <ListView ItemsSource="{Binding StigLibraryItems}" SelectedItem="{Binding SelectedStigLibraryItem}"
                            VirtualizingPanel.IsVirtualizing="True"
                            VirtualizingPanel.VirtualizationMode="Recycling"
                            ScrollViewer.CanContentScroll="True">
                    <ListView.View>
                      <GridView>
                        <GridViewColumn Header="Name" DisplayMemberBinding="{Binding Name}"/>
                        <GridViewColumn Header="Imported" DisplayMemberBinding="{Binding ImportedAtLabel}"/>
                        <GridViewColumn Header="Source" DisplayMemberBinding="{Binding SourceLabel}"/>
                      </GridView>
                    </ListView.View>
                  </ListView>
                </TabItem>

                <TabItem Header="SCAP">
                  <ListView ItemsSource="{Binding ScapLibraryItems}" SelectedItem="{Binding SelectedScapLibraryItem}"
                            VirtualizingPanel.IsVirtualizing="True"
                            VirtualizingPanel.VirtualizationMode="Recycling"
                            ScrollViewer.CanContentScroll="True">
                    <ListView.View>
                      <GridView>
                        <GridViewColumn Header="Name" DisplayMemberBinding="{Binding Name}"/>
                        <GridViewColumn Header="Imported" DisplayMemberBinding="{Binding ImportedAtLabel}"/>
                        <GridViewColumn Header="Source" DisplayMemberBinding="{Binding SourceLabel}"/>
                      </GridView>
                    </ListView.View>
                  </ListView>
                </TabItem>

                <TabItem Header="Other">
                  <ListView ItemsSource="{Binding OtherLibraryItems}" SelectedItem="{Binding SelectedOtherLibraryItem}"
                            VirtualizingPanel.IsVirtualizing="True"
                            VirtualizingPanel.VirtualizationMode="Recycling"
                            ScrollViewer.CanContentScroll="True">
                    <ListView.View>
                      <GridView>
                        <GridViewColumn Header="Name" DisplayMemberBinding="{Binding Name}"/>
                        <GridViewColumn Header="Format" DisplayMemberBinding="{Binding Format}"/>
                        <GridViewColumn Header="Imported" DisplayMemberBinding="{Binding ImportedAtLabel}"/>
                      </GridView>
                    </ListView.View>
                  </ListView>
                </TabItem>
              </TabControl>
            </StackPanel>
          </Grid>
        </Grid>
      </TabItem>

      <TabItem Header="Profiles" ToolTipService.ToolTip="Configure hardening profile settings and overlay usage.">
        <Grid Margin="10">
          <StackPanel>
            <TextBlock Text="Profile Editor" FontWeight="SemiBold" />

            <WrapPanel Margin="0,8,0,0">
              <TextBlock Text="Profile:" VerticalAlignment="Center" />
              <ComboBox Width="260" Margin="6,0,0,0" ItemsSource="{Binding Profiles}" SelectedItem="{Binding SelectedProfile}"
                        DisplayMemberPath="Name" />
            </WrapPanel>

            <WrapPanel Margin="0,8,0,0">
              <TextBlock Text="Name:" Width="80" VerticalAlignment="Center" />
              <TextBox Width="320" Text="{Binding ProfileName}" />
            </WrapPanel>

            <WrapPanel Margin="0,8,0,0">
              <TextBlock Text="Mode:" Width="80" VerticalAlignment="Center" />
              <ComboBox Width="140" SelectedItem="{Binding ProfileMode}">
                <ComboBoxItem>AuditOnly</ComboBoxItem>
                <ComboBoxItem>Safe</ComboBoxItem>
                <ComboBoxItem>Full</ComboBoxItem>
              </ComboBox>

              <TextBlock Text="Class:" Width="80" Margin="20,0,0,0" VerticalAlignment="Center" />
              <ComboBox Width="160" SelectedItem="{Binding ProfileClassification}">
                <ComboBoxItem>Classified</ComboBoxItem>
                <ComboBoxItem>Unclassified</ComboBoxItem>
                <ComboBoxItem>Mixed</ComboBoxItem>
              </ComboBox>
            </WrapPanel>

            <CheckBox Content="Auto-NA out-of-scope controls" Margin="0,8,0,0" IsChecked="{Binding ProfileAutoNa}" />

            <WrapPanel Margin="0,8,0,0">
              <TextBlock Text="Grace days:" Width="80" VerticalAlignment="Center" />
              <TextBox Width="80" Text="{Binding ProfileGraceDays}" />
            </WrapPanel>

            <TextBlock Text="NA comment" Margin="0,8,0,0" />
            <TextBox Height="60" TextWrapping="Wrap" Text="{Binding ProfileNaComment}" />

            <TextBlock Text="Overlays" Margin="0,8,0,0" />
            <ItemsControl ItemsSource="{Binding OverlayItems}">
              <ItemsControl.ItemTemplate>
                <DataTemplate>
                  <CheckBox Content="{Binding Overlay.Name}" IsChecked="{Binding IsSelected, Mode=TwoWay}" />
                </DataTemplate>
              </ItemsControl.ItemTemplate>
            </ItemsControl>
            <WrapPanel Margin="0,8,0,0">
              <Button Content="Edit Overlays" Width="120" Command="{Binding OpenOverlayEditorCommand}"
                      AutomationProperties.Name="Edit overlays"
                      ToolTipService.ToolTip="Open the overlay editor to adjust rule-level overrides."/>
              <Button Content="Rebase Overlay" Width="120" Margin="6,0,0,0" Command="{Binding RebaseOverlayCommand}"
                      AutomationProperties.Name="Rebase overlay"
                      ToolTipService.ToolTip="Rebase an overlay onto a newer content pack version."/>
              <Button Content="Refresh" Width="90" Margin="6,0,0,0" Command="{Binding RefreshOverlaysCommand}"
                      AutomationProperties.Name="Refresh overlays"
                      ToolTipService.ToolTip="Reload the overlay list from disk."/>
            </WrapPanel>

            <WrapPanel Margin="0,10,0,0">
              <Button Content="Save Profile" Width="120" Command="{Binding SaveProfileCommand}"
                      AutomationProperties.Name="Save profile"
                      ToolTipService.ToolTip="Save the current profile settings to disk."/>
              <Button Content="Delete Profile" Width="110" Margin="6,0,0,0" Command="{Binding DeleteSelectedProfileCommand}" Foreground="{StaticResource DangerBrush}"
                      AutomationProperties.Name="Delete selected profile"
                      ToolTipService.ToolTip="Permanently remove the selected profile."/>
            </WrapPanel>
          </StackPanel>
        </Grid>
      </TabItem>

      <TabItem Header="Build" ToolTipService.ToolTip="Generate bundle artifacts from selected pack and profile.">
        <Grid Margin="10">
          <StackPanel>
            <WrapPanel Margin="0,0,0,8">
              <TextBlock Text="Pack:" VerticalAlignment="Center" />
              <ComboBox Width="260" Margin="6,0,18,0" ItemsSource="{Binding ContentPacks}" SelectedItem="{Binding SelectedPack}"
                        DisplayMemberPath="Name" />
              <TextBlock Text="Profile:" VerticalAlignment="Center" />
              <ComboBox Width="260" Margin="6,0,0,0" ItemsSource="{Binding Profiles}" SelectedItem="{Binding SelectedProfile}"
                        DisplayMemberPath="Name" />
            </WrapPanel>
            <Button Content="Build Bundle" Width="140" Command="{Binding BuildBundleCommand}" IsEnabled="{Binding ActionsEnabled}"
                    AutomationProperties.Name="Build bundle"
                    ToolTipService.ToolTip="Generate offline Apply/Verify/Manual/Evidence/Reports artifacts for this pack/profile pair."/>
            <TextBlock Text="Build uses release-age automation gate; see Reports/automation_gate.json in the bundle."
                       Margin="0,8,0,0" TextWrapping="Wrap" />
            <TextBlock Text="{Binding BuildGateStatus}" Margin="0,6,0,0" Foreground="{StaticResource TextMutedBrush}" />
            <WrapPanel Margin="0,6,0,0">
              <Button Content="Open Gate" Width="100" Command="{Binding OpenAutomationGateCommand}" IsEnabled="{Binding ActionsEnabled}"
                      AutomationProperties.Name="Open automation gate report"
                      ToolTipService.ToolTip="Open the automation gate JSON report from the bundle."/>
              <TextBlock Text="{Binding AutomationGatePath}" Foreground="{StaticResource TextMutedBrush}" Margin="6,0,0,0" />
            </WrapPanel>

            <TextBlock Text="Recent Bundles" Margin="0,10,0,4" />
                   <ListBox ItemsSource="{Binding RecentBundles}" SelectedItem="{Binding SelectedRecentBundle}"
                            MaxHeight="120" MinHeight="28"
                            Background="{DynamicResource SurfaceBrush}"
                            BorderBrush="{DynamicResource BorderBrush}" BorderThickness="1"
                            VirtualizingPanel.IsVirtualizing="True"
                            VirtualizingPanel.VirtualizationMode="Recycling"
                            ScrollViewer.CanContentScroll="True"
                            ToolTipService.ToolTip="Select a previously built bundle to reuse.">
                     <ListBox.ItemTemplate>
                       <DataTemplate>
                         <TextBlock Text="{Binding}" TextTrimming="CharacterEllipsis"
                                    ToolTipService.ToolTip="{Binding}"/>
                       </DataTemplate>
                     </ListBox.ItemTemplate>
                   </ListBox>
            <Button Content="Use Selected" Width="110" Margin="0,4,0,0" Command="{Binding UseRecentBundleCommand}"
                    AutomationProperties.Name="Use selected bundle"
                    ToolTipService.ToolTip="Set the selected recent bundle as the active bundle path."/>
          </StackPanel>
        </Grid>
      </TabItem>

      <TabItem Header="Orchestrate" ToolTipService.ToolTip="Run apply, verify, and export in one pipeline.">
        <Grid Margin="10">
          <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="180"/>
          </Grid.RowDefinitions>

          <TextBlock Grid.Row="0" Text="One-Click Workflow: Apply &#x2192; Verify &#x2192; Export"
                     FontSize="16" FontWeight="SemiBold" Margin="0,0,0,8"/>

          <!-- Sub-tabs for configuration sections -->
          <TabControl Grid.Row="1" Margin="0,0,0,8">

            <!-- Sub-tab 1: Bundle -->
            <TabItem Header="Bundle" ToolTipService.ToolTip="Bundle path, build, and recent bundles.">
              <Border Padding="12" Background="{DynamicResource SurfaceBrush}">
                <StackPanel>
                  <WrapPanel Margin="0,0,0,8">
                    <TextBlock Text="Bundle Path:" Width="120" VerticalAlignment="Center"/>
                    <TextBox Width="520" Text="{Binding BundleRoot}"/>
                    <Button Content="Browse" Width="80" Margin="6,0,0,0" Command="{Binding BrowseBundleCommand}"/>
                    <Button Content="Open" Width="80" Margin="6,0,0,0" Command="{Binding OpenBundleFolderCommand}"/>
                  </WrapPanel>

                  <WrapPanel Margin="0,0,0,8">
                    <Button Content="Build Bundle" Width="140" Command="{Binding BuildBundleCommand}" IsEnabled="{Binding ActionsEnabled}"
                            ToolTipService.ToolTip="Generate offline Apply/Verify/Manual/Evidence/Reports artifacts for this pack/profile pair."/>
                  </WrapPanel>

                  <TextBlock Text="{Binding BuildGateStatus}" Margin="0,0,0,8" Foreground="{StaticResource TextMutedBrush}"/>

                  <TextBlock Text="Recent Bundles" Margin="0,0,0,4"/>
                   <ListBox ItemsSource="{Binding RecentBundles}" SelectedItem="{Binding SelectedRecentBundle}"
                            MaxHeight="120" MinHeight="28"
                            Background="{DynamicResource SurfaceBrush}"
                            BorderBrush="{DynamicResource BorderBrush}" BorderThickness="1"
                            VirtualizingPanel.IsVirtualizing="True"
                            VirtualizingPanel.VirtualizationMode="Recycling"
                            ScrollViewer.CanContentScroll="True"
                            ToolTipService.ToolTip="Select a previously built bundle to reuse.">
                     <ListBox.ItemTemplate>
                       <DataTemplate>
                         <TextBlock Text="{Binding}" TextTrimming="CharacterEllipsis"
                                    ToolTipService.ToolTip="{Binding}"/>
                       </DataTemplate>
                     </ListBox.ItemTemplate>
                   </ListBox>
                  <Button Content="Use Selected" Width="110" Margin="0,4,0,8" Command="{Binding UseRecentBundleCommand}"
                          ToolTipService.ToolTip="Set the selected recent bundle as the active bundle path."/>

                  <CheckBox Content="Build a new bundle before running" IsChecked="{Binding SimpleBuildBeforeRun}" Margin="0,0,0,0"
                            ToolTipService.ToolTip="Automatically build a fresh bundle before orchestration starts."/>
                </StackPanel>
              </Border>
            </TabItem>

            <!-- Sub-tab 2: PowerSTIG -->
            <TabItem Header="PowerSTIG" ToolTipService.ToolTip="PowerSTIG DSC module, data file, and output settings.">
              <Border Padding="12" Background="{DynamicResource SurfaceBrush}">
                <StackPanel>
                  <WrapPanel Margin="0,0,0,8">
                    <TextBlock Text="Module Path:" Width="120" VerticalAlignment="Center"/>
                    <TextBox Width="520" Text="{Binding PowerStigModulePath}"
                             ToolTipService.ToolTip="Path to the PowerSTIG module file."/>
                    <Button Content="Browse" Width="80" Margin="6,0,0,0" Command="{Binding BrowsePowerStigModuleCommand}"
                            ToolTipService.ToolTip="Open a file picker to find the PowerSTIG module file."/>
                  </WrapPanel>

                  <WrapPanel Margin="0,0,0,8">
                    <TextBlock Text="Data File:" Width="120" VerticalAlignment="Center"/>
                    <TextBox Width="520" Text="{Binding PowerStigDataFile}"
                             ToolTipService.ToolTip="Optional data file for PowerSTIG. Leave blank to auto-generate."/>
                    <Button Content="Browse" Width="80" Margin="6,0,0,0" Command="{Binding BrowsePowerStigDataCommand}"
                            ToolTipService.ToolTip="Open a file picker to find a custom PowerSTIG data file."/>
                  </WrapPanel>

                  <WrapPanel Margin="0,0,0,8">
                    <TextBlock Text="Output Path:" Width="120" VerticalAlignment="Center"/>
                    <TextBox Width="520" Text="{Binding PowerStigOutputPath}"
                             ToolTipService.ToolTip="Where PowerSTIG saves its output. Leave blank to use the default bundle location."/>
                  </WrapPanel>

                  <CheckBox Content="PowerSTIG Verbose" IsChecked="{Binding PowerStigVerbose}" Margin="0,0,0,0"
                            ToolTipService.ToolTip="Enable verbose PowerSTIG compile output in apply logs."/>
                </StackPanel>
              </Border>
            </TabItem>

            <!-- Sub-tab 3: Toolkit & Scanners -->
            <TabItem Header="Toolkit &amp; Scanners" ToolTipService.ToolTip="Evaluate-STIG, SCAP, ADMX, and LGPO settings.">
              <Border Padding="12" Background="{DynamicResource SurfaceBrush}">
                <StackPanel>
                  <WrapPanel Margin="0,0,0,8">
                    <TextBlock Text="Eval-STIG Root:" Width="120" VerticalAlignment="Center"/>
                    <TextBox Width="520" Text="{Binding EvaluateStigRoot}"
                             ToolTipService.ToolTip="Folder containing the Evaluate-STIG scanner script."/>
                    <Button Content="Browse" Width="80" Margin="6,0,0,0" Command="{Binding BrowseEvaluateStigCommand}"/>
                  </WrapPanel>

                  <WrapPanel Margin="0,0,0,8">
                    <TextBlock Text="Eval-STIG Args:" Width="120" VerticalAlignment="Center"/>
                    <TextBox Width="520" Text="{Binding EvaluateStigArgs}"
                             ToolTipService.ToolTip="Custom arguments for Evaluate-STIG."/>
                  </WrapPanel>

                  <WrapPanel Margin="0,0,0,8">
                    <TextBlock Text="SCAP Cmd:" Width="120" VerticalAlignment="Center"/>
                    <TextBox Width="520" Text="{Binding ScapCommandPath}"
                             ToolTipService.ToolTip="Path to the SCC (SCAP Compliance Checker) scanner program."/>
                    <Button Content="Browse" Width="80" Margin="6,0,0,0" Command="{Binding BrowseScapCommandCommand}"/>
                  </WrapPanel>

                  <WrapPanel Margin="0,0,0,8">
                    <TextBlock Text="SCAP Args:" Width="120" VerticalAlignment="Center"/>
                    <TextBox Width="520" Text="{Binding ScapArgs}"
                             ToolTipService.ToolTip="Extra command-line options for the SCAP scanner."/>
                  </WrapPanel>

                  <WrapPanel Margin="0,0,0,8">
                    <TextBlock Text="SCAP Label:" Width="120" VerticalAlignment="Center"/>
                    <TextBox Width="200" Text="{Binding ScapLabel}"
                             ToolTipService.ToolTip="Display label for the SCAP scanner tool."/>
                  </WrapPanel>

                  <Separator Margin="0,4,0,8"/>

                  <WrapPanel Margin="0,0,0,8">
                    <TextBlock Text="ADMX Source:" Width="120" VerticalAlignment="Center"/>
                    <TextBox Width="520" Text="{Binding AdmxSourcePath}"
                             ToolTipService.ToolTip="Path to the ADMX template source folder."/>
                  </WrapPanel>

                  <WrapPanel Margin="0,0,0,8">
                    <TextBlock Text="LGPO Exe:" Width="120" VerticalAlignment="Center"/>
                    <TextBox Width="520" Text="{Binding LgpoExePath}"
                             ToolTipService.ToolTip="Path to the LGPO.exe utility."/>
                  </WrapPanel>

                  <WrapPanel Margin="0,0,0,8">
                    <TextBlock Text="GPO Backup:" Width="120" VerticalAlignment="Center"/>
                    <TextBox Width="520" Text="{Binding LgpoGpoBackupPath}"
                             ToolTipService.ToolTip="Path to the GPO backup folder for LGPO import."/>
                  </WrapPanel>

                  <CheckBox Content="LGPO Verbose" IsChecked="{Binding LgpoVerbose}" Margin="0,0,0,0"
                            ToolTipService.ToolTip="Enable verbose LGPO output in apply logs."/>
                </StackPanel>
              </Border>
            </TabItem>

          </TabControl>

          <!-- Run section: checkboxes + button + status -->
          <Border Grid.Row="2" BorderBrush="{StaticResource BorderBrush}" BorderThickness="1" Padding="12" Margin="0,0,0,8" Background="{StaticResource SurfaceMutedBrush}">
            <StackPanel>
              <WrapPanel Margin="0,0,0,8">
                <CheckBox Content="Run Apply" IsChecked="{Binding OrchRunApply}" Margin="0,0,16,0"/>
                <CheckBox Content="Run Verify" IsChecked="{Binding OrchRunVerify}" Margin="0,0,16,0"/>
                <CheckBox Content="Export eMASS" IsChecked="{Binding OrchRunExport}"/>
              </WrapPanel>

              <WrapPanel Margin="0,0,0,0">
                <Button Content="Run Orchestration" Width="160" Height="36" FontWeight="SemiBold"
                        Command="{Binding OrchestrateCommand}" IsEnabled="{Binding ActionsEnabled}"/>
                <TextBlock Text="{Binding OrchStatus}" Margin="12,8,0,0" Foreground="{StaticResource TextMutedBrush}"/>
              </WrapPanel>
            </StackPanel>
          </Border>

          <!-- Status line -->
          <TextBlock Grid.Row="3" Text="{Binding OrchStatus}" Foreground="{StaticResource TextMutedBrush}" Margin="0,0,0,4"/>

          <!-- Orchestration Log -->
          <Border Grid.Row="4" BorderBrush="{StaticResource BorderBrush}" BorderThickness="1" Background="{StaticResource SurfaceBrush}">
            <ScrollViewer VerticalScrollBarVisibility="Auto">
              <TextBlock Text="{Binding OrchLog}" FontFamily="Consolas" FontSize="11" Padding="8"
                         TextWrapping="Wrap"/>
            </ScrollViewer>
          </Border>
        </Grid>
      </TabItem>

      <TabItem Header="Apply" ToolTipService.ToolTip="Run apply phase directly on selected bundle.">
        <Grid Margin="10">
          <StackPanel>
            <WrapPanel Margin="0,0,0,8">
              <TextBlock Text="Bundle:" VerticalAlignment="Center" />
              <TextBox Width="520" Margin="6,0,6,0" Text="{Binding BundleRoot}" />
              <Button Content="Browse" Width="80" Command="{Binding BrowseBundleCommand}" />
              <Button Content="Open" Width="80" Margin="6,0,0,0" Command="{Binding OpenBundleFolderCommand}" />
            </WrapPanel>
            <Button Content="Run Apply" Width="140" Command="{Binding ApplyRunCommand}" IsEnabled="{Binding ActionsEnabled}"
                    AutomationProperties.Name="Run apply phase"
                    ToolTipService.ToolTip="Execute RunApply.ps1 from the bundle Apply folder."/>
            <TextBlock Text="Applies using bundle Apply/RunApply.ps1" Margin="0,8,0,0" />
            <TextBlock Text="{Binding ApplyStatus}" Margin="0,6,0,0" Foreground="{StaticResource TextMutedBrush}" TextWrapping="Wrap" />
            <WrapPanel Margin="0,6,0,0">
              <TextBlock Text="Last output:" Foreground="{StaticResource TextMutedBrush}" />
              <TextBlock Text="{Binding LastOutputPath}" Foreground="{StaticResource TextMutedBrush}" />
              <Button Content="Open" Width="80" Margin="6,0,0,0" Command="{Binding OpenLastOutputCommand}" />
            </WrapPanel>
          </StackPanel>
        </Grid>
      </TabItem>

      <TabItem Header="Verify" ToolTipService.ToolTip="Run Evaluate-STIG and/or SCAP verification workflows.">
        <Grid Margin="10">
          <StackPanel>
            <WrapPanel Margin="0,0,0,8">
              <TextBlock Text="Bundle:" VerticalAlignment="Center" />
              <TextBox Width="520" Margin="6,0,6,0" Text="{Binding BundleRoot}" />
              <Button Content="Browse" Width="80" Command="{Binding BrowseBundleCommand}" />
              <Button Content="Open" Width="80" Margin="6,0,0,0" Command="{Binding OpenBundleFolderCommand}" />
            </WrapPanel>
            <WrapPanel Margin="0,0,0,8">
              <TextBlock Text="Eval-STIG Root:" Width="120" VerticalAlignment="Center" />
              <TextBox Width="520" Text="{Binding EvaluateStigRoot}" />
              <Button Content="Browse" Width="80" Margin="6,0,0,0" Command="{Binding BrowseEvaluateStigCommand}" />
            </WrapPanel>
            <WrapPanel Margin="0,0,0,8">
              <TextBlock Text="Eval Args:" Width="120" VerticalAlignment="Center" />
              <TextBox Width="520" Text="{Binding EvaluateStigArgs}" />
            </WrapPanel>
            <WrapPanel Margin="0,0,0,8">
              <TextBlock Text="SCAP Cmd:" Width="120" VerticalAlignment="Center" />
              <TextBox Width="520" Text="{Binding ScapCommandPath}" />
              <Button Content="Browse" Width="80" Margin="6,0,0,0" Command="{Binding BrowseScapCommandCommand}" />
            </WrapPanel>
            <WrapPanel Margin="0,0,0,8">
              <TextBlock Text="SCAP Args:" Width="120" VerticalAlignment="Center" />
              <TextBox Width="520" Text="{Binding ScapArgs}" />
            </WrapPanel>
            <WrapPanel Margin="0,0,0,8">
              <TextBlock Text="SCAP Label:" Width="120" VerticalAlignment="Center" />
              <TextBox Width="200" Text="{Binding ScapLabel}" />
            </WrapPanel>
            <Button Content="Run Verify" Width="140" Command="{Binding VerifyRunCommand}" IsEnabled="{Binding ActionsEnabled}" />
            <TextBlock Text="Runs Evaluate-STIG / SCAP if configured" Margin="0,8,0,0" />
            <TextBlock Text="{Binding VerifyStatus}" Margin="0,6,0,0" Foreground="{StaticResource TextMutedBrush}" />
            <TextBlock Text="{Binding VerifySummary}" Margin="0,6,0,0" Foreground="{StaticResource TextMutedBrush}" TextWrapping="Wrap" />
            <WrapPanel Margin="0,6,0,0">
              <TextBlock Text="Last output:" Foreground="{StaticResource TextMutedBrush}" />
              <TextBlock Text="{Binding LastOutputPath}" Foreground="{StaticResource TextMutedBrush}" />
              <Button Content="Open" Width="80" Margin="6,0,0,0" Command="{Binding OpenLastOutputCommand}" />
            </WrapPanel>
            <Button Content="Refresh Overlap" Width="140" Margin="0,8,0,0" Command="{Binding RefreshOverlapCommand}"
                    AutomationProperties.Name="Refresh overlap analysis"
                    ToolTipService.ToolTip="Recalculate source overlap between verify results from different scanners."/>
            <ListView ItemsSource="{Binding OverlapItems}" Height="160" Margin="0,6,0,0"
                      VirtualizingPanel.IsVirtualizing="True"
                      VirtualizingPanel.VirtualizationMode="Recycling"
                      ScrollViewer.CanContentScroll="True">
              <ListView.View>
                <GridView>
                  <GridViewColumn Header="Sources" DisplayMemberBinding="{Binding SourcesKey}" Width="220" />
                  <GridViewColumn Header="#" DisplayMemberBinding="{Binding SourceCount}" Width="40" />
                  <GridViewColumn Header="Controls" DisplayMemberBinding="{Binding ControlsCount}" Width="70" />
                  <GridViewColumn Header="Closed" DisplayMemberBinding="{Binding ClosedCount}" Width="60" />
                  <GridViewColumn Header="Open" DisplayMemberBinding="{Binding OpenCount}" Width="60" />
                </GridView>
              </ListView.View>
            </ListView>
          </StackPanel>
        </Grid>
      </TabItem>

      <TabItem Header="Manual" ToolTipService.ToolTip="Operator review and disposition for manual controls.">
        <Grid Margin="10">
          <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
          </Grid.RowDefinitions>

          <WrapPanel Grid.Row="0" Margin="0,0,0,8">
            <Button Content="Launch Review Wizard" Width="160" Command="{Binding LaunchManualWizardCommand}" 
                    IsEnabled="{Binding ActionsEnabled}"
                    AutomationProperties.Name="Launch manual review wizard"
                    ToolTipService.ToolTip="Open the guided wizard for step-by-step manual control review and disposition."/>
            <TextBlock Text="Step-by-step wizard for reviewing manual controls with guided workflow" 
                       Margin="12,8,0,0" Foreground="{StaticResource TextMutedBrush}"/>
          </WrapPanel>

          <!-- Filter Controls -->
          <WrapPanel Grid.Row="1" Margin="0,0,0,8">
            <TextBlock Text="Search:" VerticalAlignment="Center" Margin="0,0,6,0"/>
            <TextBox Width="240" Text="{Binding ManualFilterText, UpdateSourceTrigger=PropertyChanged}" />
            <TextBlock Text="Status:" VerticalAlignment="Center" Margin="16,0,6,0"/>
            <ComboBox Width="140" ItemsSource="{Binding ManualStatusFilters}" SelectedItem="{Binding ManualStatusFilter}" />
          </WrapPanel>

          <!-- Summary Bar -->
          <TextBlock Grid.Row="2" Text="{Binding ManualSummary}" Foreground="{StaticResource TextMutedBrush}" Margin="0,0,0,8"/>

          <Grid Grid.Row="3">
            <Grid.ColumnDefinitions>
              <ColumnDefinition Width="2*" />
              <ColumnDefinition Width="3*" />
            </Grid.ColumnDefinitions>

            <ListView Grid.Column="0" ItemsSource="{Binding ManualControlsView}" SelectedItem="{Binding SelectedManualControl}"
                      VirtualizingPanel.IsVirtualizing="True"
                      VirtualizingPanel.VirtualizationMode="Recycling"
                      ScrollViewer.CanContentScroll="True">
            <ListView.View>
              <GridView>
                <GridViewColumn Header="Rule" DisplayMemberBinding="{Binding Control.ExternalIds.RuleId}" />
                <GridViewColumn Header="Title" DisplayMemberBinding="{Binding Control.Title}" Width="260" />
                <GridViewColumn Header="Stat" DisplayMemberBinding="{Binding Status}" />
              </GridView>
            </ListView.View>
          </ListView>

          <StackPanel Grid.Column="1" Margin="12,0,0,0">
            <TextBlock Text="Selected Control" FontWeight="SemiBold" />
            <TextBlock Text="{Binding SelectedManualControl.Control.Title}" TextWrapping="Wrap" Margin="0,6,0,0" />
            <TextBlock Text="{Binding SelectedManualControl.Control.CheckText}" TextWrapping="Wrap" Margin="0,6,0,0" Foreground="{StaticResource TextMutedBrush}" />

            <WrapPanel Margin="0,8,0,0">
              <TextBlock Text="Status:" Width="60" VerticalAlignment="Center" />
              <ComboBox Width="160" ItemsSource="{Binding ManualStatuses}" SelectedItem="{Binding ManualStatus}" />
            </WrapPanel>

            <TextBlock Text="Reason" Margin="0,8,0,0" />
            <TextBox Text="{Binding ManualReason}" Height="40" TextWrapping="Wrap" />

            <TextBlock Text="Comment" Margin="0,8,0,0" />
            <TextBox Text="{Binding ManualComment}" Height="80" TextWrapping="Wrap" />

            <Button Content="Save Answer" Width="120" Margin="0,8,0,0" Command="{Binding SaveManualAnswerCommand}"
                    AutomationProperties.Name="Save manual answer"
                    ToolTipService.ToolTip="Save the status, reason, and comment for the selected manual control."/>
            <TextBlock Text="Fail and NotApplicable require a reason." Foreground="{StaticResource TextMutedBrush}" Margin="0,4,0,0" />

            <WrapPanel Margin="0,8,0,0">
              <Button Content="Use for Evidence" Width="130" Command="{Binding UseSelectedControlForEvidenceCommand}"
                      AutomationProperties.Name="Use control for evidence"
                      ToolTipService.ToolTip="Copy the selected control's RuleId to the Evidence tab for evidence capture."/>
              <Button Content="Collect Evidence" Width="130" Margin="8,0,0,0" Command="{Binding CollectSelectedControlEvidenceCommand}"
                      AutomationProperties.Name="Collect evidence for control"
                      ToolTipService.ToolTip="Auto-collect evidence artifacts for the selected control."/>
              <Button Content="Open Evidence Folder" Width="150" Margin="8,0,0,0" Command="{Binding OpenSelectedControlEvidenceFolderCommand}"
                      AutomationProperties.Name="Open evidence folder"
                      ToolTipService.ToolTip="Open the evidence folder for the selected control in Windows Explorer."/>
            </WrapPanel>
            </StackPanel>
          </Grid>
        </Grid>
      </TabItem>

      <TabItem Header="Evidence" ToolTipService.ToolTip="Capture and manage evidence records for controls.">
        <Grid Margin="10">
          <StackPanel>
            <WrapPanel Margin="0,0,0,8">
              <TextBlock Text="Bundle:" VerticalAlignment="Center" />
              <TextBox Width="520" Margin="6,0,6,0" Text="{Binding BundleRoot}" />
              <Button Content="Browse" Width="80" Command="{Binding BrowseBundleCommand}" />
              <Button Content="Open" Width="80" Margin="6,0,0,0" Command="{Binding OpenBundleFolderCommand}" />
            </WrapPanel>

            <WrapPanel Margin="0,0,0,8">
              <TextBlock Text="RuleId:" Width="120" VerticalAlignment="Center" />
              <TextBox Width="260" Text="{Binding EvidenceRuleId}" />
              <TextBlock Text="Type:" Width="60" Margin="12,0,0,0" VerticalAlignment="Center" />
              <ComboBox Width="160" ItemsSource="{Binding EvidenceTypes}" SelectedItem="{Binding EvidenceType}" />
            </WrapPanel>

            <TextBlock Text="Evidence text" />
            <TextBox Height="80" TextWrapping="Wrap" Text="{Binding EvidenceText}" />

            <WrapPanel Margin="0,8,0,0">
              <TextBlock Text="File:" Width="120" VerticalAlignment="Center" />
              <TextBox Width="420" Text="{Binding EvidenceFilePath}" />
              <Button Content="Browse" Width="80" Margin="6,0,0,0" Command="{Binding BrowseEvidenceFileCommand}" />
            </WrapPanel>

            <Button Content="Save Evidence" Width="140" Margin="0,8,0,0" Command="{Binding SaveEvidenceCommand}"
                    AutomationProperties.Name="Save evidence record"
                    ToolTipService.ToolTip="Save the evidence text, file attachment, and type for the specified RuleId."/>
            <TextBlock Text="{Binding EvidenceStatus}" Margin="0,6,0,0" Foreground="{StaticResource TextMutedBrush}" />
          </StackPanel>
        </Grid>
      </TabItem>

      <TabItem Header="Compliance" ToolTipService.ToolTip="Separate reporting, audit, and eMASS/export workflows.">
        <Grid Margin="10">
          <TabControl>
            <TabItem Header="Reports &amp; eMASS" ToolTipService.ToolTip="Mission summaries and eMASS package export.">
              <Grid Margin="8">
                <StackPanel>
                  <WrapPanel Margin="0,0,0,8">
                    <TextBlock Text="Bundle:" VerticalAlignment="Center" />
                    <TextBox Width="520" Margin="6,0,6,0" Text="{Binding BundleRoot}" />
                    <Button Content="Browse" Width="80" Command="{Binding BrowseBundleCommand}" />
                    <Button Content="Open" Width="80" Margin="6,0,0,0" Command="{Binding OpenBundleFolderCommand}" />
                  </WrapPanel>
                  <TextBlock Text="Recent Bundles" Margin="0,0,0,4" />
                   <ListBox ItemsSource="{Binding RecentBundles}" SelectedItem="{Binding SelectedRecentBundle}"
                            MaxHeight="120" MinHeight="28"
                            Background="{DynamicResource SurfaceBrush}"
                            BorderBrush="{DynamicResource BorderBrush}" BorderThickness="1"
                            VirtualizingPanel.IsVirtualizing="True"
                            VirtualizingPanel.VirtualizationMode="Recycling"
                            ScrollViewer.CanContentScroll="True">
                     <ListBox.ItemTemplate>
                       <DataTemplate>
                         <TextBlock Text="{Binding}" TextTrimming="CharacterEllipsis"
                                    ToolTipService.ToolTip="{Binding}"/>
                       </DataTemplate>
                     </ListBox.ItemTemplate>
                   </ListBox>
                  <Button Content="Use Selected" Width="110" Margin="0,4,0,0" Command="{Binding UseRecentBundleCommand}" />
                  <Button Content="Export eMASS" Width="140" Command="{Binding ExportEmassCommand}" IsEnabled="{Binding ActionsEnabled}" />
                  <TextBlock Text="Exports eMASS package from bundle" Margin="0,8,0,0" />
                  <TextBlock Text="{Binding ExportStatus}" Margin="0,6,0,0" Foreground="{StaticResource TextMutedBrush}" />
                  <TextBlock Text="{Binding ReportSummary}" Margin="0,6,0,0" Foreground="{StaticResource TextMutedBrush}" TextWrapping="Wrap" />
                  <WrapPanel Margin="0,6,0,0">
                    <TextBlock Text="Last output:" Foreground="{StaticResource TextMutedBrush}" />
                    <TextBlock Text="{Binding LastOutputPath}" Foreground="{StaticResource TextMutedBrush}" />
                    <Button Content="Open" Width="80" Margin="6,0,0,0" Command="{Binding OpenLastOutputCommand}" />
                  </WrapPanel>
                </StackPanel>
              </Grid>
            </TabItem>

            <TabItem Header="Audit Log" ToolTipService.ToolTip="Filter and review immutable audit entries.">
              <Grid Margin="8">
                <Grid.RowDefinitions>
                  <RowDefinition Height="Auto"/>
                  <RowDefinition Height="Auto"/>
                  <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <WrapPanel Grid.Row="0" Margin="0,0,0,8">
                  <TextBlock Text="Action:" Width="60" VerticalAlignment="Center"/>
                  <TextBox Width="160" Text="{Binding AuditActionFilter}"/>
                  <TextBlock Text="Target:" Width="60" Margin="12,0,0,0" VerticalAlignment="Center"/>
                  <TextBox Width="200" Text="{Binding AuditTargetFilter}"/>
                  <TextBlock Text="Limit:" Width="50" Margin="12,0,0,0" VerticalAlignment="Center"/>
                  <TextBox Width="60" Text="{Binding AuditLimit}"/>
                  <Button Content="Query" Width="80" Margin="12,0,0,0" Command="{Binding AuditQueryCommand}" IsEnabled="{Binding ActionsEnabled}"/>
                  <Button Content="Verify Integrity" Width="120" Margin="8,0,0,0" Command="{Binding AuditVerifyCommand}" IsEnabled="{Binding ActionsEnabled}"/>
                </WrapPanel>

                <TextBlock Grid.Row="1" Text="{Binding AuditVerifyResult}" Margin="0,0,0,8" FontWeight="SemiBold"/>

                <ListView Grid.Row="2" ItemsSource="{Binding AuditEntries}"
                          VirtualizingPanel.IsVirtualizing="True"
                          VirtualizingPanel.VirtualizationMode="Recycling"
                          ScrollViewer.CanContentScroll="True">
                  <ListView.View>
                    <GridView>
                      <GridViewColumn Header="Id" DisplayMemberBinding="{Binding Id}" />
                      <GridViewColumn Header="Time" DisplayMemberBinding="{Binding Timestamp}" Width="140"/>
                      <GridViewColumn Header="Act" DisplayMemberBinding="{Binding Action}" />
                      <GridViewColumn Header="Target" DisplayMemberBinding="{Binding Target}" Width="180"/>
                      <GridViewColumn Header="Res" DisplayMemberBinding="{Binding Result}" />
                      <GridViewColumn Header="User" DisplayMemberBinding="{Binding User}" />
                      <GridViewColumn Header="Detail" DisplayMemberBinding="{Binding Detail}" Width="260"/>
                    </GridView>
                  </ListView.View>
                </ListView>
              </Grid>
            </TabItem>

            <TabItem Header="POA&amp;M / CKL" ToolTipService.ToolTip="Generate standalone POA&amp;M and CKL exports.">
              <Grid Margin="8">
                <Grid.RowDefinitions>
                  <RowDefinition Height="Auto"/>
                  <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <Border Grid.Row="0" BorderBrush="{StaticResource BorderBrush}" BorderThickness="1" Padding="12" Margin="0,0,0,8" Background="{StaticResource SurfaceMutedBrush}">
                  <StackPanel>
                    <TextBlock Text="POA&amp;M Export" FontSize="14" FontWeight="SemiBold" Margin="0,0,0,8"/>
                    <WrapPanel Margin="0,0,0,8">
                      <TextBlock Text="System Name:" Width="100" VerticalAlignment="Center"/>
                      <TextBox Width="300" Text="{Binding PoamSystemName}"/>
                    </WrapPanel>
                    <Button Content="Export POA&amp;M" Width="140" Command="{Binding ExportPoamCommand}" IsEnabled="{Binding ActionsEnabled}"/>
                    <TextBlock Text="{Binding PoamStatus}" Margin="0,8,0,0" Foreground="{StaticResource TextMutedBrush}"/>
                  </StackPanel>
                </Border>

                <Border Grid.Row="1" BorderBrush="{StaticResource BorderBrush}" BorderThickness="1" Padding="12" Background="{StaticResource SurfaceMutedBrush}">
                  <StackPanel>
                    <TextBlock Text="CKL (Checklist) Export" FontSize="14" FontWeight="SemiBold" Margin="0,0,0,8"/>
                    <WrapPanel Margin="0,0,0,8">
                      <TextBlock Text="Host Name:" Width="100" VerticalAlignment="Center"/>
                      <TextBox Width="200" Text="{Binding CklHostName}"/>
                      <TextBlock Text="STIG ID:" Width="70" Margin="12,0,0,0" VerticalAlignment="Center"/>
                      <TextBox Width="200" Text="{Binding CklStigId}"/>
                    </WrapPanel>
                    <Button Content="Export CKL" Width="140" Command="{Binding ExportCklCommand}" IsEnabled="{Binding ActionsEnabled}"/>
                    <TextBlock Text="{Binding CklStatus}" Margin="0,8,0,0" Foreground="{StaticResource TextMutedBrush}"/>
                  </StackPanel>
                </Border>
              </Grid>
            </TabItem>
          </TabControl>
        </Grid>
      </TabItem>

      <TabItem Header="Schedule" ToolTipService.ToolTip="Configure recurring apply/verify/export operations.">
        <Grid Margin="10">
          <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
          </Grid.RowDefinitions>

          <Border Grid.Row="0" BorderBrush="{StaticResource BorderBrush}" BorderThickness="1" Padding="12" Margin="0,0,0,8" Background="{StaticResource SurfaceMutedBrush}">
            <StackPanel>
              <TextBlock Text="Scheduled Re-Verification" FontSize="14" FontWeight="SemiBold" Margin="0,0,0,8"/>
              <WrapPanel Margin="0,0,0,8">
                <TextBlock Text="Task Name:" Width="90" VerticalAlignment="Center"/>
                <TextBox Width="240" Text="{Binding SchedTaskName}"/>
                <TextBlock Text="Frequency:" Width="80" Margin="12,0,0,0" VerticalAlignment="Center"/>
                <ComboBox Width="120" ItemsSource="{Binding ScheduleFrequencies}" SelectedItem="{Binding SchedFrequency}"/>
                <TextBlock Text="Time:" Width="50" Margin="12,0,0,0" VerticalAlignment="Center"/>
                <TextBox Width="80" Text="{Binding SchedTime}"/>
              </WrapPanel>
              <WrapPanel Margin="0,0,0,8">
                <Button Content="Register Task" Width="120" Command="{Binding ScheduleRegisterCommand}" IsEnabled="{Binding ActionsEnabled}"
                        AutomationProperties.Name="Register scheduled task"
                        ToolTipService.ToolTip="Create a Windows scheduled task for recurring re-verification."/>
                <Button Content="Remove Task" Width="120" Margin="8,0,0,0" Command="{Binding ScheduleRemoveCommand}" IsEnabled="{Binding ActionsEnabled}"
                        AutomationProperties.Name="Remove scheduled task"
                        ToolTipService.ToolTip="Remove the named Windows scheduled task."/>
                <Button Content="Refresh" Width="80" Margin="8,0,0,0" Command="{Binding ScheduleRefreshCommand}"
                        AutomationProperties.Name="Refresh schedule list"
                        ToolTipService.ToolTip="Reload the list of registered STIGForge scheduled tasks."/>
              </WrapPanel>
              <TextBlock Text="{Binding SchedStatus}" Foreground="{StaticResource TextMutedBrush}"/>
            </StackPanel>
          </Border>

          <Border Grid.Row="1" BorderBrush="{StaticResource BorderBrush}" BorderThickness="1" Background="{StaticResource SurfaceBrush}">
            <ScrollViewer VerticalScrollBarVisibility="Auto">
              <TextBlock Text="{Binding SchedListOutput}" FontFamily="Consolas" FontSize="11" Padding="8" TextWrapping="Wrap"/>
            </ScrollViewer>
          </Border>
        </Grid>
      </TabItem>

      <TabItem Header="Fleet" ToolTipService.ToolTip="Run operations across multiple target systems.">
        <Grid Margin="10">
          <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
          </Grid.RowDefinitions>

          <Border Grid.Row="0" BorderBrush="{StaticResource BorderBrush}" BorderThickness="1" Padding="12" Margin="0,0,0,8" Background="{StaticResource SurfaceMutedBrush}">
            <StackPanel>
              <TextBlock Text="Fleet Operations (WinRM)" FontSize="14" FontWeight="SemiBold" Margin="0,0,0,8"/>
              <WrapPanel Margin="0,0,0,8">
                <TextBlock Text="Targets:" Width="80" VerticalAlignment="Center"/>
                <TextBox Width="600" Text="{Binding FleetTargets}" ToolTip="Comma-separated: host1,host2:ip,host3"/>
              </WrapPanel>
              <WrapPanel Margin="0,0,0,8">
                <TextBlock Text="Operation:" Width="80" VerticalAlignment="Center"/>
                <ComboBox Width="120" ItemsSource="{Binding FleetOperations}" SelectedItem="{Binding FleetOperation}"/>
                <TextBlock Text="Concurrency:" Width="90" Margin="12,0,0,0" VerticalAlignment="Center"/>
                <TextBox Width="60" Text="{Binding FleetConcurrency}"/>
                <TextBlock Text="Timeout:" Width="70" Margin="12,0,0,0" VerticalAlignment="Center"/>
                <TextBox Width="60" Text="{Binding FleetTimeout}"/>
              </WrapPanel>
              <WrapPanel Margin="0,0,0,8">
                <Button Content="Execute" Width="100" Height="32" FontWeight="SemiBold"
                        Command="{Binding FleetExecuteCommand}" IsEnabled="{Binding ActionsEnabled}"
                        AutomationProperties.Name="Execute fleet operation"
                        ToolTipService.ToolTip="Run the selected operation across all target machines via WinRM."/>
                <Button Content="Check Status" Width="120" Height="32" Margin="8,0,0,0"
                        Command="{Binding FleetCheckStatusCommand}" IsEnabled="{Binding ActionsEnabled}"
                        AutomationProperties.Name="Check fleet status"
                        ToolTipService.ToolTip="Test WinRM connectivity to all target machines."/>
                <TextBlock Text="{Binding FleetStatus}" Margin="12,8,0,0" Foreground="{StaticResource TextMutedBrush}"/>
              </WrapPanel>
            </StackPanel>
          </Border>

          <Border Grid.Row="1" BorderBrush="{StaticResource BorderBrush}" BorderThickness="1" Background="{StaticResource SurfaceBrush}">
            <ScrollViewer VerticalScrollBarVisibility="Auto">
              <TextBlock Text="{Binding FleetLog}" FontFamily="Consolas" FontSize="11" Padding="8" TextWrapping="Wrap"/>
            </ScrollViewer>
          </Border>
        </Grid>
      </TabItem>
          </TabControl>
        </Grid>
        </ScrollViewer>
       
</UserControl>
