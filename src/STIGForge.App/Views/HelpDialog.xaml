<Window x:Class="STIGForge.App.Views.HelpDialog"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="STIGForge Help" Height="800" Width="1020"
        WindowStartupLocation="CenterOwner"
        Background="{DynamicResource WindowBackgroundBrush}">
  <Grid Margin="16">
    <Grid.RowDefinitions>
      <RowDefinition Height="Auto"/>
      <RowDefinition Height="*"/>
      <RowDefinition Height="Auto"/>
    </Grid.RowDefinitions>

    <StackPanel Grid.Row="0" Margin="0,0,0,12">
      <TextBlock Text="STIGForge Help" FontSize="24" FontWeight="Bold" Foreground="{DynamicResource TextPrimaryBrush}"/>
      <TextBlock Text="Everything you need to know, explained in plain English. If you can follow a recipe, you can use STIGForge."
                 Foreground="{DynamicResource TextMutedBrush}" Margin="0,4,0,0" TextWrapping="Wrap"/>
    </StackPanel>

    <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
      <StackPanel>

        <!-- What is STIGForge? -->
        <Border BorderBrush="{DynamicResource HelpBorderBrush}" BorderThickness="1" Padding="14" Margin="0,0,0,10" Background="{DynamicResource HelpSectionBrush}">
          <StackPanel>
            <TextBlock Text="What is STIGForge?" FontSize="16" FontWeight="SemiBold" Margin="0,0,0,8" Foreground="{DynamicResource TextPrimaryBrush}"/>
            <TextBlock TextWrapping="Wrap" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,4"
                       Text="STIGForge helps you lock down Windows computers so they meet government security rules (called STIGs). Think of it like a checklist app that also does the work for you."/>
            <TextBlock TextWrapping="Wrap" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,4"
                       Text="It works in steps: bring in the rules, set your preferences, build a package, apply the fixes, check the results, handle anything the computer can't check by itself, and then export a report."/>
            <TextBlock TextWrapping="Wrap" Foreground="{DynamicResource TextPrimaryBrush}"
                       Text="The tabs across the top follow this exact order: Import, Profile, Build, Orchestrate, Verify, Manual, Export, and Fleet. Just go left to right."/>
          </StackPanel>
        </Border>

        <!-- Quick Start -->
        <Border BorderBrush="{DynamicResource HelpBorderBrush}" BorderThickness="1" Padding="14" Margin="0,0,0,10" Background="{DynamicResource HelpSectionAltBrush}">
          <StackPanel>
            <TextBlock Text="Quick Start (5 Minutes)" FontSize="16" FontWeight="SemiBold" Margin="0,0,0,8" Foreground="{DynamicResource TextPrimaryBrush}"/>
            <TextBlock TextWrapping="Wrap" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,6"
                       Text="1. Go to the Import tab. Click 'Import STIG...' and pick the ZIP file you downloaded from cyber.mil. This loads the security rules into the app."/>
            <TextBlock TextWrapping="Wrap" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,6"
                       Text="2. Go to the Profile tab. Give your profile a name (like 'My Server'). Pick a mode: AuditOnly just checks things, Safe makes non-breaking changes, Full applies everything. Click 'Save Profile'."/>
            <TextBlock TextWrapping="Wrap" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,6"
                       Text="3. Go to the Build tab. Pick your content pack and profile from the dropdowns, then click 'Build Bundle'. This creates a folder with all the scripts and files needed."/>
            <TextBlock TextWrapping="Wrap" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,6"
                       Text="4. Go to the Orchestrate tab. Check the boxes for what you want to run (Apply, Verify, Export), then click 'Run Orchestration'. Sit back and watch the log."/>
            <TextBlock TextWrapping="Wrap" Foreground="{DynamicResource TextPrimaryBrush}"
                       Text="5. When it's done, go to the Export tab to see your results and download reports for your security team."/>
          </StackPanel>
        </Border>

        <!-- Import Tab -->
        <Border BorderBrush="{DynamicResource HelpBorderBrush}" BorderThickness="1" Padding="14" Margin="0,0,0,10" Background="{DynamicResource HelpSectionBrush}">
          <StackPanel>
            <TextBlock Text="Import Tab" FontSize="16" FontWeight="SemiBold" Margin="0,0,0,8" Foreground="{DynamicResource AccentBrush}"/>
            <TextBlock TextWrapping="Wrap" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,4"
                       Text="This is where you load security rules into STIGForge. Think of it as stocking your toolbox before you start work."/>
            <TextBlock TextWrapping="Wrap" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,4"
                       Text="'Import STIG...' - Load a STIG ZIP file from DISA/cyber.mil. This is the most common import. It can handle single packs or the whole SRG-STIG library bundle."/>
            <TextBlock TextWrapping="Wrap" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,4"
                       Text="'Import SCAP...' - Load SCAP benchmark files (a different format of security checks). Also from DISA or NIWC Atlantic."/>
            <TextBlock TextWrapping="Wrap" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,4"
                       Text="'Import GPO / LGPO...' - Load Group Policy templates. These are Windows-specific configuration rules."/>
            <TextBlock TextWrapping="Wrap" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,4"
                       Text="'Compare Packs...' - See what changed between two versions of the same content pack."/>
            <TextBlock TextWrapping="Wrap" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,4"
                       Text="'Scan Machine...' - Let STIGForge look at this computer and tell you which STIGs apply to it. Saves you from guessing."/>
            <TextBlock TextWrapping="Wrap" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,4"
                       Text="'Select Content...' - Pick which imported packs you want to use for your current mission. You can pick more than one."/>
            <TextBlock TextWrapping="Wrap" Foreground="{DynamicResource TextPrimaryBrush}"
                       Text="The table below shows everything you've imported. Use the filter buttons (All / STIG / SCAP / GPO-ADMX) to narrow the list. Click a row to see its details on the right."/>
          </StackPanel>
        </Border>

        <!-- Profile Tab -->
        <Border BorderBrush="{DynamicResource HelpBorderBrush}" BorderThickness="1" Padding="14" Margin="0,0,0,10" Background="{DynamicResource HelpSectionAltBrush}">
          <StackPanel>
            <TextBlock Text="Profile Tab" FontSize="16" FontWeight="SemiBold" Margin="0,0,0,8" Foreground="{DynamicResource AccentBrush}"/>
            <TextBlock TextWrapping="Wrap" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,4"
                       Text="A profile is your set of preferences for how strict the hardening should be. You can have multiple profiles saved for different situations."/>
            <TextBlock TextWrapping="Wrap" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,4"
                       Text="Mode: 'AuditOnly' = just look, don't touch anything. 'Safe' = make changes that won't break things. 'Full' = apply every rule, even ones that might disrupt services."/>
            <TextBlock TextWrapping="Wrap" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,4"
                       Text="Classification: Is this a classified, unclassified, or mixed system? This controls which rules are in scope."/>
            <TextBlock TextWrapping="Wrap" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,4"
                       Text="Grace days: How many days after a STIG is released before you need to be compliant. Useful for planning."/>
            <TextBlock TextWrapping="Wrap" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,4"
                       Text="NA comment: When a rule doesn't apply to your system, this default comment explains why."/>
            <TextBlock TextWrapping="Wrap" Foreground="{DynamicResource TextPrimaryBrush}"
                       Text="Overlays: Special exceptions or extra rules for your specific site. Check the ones that apply. Use 'Edit Overlays' to customize them."/>
          </StackPanel>
        </Border>

        <!-- Build Tab -->
        <Border BorderBrush="{DynamicResource HelpBorderBrush}" BorderThickness="1" Padding="14" Margin="0,0,0,10" Background="{DynamicResource HelpSectionBrush}">
          <StackPanel>
            <TextBlock Text="Build Tab" FontSize="16" FontWeight="SemiBold" Margin="0,0,0,8" Foreground="{DynamicResource AccentBrush}"/>
            <TextBlock TextWrapping="Wrap" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,4"
                       Text="This is where you combine your content pack and profile into a 'bundle' — a folder of scripts and files ready to be run."/>
            <TextBlock TextWrapping="Wrap" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,4"
                       Text="Pick your content pack, pick your profile, click 'Build Bundle'. That's it."/>
            <TextBlock TextWrapping="Wrap" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,4"
                       Text="The 'Active Bundle' section shows where the bundle was created. You can click 'Open' to see the folder in Explorer."/>
            <TextBlock TextWrapping="Wrap" Foreground="{DynamicResource TextPrimaryBrush}"
                       Text="'Recent Bundles' lets you go back to a bundle you built earlier without rebuilding it."/>
          </StackPanel>
        </Border>

        <!-- Orchestrate Tab -->
        <Border BorderBrush="{DynamicResource HelpBorderBrush}" BorderThickness="1" Padding="14" Margin="0,0,0,10" Background="{DynamicResource HelpSectionAltBrush}">
          <StackPanel>
            <TextBlock Text="Orchestrate Tab" FontSize="16" FontWeight="SemiBold" Margin="0,0,0,8" Foreground="{DynamicResource AccentBrush}"/>
            <TextBlock TextWrapping="Wrap" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,4"
                       Text="This is the big 'Go' button. It runs the full pipeline: apply security fixes, verify they worked, and optionally export reports."/>
            <TextBlock TextWrapping="Wrap" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,4"
                       Text="Mission preset: Pick a template. 'Workstation/VM Compliance' is the safest default. 'Golden VM Image' is for building reference images. 'SCCM PXE Image' is for deployment pipelines."/>
            <TextBlock TextWrapping="Wrap" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,4"
                       Text="Check the boxes: 'Run Apply' fixes things. 'Run Verify' checks the fixes. 'Export eMASS' makes a report package. You can run any combination."/>
            <TextBlock TextWrapping="Wrap" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,4"
                       Text="'Skip snapshot' is dangerous — it means you can't undo the changes easily. Only use it if you have another way to roll back (like a VM snapshot). You must check 'Break-glass acknowledged' and type a reason."/>
            <TextBlock TextWrapping="Wrap" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,4"
                       Text="PowerSTIG (optional): If you use Microsoft's PowerSTIG module, point to it here. It compiles extra DSC configurations during the apply phase."/>
            <TextBlock TextWrapping="Wrap" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,4"
                       Text="Toolkit &amp; Scanners: Point to your Evaluate-STIG and SCAP scanner folders. Click 'Activate' to auto-detect tools from a toolkit folder."/>
            <TextBlock TextWrapping="Wrap" Foreground="{DynamicResource TextPrimaryBrush}"
                       Text="The log at the bottom shows real-time output as the pipeline runs."/>
          </StackPanel>
        </Border>

        <!-- Verify Tab -->
        <Border BorderBrush="{DynamicResource HelpBorderBrush}" BorderThickness="1" Padding="14" Margin="0,0,0,10" Background="{DynamicResource HelpSectionBrush}">
          <StackPanel>
            <TextBlock Text="Verify Tab" FontSize="16" FontWeight="SemiBold" Margin="0,0,0,8" Foreground="{DynamicResource AccentBrush}"/>
            <TextBlock TextWrapping="Wrap" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,4"
                       Text="Run scanners to check whether the security fixes actually stuck. This is the 'did it work?' step."/>
            <TextBlock TextWrapping="Wrap" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,4"
                       Text="Click 'Run Verify' to kick off Evaluate-STIG and/or SCAP scans against the bundle. Results appear in the status area."/>
            <TextBlock TextWrapping="Wrap" Foreground="{DynamicResource TextPrimaryBrush}"
                       Text="'Scanner Overlap Analysis' shows where different scanners agree or disagree. This helps you spot conflicts. Click 'Refresh Overlap' after running scans."/>
          </StackPanel>
        </Border>

        <!-- Manual Tab -->
        <Border BorderBrush="{DynamicResource HelpBorderBrush}" BorderThickness="1" Padding="14" Margin="0,0,0,10" Background="{DynamicResource HelpSectionAltBrush}">
          <StackPanel>
            <TextBlock Text="Manual Tab" FontSize="16" FontWeight="SemiBold" Margin="0,0,0,8" Foreground="{DynamicResource AccentBrush}"/>
            <TextBlock TextWrapping="Wrap" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,4"
                       Text="Some security checks can't be done automatically — a human has to look and decide. This tab is where you do that."/>
            <TextBlock TextWrapping="Wrap" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,4"
                       Text="'Launch Review Wizard' walks you through each manual control one at a time, like a guided questionnaire."/>
            <TextBlock TextWrapping="Wrap" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,4"
                       Text="Or browse the list directly. Click a control on the left to see its details on the right. Set the status (Pass/Fail/NA), type a reason if needed, and click 'Save Answer'."/>
            <TextBlock TextWrapping="Wrap" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,4"
                       Text="Use the Search box to find specific controls. Use the Status dropdown to filter (e.g., show only unanswered ones)."/>
            <TextBlock TextWrapping="Wrap" Foreground="{DynamicResource TextPrimaryBrush}"
                       Text="Evidence section at the bottom: attach screenshots, logs, or notes that prove your manual finding. Click 'Browse' to attach a file, then 'Save Evidence'."/>
          </StackPanel>
        </Border>

        <!-- Export Tab -->
        <Border BorderBrush="{DynamicResource HelpBorderBrush}" BorderThickness="1" Padding="14" Margin="0,0,0,10" Background="{DynamicResource HelpSectionBrush}">
          <StackPanel>
            <TextBlock Text="Export Tab" FontSize="16" FontWeight="SemiBold" Margin="0,0,0,8" Foreground="{DynamicResource AccentBrush}"/>
            <TextBlock TextWrapping="Wrap" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,4"
                       Text="This is your results dashboard and export hub. See how compliant your system is at a glance, then export what your security team needs."/>
            <TextBlock TextWrapping="Wrap" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,4"
                       Text="The three cards at the top show: total controls, automated verification compliance rate, and manual review progress."/>
            <TextBlock TextWrapping="Wrap" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,4"
                       Text="'Export eMASS' — Creates the package your security team uploads to the eMASS system."/>
            <TextBlock TextWrapping="Wrap" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,4"
                       Text="'Export POA&amp;M' — Creates a Plan of Action and Milestones document listing open findings and remediation timelines."/>
            <TextBlock TextWrapping="Wrap" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,4"
                       Text="'Export CKL' — Creates a STIG Viewer checklist file. The hostname is auto-filled from your computer name."/>
            <TextBlock TextWrapping="Wrap" Foreground="{DynamicResource TextPrimaryBrush}"
                       Text="Audit Log at the bottom: a tamper-proof record of everything STIGForge did. Click 'Verify Integrity' to confirm the log hasn't been altered."/>
          </StackPanel>
        </Border>

        <!-- Fleet Tab -->
        <Border BorderBrush="{DynamicResource HelpBorderBrush}" BorderThickness="1" Padding="14" Margin="0,0,0,10" Background="{DynamicResource HelpSectionAltBrush}">
          <StackPanel>
            <TextBlock Text="Fleet Tab" FontSize="16" FontWeight="SemiBold" Margin="0,0,0,8" Foreground="{DynamicResource AccentBrush}"/>
            <TextBlock TextWrapping="Wrap" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,4"
                       Text="Manage multiple computers at once. Instead of running STIGForge on each machine, run it from here across your whole fleet."/>
            <TextBlock TextWrapping="Wrap" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,4"
                       Text="Fleet Inventory: Add computers by hostname or IP. Use 'Import CSV' to load a list. 'Ping All' checks if machines are reachable. 'Test WinRM All' checks if you can actually run commands on them."/>
            <TextBlock TextWrapping="Wrap" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,4"
                       Text="Fleet Operations: Pick an operation (apply, verify, or orchestrate), set how many machines to run at once (Concurrency), and click 'Execute'. It uses Windows Remote Management (WinRM) to connect."/>
            <TextBlock TextWrapping="Wrap" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,4"
                       Text="Remote Compliance Settings: Pick the profile, content pack, and bundle to use for remote machines. These are the same settings from the other tabs, but applied remotely."/>
            <TextBlock TextWrapping="Wrap" Foreground="{DynamicResource TextPrimaryBrush}"
                       Text="Scheduled Re-Verification: Set up a Windows scheduled task to automatically re-check your fleet on a schedule (daily, weekly, etc.)."/>
          </StackPanel>
        </Border>

        <!-- Glossary -->
        <Border BorderBrush="{DynamicResource HelpBorderBrush}" BorderThickness="1" Padding="14" Margin="0,0,0,10" Background="{DynamicResource HelpSectionBrush}">
          <StackPanel>
            <TextBlock Text="Key Concepts (Glossary)" FontSize="16" FontWeight="SemiBold" Margin="0,0,0,8" Foreground="{DynamicResource TextPrimaryBrush}"/>
            <TextBlock TextWrapping="Wrap" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,4" Text="STIG — Security Technical Implementation Guide. A checklist of security rules published by DISA for a specific technology (like Windows Server 2022)."/>
            <TextBlock TextWrapping="Wrap" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,4" Text="SCAP — Security Content Automation Protocol. A machine-readable format for security checks. Think of it as a STIG that a scanner can read directly."/>
            <TextBlock TextWrapping="Wrap" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,4" Text="Content Pack — A downloaded package of security rules (STIG, SCAP, or GPO) imported into STIGForge."/>
            <TextBlock TextWrapping="Wrap" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,4" Text="Profile — Your saved preferences: how strict to be, which rules are in scope, and what to do with rules that don't apply."/>
            <TextBlock TextWrapping="Wrap" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,4" Text="Overlay — A set of exceptions layered on top of a STIG. For example, your site might allow a longer password expiration than the STIG requires."/>
            <TextBlock TextWrapping="Wrap" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,4" Text="Bundle — The output folder from a Build. Contains all scripts, configuration files, and report templates for one content pack + profile combination."/>
            <TextBlock TextWrapping="Wrap" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,4" Text="Apply — The step that actually changes settings on the computer to make it more secure."/>
            <TextBlock TextWrapping="Wrap" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,4" Text="Verify — The step that scans the computer to check whether the security settings are correct."/>
            <TextBlock TextWrapping="Wrap" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,4" Text="eMASS — Enterprise Mission Assurance Support Service. The government's online system for tracking security compliance."/>
            <TextBlock TextWrapping="Wrap" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,4" Text="POA&amp;M — Plan of Action and Milestones. A document listing what security issues exist and when you plan to fix them."/>
            <TextBlock TextWrapping="Wrap" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,4" Text="CKL — Checklist file. Used by STIG Viewer and eMASS to track the status of each security rule."/>
            <TextBlock TextWrapping="Wrap" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,4" Text="Snapshot — A backup of your computer's security settings taken before applying changes. Lets you undo if something goes wrong."/>
            <TextBlock TextWrapping="Wrap" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,4" Text="Break-Glass — An emergency override that skips the safety snapshot. Only for controlled environments like image factories."/>
            <TextBlock TextWrapping="Wrap" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,4" Text="PowerSTIG — A Microsoft PowerShell module that compiles STIG rules into DSC (Desired State Configuration) format. Optional."/>
            <TextBlock TextWrapping="Wrap" Foreground="{DynamicResource TextPrimaryBrush}" Text="WinRM — Windows Remote Management. The protocol STIGForge uses to connect to and run commands on remote computers in your fleet."/>
          </StackPanel>
        </Border>

        <!-- Machine Scan & Content Selection -->
        <Border BorderBrush="{DynamicResource HelpBorderBrush}" BorderThickness="1" Padding="14" Margin="0,0,0,10" Background="{DynamicResource HelpSectionBrush}">
          <StackPanel>
            <TextBlock Text="Machine Scan &amp; Smart Content Selection" FontSize="16" FontWeight="SemiBold" Margin="0,0,0,8" Foreground="{DynamicResource AccentBrush}"/>
            <TextBlock TextWrapping="Wrap" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,4"
                       Text="The fastest way to get started is to let STIGForge scan your computer and tell you which security checklists (STIGs) apply."/>
            <TextBlock TextWrapping="Wrap" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,4"
                       Text="1. On the Import tab, click 'Scan Machine'. STIGForge looks at your OS version, installed server roles, and software to build a list of matching STIGs."/>
            <TextBlock TextWrapping="Wrap" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,4"
                       Text="2. Click the arrow next to 'Machine Scan Results' to expand or collapse the scan output. This keeps the screen tidy."/>
            <TextBlock TextWrapping="Wrap" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,4"
                       Text="3. Click 'Select Content' to open the content picker. Click 'Select Recommended' at the top — it auto-checks only the packs that match your machine scan. Then click OK."/>
            <TextBlock TextWrapping="Wrap" Foreground="{DynamicResource TextPrimaryBrush}"
                       Text="You can always manually check or uncheck packs in the picker. The recommended button is just a shortcut."/>
          </StackPanel>
        </Border>

        <!-- SCAP Bundles -->
        <Border BorderBrush="{DynamicResource HelpBorderBrush}" BorderThickness="1" Padding="14" Margin="0,0,0,10" Background="{DynamicResource HelpSectionAltBrush}">
          <StackPanel>
            <TextBlock Text="SCAP Bundles (NIWC Atlantic)" FontSize="16" FontWeight="SemiBold" Margin="0,0,0,8" Foreground="{DynamicResource AccentBrush}"/>
            <TextBlock TextWrapping="Wrap" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,4"
                       Text="SCAP stands for Security Content Automation Protocol — it's a machine-readable format for security checks, similar to STIGs but designed for automated scanners."/>
            <TextBlock TextWrapping="Wrap" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,4"
                       Text="NIWC Atlantic (Naval Information Warfare Center) publishes large SCAP bundles that contain many benchmarks in one download. These are NOT nested ZIP files — they contain folders with XCCDF and OVAL XML files directly."/>
            <TextBlock TextWrapping="Wrap" Foreground="{DynamicResource TextPrimaryBrush}"
                       Text="When you import an NIWC bundle, STIGForge automatically splits it into individual benchmark packs so you can select only the ones you need. You don't have to do anything extra."/>
          </StackPanel>
        </Border>

        <!-- Snapshots & Recovery -->
        <Border BorderBrush="{DynamicResource HelpBorderBrush}" BorderThickness="1" Padding="14" Margin="0,0,0,10" Background="{DynamicResource HelpSectionBrush}">
          <StackPanel>
            <TextBlock Text="Snapshots &amp; Recovery" FontSize="16" FontWeight="SemiBold" Margin="0,0,0,8" Foreground="{DynamicResource AccentBrush}"/>
            <TextBlock TextWrapping="Wrap" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,4"
                       Text="Before STIGForge applies security changes, it takes a snapshot of your computer's current settings. This is your safety net — if something breaks, you can undo the changes."/>
            <TextBlock TextWrapping="Wrap" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,4"
                       Text="What the snapshot captures:"/>
            <TextBlock TextWrapping="Wrap" Foreground="{DynamicResource TextPrimaryBrush}" Margin="12,0,0,4"
                       Text="• Security policy (secedit) — password rules, account lockout, user rights, etc."/>
            <TextBlock TextWrapping="Wrap" Foreground="{DynamicResource TextPrimaryBrush}" Margin="12,0,0,4"
                       Text="• Audit policy (auditpol) — what Windows logs to the security event log."/>
            <TextBlock TextWrapping="Wrap" Foreground="{DynamicResource TextPrimaryBrush}" Margin="12,0,0,4"
                       Text="• Local Group Policy (LGPO) — registry-based policy settings."/>
            <TextBlock TextWrapping="Wrap" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,8,0,4"
                       Text="Where snapshot files live: Inside your bundle folder under Apply\Snapshots\. Each snapshot is timestamped."/>
            <TextBlock TextWrapping="Wrap" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,4"
                       Text="How to recover: Open the snapshot folder and run the generated rollback PowerShell script (Rollback-*.ps1). It restores all three areas to their pre-apply state. You must run it as Administrator."/>
            <TextBlock TextWrapping="Wrap" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,4"
                       Text="Physical machines vs. virtual machines: Snapshots work on physical hosts. If you're using a virtual machine (Hyper-V, VMware, etc.), use your hypervisor's built-in snapshot/checkpoint feature instead — it's faster and captures more state. The 'Skip snapshot' option on the Orchestrate tab is meant for VM workflows where the hypervisor handles rollback."/>
            <TextBlock TextWrapping="Wrap" Foreground="{DynamicResource TextPrimaryBrush}"
                       Text="Important: You need to run STIGForge as Administrator for snapshots to work, because secedit and auditpol require elevated privileges."/>
          </StackPanel>
        </Border>

        <!-- Deleting Bundles -->
        <Border BorderBrush="{DynamicResource HelpBorderBrush}" BorderThickness="1" Padding="14" Margin="0,0,0,10" Background="{DynamicResource HelpSectionAltBrush}">
          <StackPanel>
            <TextBlock Text="Deleting Bundles" FontSize="16" FontWeight="SemiBold" Margin="0,0,0,8" Foreground="{DynamicResource AccentBrush}"/>
            <TextBlock TextWrapping="Wrap" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,4"
                       Text="Bundles can get big. When you're done with one, you can delete it to free up disk space."/>
            <TextBlock TextWrapping="Wrap" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,4"
                       Text="Go to the Export tab. In the Active Bundle bar at the top, click the red 'Delete Bundle' button. You'll be asked to confirm — once deleted, the entire bundle folder and all its contents (scripts, reports, snapshots) are permanently removed."/>
            <TextBlock TextWrapping="Wrap" Foreground="{DynamicResource TextPrimaryBrush}"
                       Text="Tip: Export your reports first (eMASS, POA&amp;M, CKL) before deleting the bundle, because those reports live inside the bundle folder."/>
          </StackPanel>
        </Border>

        <!-- Subtabs Guide -->
        <Border BorderBrush="{DynamicResource HelpBorderBrush}" BorderThickness="1" Padding="14" Margin="0,0,0,10" Background="{DynamicResource HelpSectionBrush}">
          <StackPanel>
            <TextBlock Text="Subtabs — Where to Find Things" FontSize="16" FontWeight="SemiBold" Margin="0,0,0,8" Foreground="{DynamicResource AccentBrush}"/>
            <TextBlock TextWrapping="Wrap" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,4"
                       Text="Several tabs have subtabs inside them to keep things organized:"/>
            <TextBlock TextWrapping="Wrap" Foreground="{DynamicResource TextPrimaryBrush}" Margin="12,0,0,4"
                       Text="• Manual tab — Details (read the check instructions), Disposition (set pass/fail/NA and write your reason), Evidence (attach proof like screenshots or log files)."/>
            <TextBlock TextWrapping="Wrap" Foreground="{DynamicResource TextPrimaryBrush}" Margin="12,0,0,4"
                       Text="• Export tab — Dashboard (see compliance numbers at a glance), eMASS (export for the eMASS compliance system), POA&amp;M / CKL (generate Plan of Action or checklist files), Audit Log (tamper-proof record of what STIGForge did)."/>
            <TextBlock TextWrapping="Wrap" Foreground="{DynamicResource TextPrimaryBrush}" Margin="12,0,0,0"
                       Text="• Fleet tab — Operations (run apply/verify across remote machines), Inventory (manage your list of computers), Schedule (set up automatic re-checks on a timer)."/>
          </StackPanel>
        </Border>

        <!-- Troubleshooting -->
        <Border BorderBrush="{DynamicResource HelpBorderBrush}" BorderThickness="1" Padding="14" Background="{DynamicResource HelpSectionAltBrush}">
          <StackPanel>
            <TextBlock Text="Troubleshooting" FontSize="16" FontWeight="SemiBold" Margin="0,0,0,8" Foreground="{DynamicResource TextPrimaryBrush}"/>
            <TextBlock TextWrapping="Wrap" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,4"
                       Text="'Build Bundle' is grayed out — Make sure you've selected both a content pack and a profile. Go to Import and Profile tabs first."/>
            <TextBlock TextWrapping="Wrap" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,4"
                       Text="Orchestration fails immediately — Check that the bundle path exists and the bundle was built successfully. Also verify you're running as Administrator if apply is enabled."/>
            <TextBlock TextWrapping="Wrap" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,4"
                       Text="Snapshot fails — You need to run STIGForge as Administrator. The snapshot uses secedit and auditpol which require elevated privileges."/>
            <TextBlock TextWrapping="Wrap" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,4"
                       Text="Verify shows 0 results — Make sure Evaluate-STIG or SCAP scanner paths are set correctly in the Orchestrate or Verify tab. Click 'Activate' on the toolkit to auto-detect."/>
            <TextBlock TextWrapping="Wrap" Foreground="{DynamicResource TextPrimaryBrush}" Margin="0,0,0,4"
                       Text="Fleet: WinRM test fails — The remote machine needs WinRM enabled. Run 'winrm quickconfig' on the target machine, and make sure the firewall allows port 5985/5986."/>
            <TextBlock TextWrapping="Wrap" Foreground="{DynamicResource TextPrimaryBrush}"
                       Text="Nothing seems to work — Check the log at the bottom of whichever tab you're using. The error messages there usually tell you exactly what went wrong."/>
          </StackPanel>
        </Border>

      </StackPanel>
    </ScrollViewer>

    <Button Grid.Row="2" Content="Close" Width="110" Height="30" HorizontalAlignment="Right" Margin="0,12,0,0"
            IsDefault="True" IsCancel="True" Click="Close_Click"/>
  </Grid>
</Window>
